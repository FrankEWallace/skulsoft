import{u as J,i as Q,j as W,p as X,m as w,I as Y,q as Z,r as o,A as x,a as m,o as n,e as s,t as i,b as y,w as a,f as c,v as r,x as l,d as v,F as T,y as E,B as ee,K as te}from"./app-Cvm44xuh.js";import{_ as ae}from"./Filter-CYVhLt-i.js";const ne={class:"p-2"},oe={class:"divide-y divide-gray-200 dark:divide-gray-700"},se={class:"col-span-3 sm:col-span-1"},re={key:0,class:"ml-2"},le={class:"col-span-3 sm:col-span-1"},de={class:"col-span-3 sm:col-span-1"},ie={name:"EmployeeAttendanceMark"},me=Object.assign(ie,{setup(ce){const g=J(),P=Q(),C=W(),k={employees:[]},B="employee/attendance/",A=X(!1),$=w({attendanceTypes:[]}),b=Y(B),_=w({...k}),f=w({meta:{},defaultAttendanceType:{}}),U=e=>{f.defaultAttendanceType=e,_.employees.forEach(d=>{d.timeBasedAttendance||(d.attendanceType=e.uuid)})},V=async()=>{A.value=!0,await C.dispatch(B+"fetchEmployee",{params:g.query}).then(e=>{A.value=!1,k.employees=e.data,f.meta=e.meta,Object.assign(_,te(k))}).catch(e=>{A.value=!1})},q=e=>{Object.assign($,e)};return Z(async()=>{g.query.date&&await V()}),(e,d)=>{const D=o("BaseButton"),F=o("PageHeaderAction"),R=o("PageHeader"),H=o("ParentTransition"),L=o("DropdownItem"),N=o("DropdownButton"),S=o("BaseAlert"),h=o("BaseDataView"),j=o("BaseBadge"),I=o("BaseSelect"),O=o("BaseTextarea"),M=o("FormAction"),z=o("Pagination"),K=o("BaseCard"),G=x("tooltip");return n(),m(T,null,[s(R,{title:e.$trans(c(g).meta.label),navs:[{label:e.$trans("employee.employee"),path:"Employee"},{label:e.$trans("employee.attendance.attendance"),path:"EmployeeAttendance"}]},{default:a(()=>[s(F,null,{default:a(()=>[s(D,{design:"white",onClick:d[0]||(d[0]=t=>c(P).push({name:"EmployeeAttendanceList"}))},{default:a(()=>[r(l(e.$trans("global.list",{attribute:e.$trans("employee.attendance.attendance")})),1)]),_:1}),s(D,{design:"primary",onClick:d[1]||(d[1]=t=>c(P).push({name:"EmployeeAttendanceProduction"}))},{default:a(()=>[r(l(e.$trans("employee.attendance.mark_production")),1)]),_:1})]),_:1})]),_:1},8,["title","navs"]),s(H,{appear:"",visibility:!0},{default:a(()=>[s(ae,{onAfterFilter:V,"init-url":B})]),_:1}),c(g).query.date?(n(),i(K,{key:0,"no-padding":"","no-content-padding":"","is-loading":A.value},{title:a(()=>[r(l(e.$trans("employee.attendance.mark")),1)]),action:a(()=>[$.attendanceTypes?(n(),i(N,{key:0,label:f.defaultAttendanceType.uuid?f.defaultAttendanceType.name:e.$trans("employee.attendance.type.type")},{default:a(()=>[(n(!0),m(T,null,E($.attendanceTypes,t=>(n(),m("div",{key:t.uuid},[t.uuid!=f.defaultAttendanceType.name?(n(),i(L,{key:0,as:"span",onClick:p=>U(t)},{default:a(()=>[r(l(t.name),1)]),_:2},1032,["onClick"])):y("",!0)]))),128))]),_:1},8,["label"])):y("",!0)]),default:a(()=>[v("div",ne,[_.employees.length==0?(n(),i(S,{key:0,size:"xs",design:"error"},{default:a(()=>[r(l(e.$trans("general.errors.record_not_found")),1)]),_:1})):y("",!0)]),_.employees.length?(n(),i(M,{key:0,"no-card":"","button-padding":"","keep-adding":!1,"stay-on":!0,"init-url":B,"pre-requisites":!0,onSetPreRequisites:q,action:"markAttendance","init-form":k,form:_},{default:a(()=>[v("div",oe,[(n(!0),m(T,null,E(_.employees,(t,p)=>(n(),m("div",{class:"grid grid-cols-3 gap-6 px-4 py-2",key:t.uuid},[v("div",se,[s(h,{label:t.name+" ("+t.codeNumber+")",revert:""},{default:a(()=>[r(l(t.designation)+" ",1),t.timeBasedAttendance?ee((n(),m("span",re,d[2]||(d[2]=[v("i",{class:"fas fa-clock text-info"},null,-1)]))),[[G,e.$trans("employee.attendance.is_time_based")]]):y("",!0)]),_:2},1032,["label"])]),v("div",le,[t.onLeave?(n(),m(T,{key:0},[s(h,{label:e.$trans("employee.leave.on_leave"),revert:""},{default:a(()=>[r(l(t.leavePeriod),1)]),_:2},1032,["label"]),t.isHalfDayLeave?(n(),i(j,{key:0,design:"info"},{default:a(()=>[r(l(e.$trans("employee.leave.half_day_leave")),1)]),_:1})):y("",!0)],64)):t.notAvailable?(n(),i(h,{key:1,revert:""},{default:a(()=>[r(l(e.$trans("employee.attendance.not_available")),1)]),_:1})):t.forcedAttendance?(n(),i(h,{key:2,revert:""},{default:a(()=>[r(l(t.forcedAttendance),1)]),_:2},1024)):(n(),i(I,{key:3,disabled:t.timeBasedAttendance,modelValue:t.attendanceType,"onUpdate:modelValue":u=>t.attendanceType=u,name:`employees.${p}.attendanceType`,placeholder:e.$trans("employee.attendance.type.type"),options:$.attendanceTypes,"value-prop":"uuid","label-prop":"name",error:c(b)[`employees.${p}.attendanceType`],"onUpdate:error":u=>c(b)[`employees.${p}.attendanceType`]=u},null,8,["disabled","modelValue","onUpdate:modelValue","name","placeholder","options","error","onUpdate:error"]))]),v("div",de,[s(O,{rows:1,modelValue:t.remarks,"onUpdate:modelValue":u=>t.remarks=u,name:`employees.${p}.remarks`,placeholder:e.$trans("employee.attendance.props.remarks"),error:c(b)[`details.${p}.remarks`],"onUpdate:error":u=>c(b)[`details.${p}.remarks`]=u},null,8,["modelValue","onUpdate:modelValue","name","placeholder","error","onUpdate:error"])])]))),128))])]),_:1},8,["form"])):y("",!0),s(z,{meta:f.meta,onRefresh:V},null,8,["meta"])]),_:1},8,["is-loading"])):y("",!0)],64)}}});export{me as default};
