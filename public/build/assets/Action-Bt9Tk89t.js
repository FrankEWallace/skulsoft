import{u as U,m as V,I as S,r as n,t as A,o as c,w as y,d,a as _,b as B,f as s,v as L,x as i,e as p,F as k,y as q,K as E}from"./app-Cvm44xuh.js";const R={class:"grid grid-cols-2 gap-6"},w={class:"col-span-2 sm:col-span-1"},H={class:"col-span-2 sm:col-span-1"},C={class:"col-span-2"},I={class:"col-span-4 sm:col-span-2"},K={key:0},z={key:0},G={class:"col-span-4 sm:col-span-2"},J={name:"EmployeeLeaveAllocationForm"},M=Object.assign(J,{setup(F){const v=U(),l={employee:"",startDate:"",endDate:"",records:[],description:""},$="employee/leave/allocation/",b=V({leaveTypes:[]}),r=S($),o=V({...l}),f=V({employee:"",isLoaded:!v.params.uuid}),O=t=>{Object.assign(b,t),b.leaveTypes.forEach(a=>{l.records.push({leaveType:a,allotted:0,used:0})}),Object.assign(o,E(l))},P=t=>{var a,g;Object.assign(l,{employee:(a=t.employee)==null?void 0:a.uuid,startDate:t.startDate.value,endDate:t.endDate.value,description:t.description}),l.records.forEach(m=>{let u=t.records.find(D=>D.leaveType.uuid==m.leaveType.uuid);u!==void 0&&(m.leaveType=u.leaveType,m.allotted=u.allotted,m.used=u.used)}),Object.assign(o,E(l)),f.employee=(g=t.employee)==null?void 0:g.uuid,f.isLoaded=!0};return(t,a)=>{const g=n("BaseSelectSearch"),m=n("DatePicker"),u=n("BaseTextarea"),D=n("BaseLabel"),j=n("BaseInput"),N=n("FormAction");return c(),A(N,{"pre-requisites":!0,onSetPreRequisites:O,"init-url":$,"init-form":l,form:o,"set-form":P,redirect:"EmployeeLeaveAllocation"},{default:y(()=>[d("div",R,[d("div",w,[f.isLoaded?(c(),A(g,{key:0,name:"employee",label:t.$trans("global.select",{attribute:t.$trans("employee.employee")}),modelValue:o.employee,"onUpdate:modelValue":a[0]||(a[0]=e=>o.employee=e),error:s(r).employee,"onUpdate:error":a[1]||(a[1]=e=>s(r).employee=e),"value-prop":"uuid","init-search":f.employee,"additional-search-query":{self:0},"search-key":"name","search-action":"employee/list"},{selectedOption:y(e=>[L(i(e.value.name)+" ("+i(e.value.codeNumber)+") ",1)]),listOption:y(e=>[L(i(e.option.name)+" ("+i(e.option.codeNumber)+") ",1)]),_:1},8,["label","modelValue","error","init-search"])):B("",!0)]),d("div",H,[p(m,{start:o.startDate,"onUpdate:start":a[2]||(a[2]=e=>o.startDate=e),end:o.endDate,"onUpdate:end":a[3]||(a[3]=e=>o.endDate=e),name:"dateBetween",as:"range",label:t.$trans("general.date_between")},null,8,["start","end","label"])]),d("div",C,[p(u,{modelValue:o.description,"onUpdate:modelValue":a[4]||(a[4]=e=>o.description=e),name:"description",label:t.$trans("employee.leave.allocation.props.description"),error:s(r).description,"onUpdate:error":a[5]||(a[5]=e=>s(r).description=e)},null,8,["modelValue","label","error"])])]),(c(!0),_(k,null,q(o.records,(e,T)=>(c(),_("div",{class:"mt-4 grid grid-cols-4 gap-3",key:e.leaveType.uuid},[d("div",I,[p(D,{class:"mt-4"},{default:y(()=>[d("span",null,[L(i(e.leaveType.name)+" ",1),e.leaveType.alias?(c(),_("span",K,"("+i(e.leaveType.alias)+")",1)):B("",!0)]),s(v).params.uuid?(c(),_("span",z,"("+i(t.$trans("employee.leave.allocation.props.used"))+" "+i(e.used)+")",1)):B("",!0)]),_:2},1024)]),d("div",G,[p(j,{type:"number",name:`records.${T}.allotted`,modelValue:e.allotted,"onUpdate:modelValue":h=>e.allotted=h,placeholder:t.$trans("employee.leave.allocation.props.allotted"),error:s(r)[`records.${T}.allotted`],"onUpdate:error":h=>s(r)[`records.${T}.allotted`]=h},null,8,["name","modelValue","onUpdate:modelValue","placeholder","error","onUpdate:error"])])]))),128))]),_:1},8,["form"])}}}),Q={name:"EmployeeLeaveAllocationAction"},X=Object.assign(Q,{setup(F){const v=U();return(l,$)=>{const b=n("PageHeaderAction"),r=n("PageHeader"),o=n("ParentTransition");return c(),_(k,null,[p(r,{title:l.$trans(s(v).meta.trans,{attribute:l.$trans(s(v).meta.label)}),navs:[{label:l.$trans("employee.leave.leave"),path:"EmployeeLeave"},{label:l.$trans("employee.leave.allocation.allocation"),path:"EmployeeLeaveAllocationList"}]},{default:y(()=>[p(b,{name:"EmployeeLeaveAllocation",title:l.$trans("employee.leave.allocation.allocation"),actions:["list"]},null,8,["title"])]),_:1},8,["title","navs"]),p(o,{appear:"",visibility:!0},{default:y(()=>[p(M)]),_:1})],64)}}});export{X as default};
