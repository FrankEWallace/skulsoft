import{u as V,k as O,m as F,I as P,q as H,r as l,t as R,o as m,w as e,d as D,b as U,v as o,x as a,j as M,z as W,p as C,a as y,e as t,f as T,F as k,y as S}from"./app-Cvm44xuh.js";const E={class:"grid grid-cols-3 gap-6"},z={class:"col-span-3 sm:col-span-1"},I={__name:"Filter",props:{initUrl:{type:String,default:""}},emits:["hide"],setup(B,{emit:b}){const f=V();O("moment");const w=b,v=B,h={batches:[]},u=F({...h});P(v.initUrl);const i=F({isLoaded:!f.query.batches});return H(async()=>{i.batches=f.query.batches?f.query.batches.split(","):[],i.isLoaded=!0}),(s,d)=>{const c=l("BaseSelectSearch"),p=l("FilterForm");return m(),R(p,{"init-form":h,multiple:["batches"],form:u,onHide:d[1]||(d[1]=n=>w("hide"))},{default:e(()=>[D("div",E,[D("div",z,[i.isLoaded?(m(),R(c,{key:0,multiple:"",name:"batches",label:s.$trans("global.select",{attribute:s.$trans("academic.batch.batch")}),modelValue:u.batches,"onUpdate:modelValue":d[0]||(d[0]=n=>u.batches=n),"value-prop":"uuid","init-search":i.batches,"search-key":"course_batch","search-action":"academic/batch/list"},{selectedOption:e(n=>[o(a(n.value.course.name)+" "+a(n.value.name),1)]),listOption:e(n=>[o(a(n.option.course.nameWithTerm)+" "+a(n.option.name),1)]),_:1},8,["label","modelValue","init-search"])):U("",!0)])])]),_:1},8,["form"])}}},G={name:"TransportReportBatchWiseRoute"},K=Object.assign(G,{setup(B){const b=V(),f=M();let w=["filter"],v=[];W("transport:export")&&(v=["print","pdf","excel"]);const h="transport/report/",u=C(!1),i=C(!1),s=F({headers:[],data:[],meta:{total:0}}),d=async()=>{i.value=!0,await f.dispatch(h+"fetchReport",{name:"batch-wise-route",params:b.query}).then(c=>{i.value=!1,Object.assign(s,c)}).catch(c=>{i.value=!1})};return H(async()=>{await d()}),(c,p)=>{const n=l("PageHeaderAction"),q=l("PageHeader"),$=l("ParentTransition"),_=l("DataCell"),g=l("TextMuted"),A=l("DataRow"),L=l("DataTable"),j=l("BaseCard");return m(),y(k,null,[t(q,{title:c.$trans(T(b).meta.label),navs:[{label:c.$trans("transport.transport"),path:"Transport"},{label:c.$trans("transport.report.report"),path:"TransportReport"}]},{default:e(()=>[t(n,{url:"transport/reports/batch-wise-route/",name:"TransportReportBatchWiseRoute",title:c.$trans("transport.report.batch_wise_route.batch_wise_route"),actions:T(w),"dropdown-actions":T(v),headers:s.headers,onToggleFilter:p[0]||(p[0]=r=>u.value=!u.value)},null,8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"]),t($,{appear:"",visibility:u.value},{default:e(()=>[t(I,{onAfterFilter:d,"init-url":h,onHide:p[1]||(p[1]=r=>u.value=!1)})]),_:1},8,["visibility"]),t($,{appear:"",visibility:!0},{default:e(()=>[t(j,{"no-padding":"","no-content-padding":"","is-loading":i.value},{default:e(()=>[t(L,{header:s.headers,footer:s.footers,meta:s.meta,module:"transport.report.batch_wise_route",onRefresh:d},{default:e(()=>[(m(!0),y(k,null,S(s.data,(r,x)=>(m(),R(A,{key:r.uuid},{default:e(()=>[t(_,{name:"sno"},{default:e(()=>[o(a(s.meta.sno+x),1)]),_:2},1024),t(_,{name:"codeNumber"},{default:e(()=>[o(a(r.codeNumber),1)]),_:2},1024),t(_,{name:"name"},{default:e(()=>[o(a(r.name)+" ",1),t(g,{block:""},{default:e(()=>[o(a(r.rollNumber),1)]),_:2},1024)]),_:2},1024),t(_,{name:"fatherName"},{default:e(()=>[o(a(r.fatherName)+" ",1),t(g,{block:""},{default:e(()=>[o(a(r.contactNumber),1)]),_:2},1024)]),_:2},1024),t(_,{name:"course"},{default:e(()=>[o(a(r.courseName)+" ",1),t(g,{block:""},{default:e(()=>[o(a(r.batchName),1)]),_:2},1024)]),_:2},1024),t(_,{name:"route"},{default:e(()=>[(m(!0),y(k,null,S(r.passengers,N=>(m(),y("div",{key:N.routeName},[o(a(N.routeName)+" ",1),t(g,{block:""},{default:e(()=>[o(a(N.stoppageName),1)]),_:2},1024)]))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","footer","meta"])]),_:1},8,["is-loading"])]),_:1})],64)}}});export{K as default};
