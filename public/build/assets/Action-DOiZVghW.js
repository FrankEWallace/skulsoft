import{j as x,u as A,i as ee,I as te,m as R,q as oe,r as c,t as D,o as p,w as m,e as d,b as V,d as u,a as y,f as s,v as g,x as i,z as ae,F as k,J as L,y as re,$ as ne,K as z}from"./app-Cvm44xuh.js";import{u as se}from"./useCustomFields-B8b01gVh.js";const le={class:"grid grid-cols-4 gap-6"},de={class:"col-span-4 sm:col-span-1"},ie={class:"col-span-4 sm:col-span-1"},ue={key:0},me={key:1,class:"text-danger"},pe={class:"col-span-4 sm:col-span-1"},ce={class:"col-span-4 sm:col-span-1"},ge={class:"col-span-3 sm:col-span-1"},be={class:"col-span-3 sm:col-span-1"},ye={class:"grid grid-cols-3 gap-6"},fe={class:"col-span-3"},Ve={key:0,class:"col-span-3"},ve={class:"col-span-3 sm:col-span-2"},$e={class:"flex"},Ue={class:"col-span-3 sm:col-span-1"},Ne={class:"col-span-3 sm:col-span-1"},Fe={class:"col-span-3 sm:col-span-1"},Te={class:"mt-4 grid grid-cols-3 gap-6"},_e={class:"col-span-3"},De={key:0,class:"col-span-3 sm:col-span-2"},ke={class:"col-span-3 sm:col-span-1"},Be=["onClick"],Ce={class:"col-span-3 sm:col-span-1"},Se={class:"col-span-3 sm:col-span-1"},Re={class:"mt-2 flex justify-end"},Oe={name:"StudentRegistrationForm"},we=Object.assign(Oe,{setup(H){x();const f=A(),$=ee(),v={period:"",course:"",date:"",enrollmentType:"",studentType:"new",student:"",firstName:"",middleName:"",thirdName:"",lastName:"",birthDate:"",gender:"",contactNumber:"",registrationFee:0,paymentDueDate:"",guardians:[],customFields:[]},B="student/registration/",n=te(B),b=R({genders:[],studentTypes:[],enrollmentTypes:[],guardianTypes:[],relations:[],periods:[],customFields:[]}),U=R({selectedCourse:null}),r=R({...v}),N=R({course:"",isLoaded:!f.params.uuid}),{customFields:q,setCustomFields:E}=se(),G=o=>{Object.assign(b,o),E(b.customFields),v.customFields=q.value,Object.assign(r,z(v))},P=o=>{var e,F,T,C,_;Object.assign(v,{period:o.period.uuid,course:(e=o.course)==null?void 0:e.uuid,enrollmentType:(F=o.enrollmentType)==null?void 0:F.uuid,date:o.date.value,registrationFee:(T=o.fee)==null?void 0:T.value,paymentDueDate:((C=o.paymentDueDate)==null?void 0:C.value)||""}),E(b.customFields,o.customFields),v.customFields=q.value,Object.assign(r,z(v)),U.selectedCourse=o.course,N.period=o.period.name,N.course=(_=o.course)==null?void 0:_.name,N.isLoaded=!0},h=o=>{r.course=o?o.uuid:""},J=()=>{f.params.uuid||(U.selectedCourse=null,r.course="")},I=()=>{r.guardians.push(M())},K=async o=>{await ne()&&r.guardians.splice(o,1)},M=()=>({guardianType:"new",guardian:"",name:"",relation:"",contactNumber:""}),W=o=>{$.push({name:"StudentRegistrationWizard",params:{uuid:o.registration.uuid},query:{}})};return oe(()=>{f.params.uuid||I()}),(o,e)=>{const F=c("BaseSelect"),T=c("BaseSelectSearch"),C=c("FormInfo"),_=c("DatePicker"),S=c("BaseInput"),O=c("BaseFieldset"),w=c("BaseRadioGroup"),j=c("BaseLabel"),Q=c("NameInput"),X=c("BaseButton"),Y=c("CustomField"),Z=c("FormAction");return p(),D(Z,{"pre-requisites":!0,onSetPreRequisites:G,"init-url":B,"init-form":v,form:r,"set-form":P,"after-submit":W},{default:m(()=>[d(O,null,{legend:m(()=>[g(i(o.$trans("student.registration.registration")),1)]),default:m(()=>{var t;return[u("div",le,[u("div",de,[d(F,{modelValue:r.period,"onUpdate:modelValue":e[0]||(e[0]=a=>r.period=a),name:"period",label:o.$trans("global.select",{attribute:o.$trans("academic.period.period")}),options:b.periods,"label-prop":"name","value-prop":"uuid",error:s(n).period,"onUpdate:error":e[1]||(e[1]=a=>s(n).period=a),onChange:J},null,8,["modelValue","label","options","error"])]),u("div",ie,[N.isLoaded?(p(),D(T,{key:0,name:"course",label:o.$trans("global.select",{attribute:o.$trans("academic.course.course")}),modelValue:U.selectedCourse,"onUpdate:modelValue":e[2]||(e[2]=a=>U.selectedCourse=a),error:s(n).course,"onUpdate:error":e[3]||(e[3]=a=>s(n).course=a),"value-prop":"uuid","object-prop":!0,"init-search":N.course,"init-search-key":"name",onChange:h,"additional-search-query":{period:r.period},"search-action":"academic/course/list"},{selectedOption:m(a=>[g(i(a.value.division.name)+" - "+i(a.value.name),1)]),listOption:m(a=>[g(i(a.option.division.name)+" - "+i(a.option.name),1)]),_:1},8,["label","modelValue","error","init-search","additional-search-query"])):V("",!0),r.course&&N.isLoaded&&((t=U.selectedCourse)!=null&&t.uuid)?(p(),D(C,{key:1},{default:m(()=>[U.selectedCourse.enableRegistration?(p(),y("span",ue,i(o.$trans("academic.course.registration_fee_info",{attribute:U.selectedCourse.registrationFee.formatted})),1)):(p(),y("span",me,i(o.$trans("academic.course.registration_disabled_info")),1))]),_:1})):V("",!0)]),u("div",pe,[d(F,{modelValue:r.enrollmentType,"onUpdate:modelValue":e[4]||(e[4]=a=>r.enrollmentType=a),name:"enrollmentType",label:o.$trans("global.select",{attribute:o.$trans("student.enrollment_type.enrollment_type")}),options:b.enrollmentTypes,"label-prop":"name","value-prop":"uuid",error:s(n).enrollmentType,"onUpdate:error":e[5]||(e[5]=a=>s(n).enrollmentType=a)},null,8,["modelValue","label","options","error"])]),u("div",ce,[d(_,{modelValue:r.date,"onUpdate:modelValue":e[6]||(e[6]=a=>r.date=a),name:"date",label:o.$trans("student.registration.props.date"),"no-clear":"",error:s(n).date,"onUpdate:error":e[7]||(e[7]=a=>s(n).date=a)},null,8,["modelValue","label","error"])]),s(f).params.uuid&&s(ae)("registration:action")?(p(),y(k,{key:0},[u("div",ge,[d(S,{currency:"",modelValue:r.registrationFee,"onUpdate:modelValue":e[8]||(e[8]=a=>r.registrationFee=a),name:"registrationFee",label:o.$trans("student.registration.fee"),error:s(n).registrationFee,"onUpdate:error":e[9]||(e[9]=a=>s(n).registrationFee=a)},null,8,["modelValue","label","error"])]),u("div",be,[d(_,{modelValue:r.paymentDueDate,"onUpdate:modelValue":e[10]||(e[10]=a=>r.paymentDueDate=a),name:"paymentDueDate",label:o.$trans("student.registration.props.payment_due_date"),"no-clear":"",error:s(n).paymentDueDate,"onUpdate:error":e[11]||(e[11]=a=>s(n).paymentDueDate=a)},null,8,["modelValue","label","error"])])],64)):V("",!0)])]}),_:1}),s(f).params.uuid?V("",!0):(p(),D(O,{key:0,class:"mt-4"},{legend:m(()=>[g(i(o.$trans("student.student")),1)]),default:m(()=>[u("div",ye,[u("div",fe,[d(w,{"top-margin":"",options:b.studentTypes,name:"studentType",modelValue:r.studentType,"onUpdate:modelValue":e[12]||(e[12]=t=>r.studentType=t),error:s(n).studentType,"onUpdate:error":e[13]||(e[13]=t=>s(n).studentType=t),horizontal:""},null,8,["options","modelValue","error"])]),r.studentType=="existing"?(p(),y("div",Ve,[d(T,{name:"student",label:o.$trans("global.select",{attribute:o.$trans("student.student")}),modelValue:r.student,"onUpdate:modelValue":e[14]||(e[14]=t=>r.student=t),error:s(n).student,"onUpdate:error":e[15]||(e[15]=t=>s(n).student=t),"value-prop":"uuid","search-action":"student/summary","additional-search-query":{allPeriods:!0,status:"all"}},{selectedOption:m(t=>[g(i(t.value.name)+" - "+i(t.value.codeNumber)+" ("+i(t.value.contactNumber)+") ",1)]),listOption:m(t=>[g(i(t.option.name)+" - "+i(t.option.codeNumber)+" ("+i(t.option.contactNumber)+") ",1)]),_:1},8,["label","modelValue","error"])])):V("",!0),r.studentType=="new"?(p(),y(k,{key:1},[u("div",ve,[d(j,null,{default:m(()=>[g(i(o.$trans("student.props.name")),1)]),_:1}),u("div",$e,[d(Q,{firstName:r.firstName,"onUpdate:firstName":e[16]||(e[16]=t=>r.firstName=t),middleName:r.middleName,"onUpdate:middleName":e[17]||(e[17]=t=>r.middleName=t),thirdName:r.thirdName,"onUpdate:thirdName":e[18]||(e[18]=t=>r.thirdName=t),lastName:r.lastName,"onUpdate:lastName":e[19]||(e[19]=t=>r.lastName=t),formErrors:s(n),"onUpdate:formErrors":e[20]||(e[20]=t=>L(n)?n.value=t:null)},null,8,["firstName","middleName","thirdName","lastName","formErrors"])])]),u("div",Ue,[d(j,null,{default:m(()=>[g(i(o.$trans("contact.props.gender")),1)]),_:1}),d(w,{"top-margin":"",options:b.genders,name:"gender",modelValue:r.gender,"onUpdate:modelValue":e[21]||(e[21]=t=>r.gender=t),error:s(n).gender,"onUpdate:error":e[22]||(e[22]=t=>s(n).gender=t),horizontal:""},null,8,["options","modelValue","error"])]),u("div",Ne,[d(_,{modelValue:r.birthDate,"onUpdate:modelValue":e[23]||(e[23]=t=>r.birthDate=t),name:"birthDate",label:o.$trans("contact.props.birth_date"),"no-clear":"",error:s(n).birthDate,"onUpdate:error":e[24]||(e[24]=t=>s(n).birthDate=t)},null,8,["modelValue","label","error"])]),u("div",Fe,[d(S,{type:"text",modelValue:r.contactNumber,"onUpdate:modelValue":e[25]||(e[25]=t=>r.contactNumber=t),name:"contactNumber",label:o.$trans("contact.props.contact_number"),error:s(n).contactNumber,"onUpdate:error":e[26]||(e[26]=t=>s(n).contactNumber=t)},null,8,["modelValue","label","error"])])],64)):V("",!0)])]),_:1})),r.studentType=="new"&&!s(f).params.uuid?(p(),D(O,{key:1,class:"mt-4"},{legend:m(()=>[g(i(o.$trans("guardian.guardian")),1)]),default:m(()=>[(p(!0),y(k,null,re(r.guardians,(t,a)=>(p(),y("div",Te,[u("div",_e,[d(w,{"top-margin":"",options:b.guardianTypes,name:`guardians.${a}.guardianType`,modelValue:t.guardianType,"onUpdate:modelValue":l=>t.guardianType=l,error:s(n)[`guardians.${a}.guardianType`],"onUpdate:error":l=>s(n)[`guardians.${a}.guardianType`]=l,horizontal:""},null,8,["options","name","modelValue","onUpdate:modelValue","error","onUpdate:error"])]),t.guardianType=="existing"?(p(),y("div",De,[d(T,{name:`guardians.${a}.guardian`,label:o.$trans("global.select",{attribute:o.$trans("guardian.guardian")}),modelValue:t.guardian,"onUpdate:modelValue":l=>t.guardian=l,error:s(n)[`guardians.${a}.guardian`],"onUpdate:error":l=>s(n)[`guardians.${a}.guardian`]=l,"value-prop":"uuid","search-action":"guardian/list"},{selectedOption:m(l=>[g(i(l.value.name)+" ("+i(l.value.contactNumber)+") ",1)]),listOption:m(l=>[g(i(l.option.name)+" ("+i(l.option.contactNumber)+") ",1)]),_:2},1032,["name","label","modelValue","onUpdate:modelValue","error","onUpdate:error"])])):V("",!0),t.guardianType=="new"?(p(),y(k,{key:1},[u("div",ke,[d(j,null,{default:m(()=>[g(i(o.$trans("guardian.props.name"))+" ",1),u("span",{class:"text-danger cursor-pointer",onClick:l=>K(a)},e[30]||(e[30]=[u("i",{class:"fas fa-times-circle"},null,-1)]),8,Be)]),_:2},1024),d(S,{type:"text",modelValue:t.name,"onUpdate:modelValue":l=>t.name=l,name:"name",placeholder:o.$trans("guardian.props.name"),error:s(n)[`guardians.${a}.name`],"onUpdate:error":l=>s(n)[`guardians.${a}.name`]=l},null,8,["modelValue","onUpdate:modelValue","placeholder","error","onUpdate:error"])]),u("div",Ce,[d(S,{type:"text",modelValue:t.contactNumber,"onUpdate:modelValue":l=>t.contactNumber=l,name:"contactNumber",label:o.$trans("contact.props.contact_number"),error:s(n)[`guardians.${a}.contactNumber`],"onUpdate:error":l=>s(n)[`guardians.${a}.contactNumber`]=l},null,8,["modelValue","onUpdate:modelValue","label","error","onUpdate:error"])])],64)):V("",!0),u("div",Se,[d(F,{modelValue:t.relation,"onUpdate:modelValue":l=>t.relation=l,name:`guardians.${a}.relation`,label:o.$trans("contact.props.relation"),options:b.relations,"label-prop":"label","value-prop":"value",error:s(n)[`guardians.${a}.relation`],"onUpdate:error":l=>s(n)[`guardians.${a}.relation`]=l},null,8,["modelValue","onUpdate:modelValue","name","label","options","error","onUpdate:error"])])]))),256)),u("div",Re,[d(X,{design:"primary",onClick:e[27]||(e[27]=t=>I())},{default:m(()=>[g(i(o.$trans("global.add",{attribute:o.$trans("guardian.guardian")})),1)]),_:1})])]),_:1})):V("",!0),d(Y,{customFields:r.customFields,"onUpdate:customFields":e[28]||(e[28]=t=>r.customFields=t),formErrors:s(n),"onUpdate:formErrors":e[29]||(e[29]=t=>L(n)?n.value=t:null)},null,8,["customFields","formErrors"])]),_:1},8,["form"])}}}),je={name:"StudentRegistrationAction"},Ie=Object.assign(je,{setup(H){const f=A();return($,v)=>{const B=c("PageHeaderAction"),n=c("PageHeader"),b=c("ParentTransition");return p(),y(k,null,[d(n,{title:$.$trans(s(f).meta.trans,{attribute:$.$trans(s(f).meta.label)}),navs:[{label:$.$trans("student.student"),path:"Student"},{label:$.$trans("student.registration.registration"),path:"StudentRegistration"}]},{default:m(()=>[d(B,{name:"StudentRegistration",title:$.$trans("student.registration.registration"),actions:["list"]},null,8,["title"])]),_:1},8,["title","navs"]),d(b,{appear:"",visibility:!0},{default:m(()=>[d(we)]),_:1})],64)}}});export{Ie as default};
