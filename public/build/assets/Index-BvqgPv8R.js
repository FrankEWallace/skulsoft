import{u as P,k as O,m as g,I as M,q as j,r as s,t as C,o as v,w as a,d as h,e as t,j as E,z,p as $,a as k,f as q,F as L,y as I,v as u,x as p}from"./app-Cvm44xuh.js";const G={class:"grid grid-cols-3 gap-6"},J={class:"col-span-3 sm:col-span-1"},K={class:"col-span-3 sm:col-span-1"},Q={__name:"Filter",props:{initUrl:{type:String,default:""},preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup(w,{emit:c}){P(),O("moment");const b=c,D=w,m={startDate:null,endDate:null,issuedTo:null},r=g({...m});M(D.initUrl);const d=g({isLoaded:!0});return j(async()=>{d.isLoaded=!0}),(n,o)=>{const l=s("DatePicker"),T=s("BaseSelect"),f=s("FilterForm");return v(),C(f,{"init-form":m,multiple:[],form:r,onHide:o[3]||(o[3]=e=>b("hide"))},{default:a(()=>[h("div",G,[h("div",J,[t(l,{start:r.startDate,"onUpdate:start":o[0]||(o[0]=e=>r.startDate=e),end:r.endDate,"onUpdate:end":o[1]||(o[1]=e=>r.endDate=e),name:"dateBetween",as:"range",label:n.$trans("general.date_between")},null,8,["start","end","label"])]),h("div",K,[t(T,{modelValue:r.issuedTo,"onUpdate:modelValue":o[2]||(o[2]=e=>r.issuedTo=e),name:"issuedTo",label:n.$trans("library.transaction.props.to"),options:w.preRequisites.issuedTo},null,8,["modelValue","label","options"])])])]),_:1},8,["form"])}}},W={name:"LibraryReportTopBorrower"},Y=Object.assign(W,{setup(w){const c=P(),b=E();let D=["filter"],m=[];z("library:export")&&(m=["print","pdf","excel"]);const r="library/report/",d=$(!1),n=$(!1),o=g({issuedTo:[]}),l=g({headers:[],data:[],meta:{total:0}}),T=async()=>{n.value=!0,await b.dispatch(r+"preRequisite",{name:"top-borrower",params:c.query}).then(e=>{n.value=!1,Object.assign(o,e)}).catch(e=>{n.value=!1})},f=async()=>{n.value=!0,await b.dispatch(r+"fetchReport",{name:"top-borrower",params:c.query}).then(e=>{n.value=!1,Object.assign(l,e)}).catch(e=>{n.value=!1})};return j(async()=>{await T(),await f()}),(e,y)=>{const H=s("PageHeaderAction"),U=s("PageHeader"),R=s("ParentTransition"),_=s("DataCell"),V=s("TextMuted"),A=s("DataRow"),S=s("DataTable"),x=s("BaseCard");return v(),k(L,null,[t(U,{title:e.$trans(q(c).meta.label),navs:[{label:e.$trans("library.library"),path:"Library"},{label:e.$trans("library.report.report"),path:"LibraryReport"}]},{default:a(()=>[t(H,{url:"library/reports/top-borrower/",name:"LibraryReportTopBorrower",title:e.$trans("library.report.top_borrower.top_borrower"),actions:q(D),"dropdown-actions":q(m),headers:l.headers,onToggleFilter:y[0]||(y[0]=i=>d.value=!d.value)},null,8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"]),t(R,{appear:"",visibility:d.value},{default:a(()=>[t(Q,{onAfterFilter:f,"init-url":r,"pre-requisites":o,onHide:y[1]||(y[1]=i=>d.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"]),t(R,{appear:"",visibility:!0},{default:a(()=>[t(x,{"no-padding":"","no-content-padding":"","is-loading":n.value},{default:a(()=>[t(S,{header:l.headers,footer:l.footers,meta:l.meta,module:"library.report.top_borrower",onRefresh:f},{default:a(()=>[(v(!0),k(L,null,I(l.data,(i,N)=>(v(),C(A,{key:i.uuid},{default:a(()=>[t(_,{name:"sno"},{default:a(()=>[u(p(l.meta.sno+N),1)]),_:2},1024),t(_,{name:"issuedTo"},{default:a(()=>[u(p(i.issueTo),1)]),_:2},1024),t(_,{name:"requester"},{default:a(()=>{var F;return[u(p(((F=i.requester)==null?void 0:F.name)||"-")+" ",1),t(V,{block:""},{default:a(()=>{var B;return[u(p(((B=i.requester)==null?void 0:B.codeNumber)||"-"),1)]}),_:2},1024)]}),_:2},1024),t(_,{name:"requesterDetail"},{default:a(()=>[u(p(i.requesterDetail||"-"),1)]),_:2},1024),t(_,{name:"count"},{default:a(()=>[u(p(i.count),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","footer","meta"])]),_:1},8,["is-loading"])]),_:1})],64)}}});export{Y as default};
