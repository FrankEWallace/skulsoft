import{u as w,H as S,I as J,m as I,q as Q,r as d,t as P,o as V,w as c,d as i,a as H,b as W,e as l,f as r,F as T,y as X,v as $,x as p,N as Y,K as Z}from"./app-Cvm44xuh.js";const x={class:"grid grid-cols-3 gap-6"},ee={class:"col-span-3 sm:col-span-1"},te={class:"col-span-3 sm:col-span-1"},ne={class:"col-span-2 sm:col-span-1"},oe=["onClick"],se={class:"mt-4 grid grid-cols-4 gap-4"},ae={class:"col-span-4 sm:col-span-1"},re={class:"col-span-4 sm:col-span-1"},ie={class:"col-span-4 sm:col-span-2"},le={class:"mt-4"},de={class:"mt-4 grid grid-cols-1 gap-4"},me={class:"col"},ue={class:"col"},ce={name:"InventoryStockAdjustmentForm"},pe=Object.assign(ce,{setup(O){const y=w(),u={date:"",place:"",items:[],description:"",media:[],mediaUpdated:!1,mediaToken:S(),mediaHash:[]},U={uuid:S(),item:"",quantity:1,description:""},j="inventory/stockAdjustment/",a=J(j),_=I({inventories:[],places:[]}),A=I({isLoaded:!y.params.uuid}),n=I({...u}),R=t=>{Object.assign(_,t)},N=()=>{n.mediaToken=S(),n.mediaHash=[]},C=()=>{n.items.push({...U,uuid:S()})},D=async t=>{await Y()&&(n.items.length==1?n.items=[U]:n.items.splice(t,1))},M=t=>{var k,B,h,q,g;let o=[];t.items.forEach(v=>{o.push({uuid:v.uuid,item:v.item,quantity:v.quantity,description:v.description})}),Object.assign(u,{...t,items:o,date:(k=t.date)==null?void 0:k.value,inventory:((B=t.inventory)==null?void 0:B.uuid)||"",place:((h=t.place)==null?void 0:h.uuid)||""}),Object.assign(n,Z(u)),A.inventory=((q=t.inventory)==null?void 0:q.uuid)||"",A.place=((g=t.place)==null?void 0:g.uuid)||"",A.isLoaded=!0},E=t=>{t!=n.inventory&&(n.items=[U])};return Q(async()=>{y.params.uuid||C()}),(t,o)=>{const k=d("BaseSelect"),B=d("DatePicker"),h=d("BaseSelectSearch"),q=d("BaseInput"),g=d("BaseTextarea"),v=d("BaseFieldset"),L=d("HelperText"),K=d("BaseBadge"),z=d("MediaUpload"),G=d("FormAction");return V(),P(G,{"pre-requisites":!0,onSetPreRequisites:R,"init-url":j,"init-form":u,form:n,"set-form":M,redirect:"InventoryStockAdjustment",onResetMediaFiles:N},{default:c(()=>[i("div",x,[i("div",ee,[l(k,{modelValue:n.inventory,"onUpdate:modelValue":o[0]||(o[0]=e=>n.inventory=e),name:"inventory",label:t.$trans("inventory.inventory"),options:_.inventories,"label-prop":"name","value-prop":"uuid",error:r(a).inventory,"onUpdate:error":o[1]||(o[1]=e=>r(a).inventory=e),onChange:E},null,8,["modelValue","label","options","error"])]),i("div",te,[l(k,{modelValue:n.place,"onUpdate:modelValue":o[2]||(o[2]=e=>n.place=e),name:"place",label:t.$trans("inventory.place"),options:_.places,"label-prop":"fullName","value-prop":"uuid",error:r(a).place,"onUpdate:error":o[3]||(o[3]=e=>r(a).place=e)},null,8,["modelValue","label","options","error"])]),i("div",ne,[l(B,{modelValue:n.date,"onUpdate:modelValue":o[4]||(o[4]=e=>n.date=e),name:"date",label:t.$trans("inventory.stock_adjustment.props.date"),"no-clear":"",error:r(a).date,"onUpdate:error":o[5]||(o[5]=e=>r(a).date=e)},null,8,["modelValue","label","error"])])]),n.inventory?(V(),H(T,{key:0},[(V(!0),H(T,null,X(n.items,(e,m)=>(V(),P(v,{class:"mt-4",key:e.uuid},{legend:c(()=>[$(p(t.$trans("inventory.item"))+" "+p(m+1)+". ",1),i("span",{class:"text-danger ml-2 cursor-pointer",onClick:F=>D(m)},o[10]||(o[10]=[i("i",{class:"fas fa-times-circle"},null,-1)]),8,oe)]),default:c(()=>{var F;return[i("div",se,[i("div",ae,[l(h,{name:`items.${m}.item`,label:t.$trans("global.select",{attribute:t.$trans("inventory.stock_item.stock_item")}),modelValue:e.item,"onUpdate:modelValue":s=>e.item=s,error:r(a)[`items.${m}.item`],"onUpdate:error":s=>r(a)[`items.${m}.item`]=s,"value-prop":"uuid","object-prop":!0,"init-search":(F=e==null?void 0:e.item)==null?void 0:F.name,"init-search-key":"name","search-action":"inventory/stockItem/list","additional-search-query":{inventory:n.inventory}},{selectedOption:c(s=>{var b,f;return[$(p(s.value.name)+" "+p((f=(b=s.value)==null?void 0:b.category)==null?void 0:f.name),1)]}),listOption:c(s=>{var b,f;return[$(p(s.option.name)+" "+p((f=(b=s.option)==null?void 0:b.category)==null?void 0:f.name),1)]}),_:2},1032,["name","label","modelValue","onUpdate:modelValue","error","onUpdate:error","init-search","additional-search-query"])]),i("div",re,[l(q,{type:"number",step:.01,modelValue:e.quantity,"onUpdate:modelValue":s=>e.quantity=s,name:`items.${m}.quantity`,label:t.$trans("inventory.stock_adjustment.props.quantity"),error:r(a)[`items.${m}.quantity`],"onUpdate:error":s=>r(a)[`items.${m}.quantity`]=s},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])]),i("div",ie,[l(g,{rows:1,modelValue:e.description,"onUpdate:modelValue":s=>e.description=s,name:`items.${m}.description`,label:t.$trans("inventory.stock_adjustment.props.description"),error:r(a)[`items.${m}.description`],"onUpdate:error":s=>r(a)[`items.${m}.description`]=s},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])])])]}),_:2},1024))),128)),l(L,{class:"dark:text-gray-400"},{default:c(()=>[$(p(t.$trans("inventory.stock_adjustment.negative_quantity_hint")),1)]),_:1}),i("div",le,[l(K,{design:"primary",onClick:C,class:"cursor-pointer"},{default:c(()=>[$(p(t.$trans("global.add",{attribute:t.$trans("inventory.stock_item.stock_item")})),1)]),_:1})])],64)):W("",!0),i("div",de,[i("div",me,[l(g,{rows:1,modelValue:n.description,"onUpdate:modelValue":o[6]||(o[6]=e=>n.description=e),name:"description",label:t.$trans("inventory.stock_adjustment.props.description"),error:r(a).description,"onUpdate:error":o[7]||(o[7]=e=>r(a).description=e)},null,8,["modelValue","label","error"])]),i("div",ue,[l(z,{multiple:"",label:t.$trans("general.file"),module:"stock_adjustment",media:n.media,"media-token":n.mediaToken,onIsUpdated:o[8]||(o[8]=e=>n.mediaUpdated=!0),onSetHash:o[9]||(o[9]=e=>n.mediaHash.push(e))},null,8,["label","media","media-token"])])])]),_:1},8,["form"])}}}),ve={name:"InventoryStockAdjustmentAction"},_e=Object.assign(ve,{setup(O){const y=w();return(u,U)=>{const j=d("PageHeaderAction"),a=d("PageHeader"),_=d("ParentTransition");return V(),H(T,null,[l(a,{title:u.$trans(r(y).meta.trans,{attribute:u.$trans(r(y).meta.label)}),navs:[{label:u.$trans("inventory.inventory"),path:"Inventory"},{label:u.$trans("inventory.stock_adjustment.stock_adjustment"),path:"InventoryStockAdjustmentList"}]},{default:c(()=>[l(j,{name:"InventoryStockAdjustment",title:u.$trans("inventory.stock_adjustment.stock_adjustment"),actions:["list"]},null,8,["title"])]),_:1},8,["title","navs"]),l(_,{appear:"",visibility:!0},{default:c(()=>[l(pe)]),_:1})],64)}}});export{_e as default};
