import{u as x,m as A,q as ee,r as g,t as q,o as v,w as t,d as _,e,b as h,k as L,p as T,I as w,L as C,f as k,a as H,i as te,z as R,F as oe,y as ae,v as n,x as i}from"./app-Cvm44xuh.js";import{u as se}from"./useColumnVisibility-BfQRdpHQ.js";import{i as le,t as re,a as ie}from"./table-FwhM-Z75.js";const ne={class:"grid grid-cols-3 gap-6"},ue={class:"col-span-3 sm:col-span-1"},de={class:"col-span-3 sm:col-span-1"},me={class:"col-span-3 sm:col-span-1"},pe={class:"col-span-3 sm:col-span-1"},ce={class:"col-span-3 sm:col-span-1"},be={class:"col-span-3 sm:col-span-1"},fe={class:"col-span-3 sm:col-span-1"},ge={class:"col-span-3 sm:col-span-1"},ye={class:"col-span-3 sm:col-span-1"},ke={__name:"Filter",props:{preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup(S,{emit:N}){const y=x(),D=N,B={title:"",authors:[],publishers:[],topics:[],languages:[],categories:[],issueStartDate:"",issueEndDate:"",dueStartDate:"",dueEndDate:""},d=A({...B});A({});const f=A({isLoaded:!0,isLoaded:!(y.query.authors||y.query.publishers||y.query.topics||y.query.categories)});return ee(async()=>{f.authors=y.query.authors?y.query.authors.split(","):[],f.publishers=y.query.publishers?y.query.publishers.split(","):[],f.topics=y.query.topics?y.query.topics.split(","):[],f.languages=y.query.languages?y.query.languages.split(","):[],f.categories=y.query.categories?y.query.categories.split(","):[],f.isLoaded=!0}),(c,o)=>{const V=g("BaseInput"),m=g("AutoSuggest"),l=g("BaseSelectSearch"),b=g("DatePicker"),U=g("FilterForm");return v(),q(U,{"init-form":B,form:d,multiple:["authors","publishers","topics","languages","categories"],onHide:o[11]||(o[11]=s=>D("hide"))},{default:t(()=>[_("div",ne,[_("div",ue,[e(V,{type:"text",modelValue:d.number,"onUpdate:modelValue":o[0]||(o[0]=s=>d.number=s),name:"number",label:c.$trans("library.book_copy.props.number")},null,8,["modelValue","label"])]),_("div",de,[e(m,{type:"text",url:"/app/suggestions/library/books",modelValue:d.title,"onUpdate:modelValue":o[1]||(o[1]=s=>d.title=s),name:"title",label:c.$trans("library.book.props.title")},null,8,["modelValue","label"])]),_("div",me,[f.isLoaded?(v(),q(l,{key:0,multiple:"",name:"authors",label:c.$trans("global.select",{attribute:c.$trans("library.book.props.author")}),modelValue:d.authors,"onUpdate:modelValue":o[2]||(o[2]=s=>d.authors=s),"label-prop":"name","value-prop":"uuid","init-search":f.authors,"search-action":"option/list","additional-search-query":{type:"book_author"}},null,8,["label","modelValue","init-search"])):h("",!0)]),_("div",pe,[f.isLoaded?(v(),q(l,{key:0,multiple:"",name:"publishers",label:c.$trans("global.select",{attribute:c.$trans("library.book.props.publisher")}),modelValue:d.publishers,"onUpdate:modelValue":o[3]||(o[3]=s=>d.publishers=s),"label-prop":"name","value-prop":"uuid","init-search":f.publishers,"search-action":"option/list","additional-search-query":{type:"book_publisher"}},null,8,["label","modelValue","init-search"])):h("",!0)]),_("div",ce,[f.isLoaded?(v(),q(l,{key:0,multiple:"",name:"languages",label:c.$trans("global.select",{attribute:c.$trans("library.book.props.language")}),modelValue:d.languages,"onUpdate:modelValue":o[4]||(o[4]=s=>d.languages=s),"label-prop":"name","value-prop":"uuid","init-search":f.languages,"search-action":"option/list","additional-search-query":{type:"book_language"}},null,8,["label","modelValue","init-search"])):h("",!0)]),_("div",be,[f.isLoaded?(v(),q(l,{key:0,multiple:"",name:"topics",label:c.$trans("global.select",{attribute:c.$trans("library.book.props.topic")}),modelValue:d.topics,"onUpdate:modelValue":o[5]||(o[5]=s=>d.topics=s),"label-prop":"name","value-prop":"uuid","init-search":f.topics,"search-action":"option/list","additional-search-query":{type:"book_topic"}},null,8,["label","modelValue","init-search"])):h("",!0)]),_("div",fe,[f.isLoaded?(v(),q(l,{key:0,multiple:"",name:"categories",label:c.$trans("global.select",{attribute:c.$trans("library.book.props.category")}),modelValue:d.categories,"onUpdate:modelValue":o[6]||(o[6]=s=>d.categories=s),"label-prop":"name","value-prop":"uuid","init-search":f.categories,"search-action":"option/list","additional-search-query":{type:"book_category"}},null,8,["label","modelValue","init-search"])):h("",!0)]),_("div",ge,[e(b,{start:d.issueStartDate,"onUpdate:start":o[7]||(o[7]=s=>d.issueStartDate=s),end:d.issueEndDate,"onUpdate:end":o[8]||(o[8]=s=>d.issueEndDate=s),name:"issueDateBetween",as:"range",label:c.$trans("library.transaction.props.issue_date")},null,8,["start","end","label"])]),_("div",ye,[e(b,{start:d.dueStartDate,"onUpdate:start":o[9]||(o[9]=s=>d.dueStartDate=s),end:d.dueEndDate,"onUpdate:end":o[10]||(o[10]=s=>d.dueEndDate=s),name:"dueDateBetween",as:"range",label:c.$trans("library.transaction.props.due_date")},null,8,["start","end","label"])])])]),_:1},8,["form"])}}},_e={class:"grid grid-cols-3 gap-6"},ve={class:"col-span-3 sm:col-span-1"},$e={name:"LibraryBookCopyUpdateBulkCondition"},qe=Object.assign($e,{props:{selected:{type:Object,required:!0},selectAll:{type:Boolean,required:!0},selectedBookCopies:{type:Array,required:!0},preRequisites:{type:Object,required:!0}},emits:["completed"],setup(S,{emit:N}){const y=L("emitter"),D=N,B=S,d={condition:"",selectAll:!1,bookCopies:[]},f="library/bookCopy/";T(!1);const c=w(f),o=A({...d}),V=async()=>{o.selectAll=!1,y.emit("listItems"),D("completed")};return C([()=>B.selectAll,()=>B.selectedBookCopies],([m,l])=>{o.selectAll=m,o.bookCopies=l},{immediate:!0}),(m,l)=>{const b=g("BaseSelect"),U=g("FormAction");return v(),q(U,{"no-card":"","keep-adding":!1,"init-url":f,action:"updateBulkCondition","init-form":d,form:o,"after-submit":V},{default:t(()=>[_("div",_e,[_("div",ve,[e(b,{name:"condition",label:m.$trans("global.select",{attribute:m.$trans("library.book.props.condition")}),modelValue:o.condition,"onUpdate:modelValue":l[0]||(l[0]=s=>o.condition=s),error:k(c).condition,"onUpdate:error":l[1]||(l[1]=s=>k(c).condition=s),options:S.preRequisites.conditions,"label-prop":"name","value-prop":"uuid"},null,8,["label","modelValue","error","options"])])])]),_:1},8,["form"])}}}),Be={class:"grid grid-cols-3 gap-6"},Ve={class:"col-span-3 sm:col-span-1"},he={key:0,class:"col-span-3 sm:col-span-1"},Se={name:"LibraryBookCopyUpdateBulkStatus"},Ae=Object.assign(Se,{props:{selected:{type:Object,required:!0},selectAll:{type:Boolean,required:!0},selectedBookCopies:{type:Array,required:!0},preRequisites:{type:Object,required:!0}},emits:["completed"],setup(S,{emit:N}){const y=L("emitter"),D=N,B=S,d={status:"",holdStatus:"",selectAll:!1,bookCopies:[]},f="library/bookCopy/";T(!1);const c=w(f),o=A({...d}),V=async()=>{o.selectAll=!1,y.emit("listItems"),D("completed")};return C([()=>B.selectAll,()=>B.selectedBookCopies],([m,l])=>{o.selectAll=m,o.bookCopies=l},{immediate:!0}),(m,l)=>{const b=g("BaseSelect"),U=g("FormAction");return v(),q(U,{"no-card":"","keep-adding":!1,"init-url":f,action:"updateBulkStatus","init-form":d,form:o,"after-submit":V},{default:t(()=>[_("div",Be,[_("div",Ve,[e(b,{name:"status",label:m.$trans("global.select",{attribute:m.$trans("library.book_copy.props.status")}),modelValue:o.status,"onUpdate:modelValue":l[0]||(l[0]=s=>o.status=s),error:k(c).status,"onUpdate:error":l[1]||(l[1]=s=>k(c).status=s),options:S.preRequisites.statuses},null,8,["label","modelValue","error","options"])]),o.status=="hold"?(v(),H("div",he,[e(b,{name:"holdStatus",label:m.$trans("global.select",{attribute:m.$trans("library.book_copy.props.hold_status")}),modelValue:o.holdStatus,"onUpdate:modelValue":l[2]||(l[2]=s=>o.holdStatus=s),error:k(c).holdStatus,"onUpdate:error":l[3]||(l[3]=s=>k(c).holdStatus=s),options:S.preRequisites.holdStatuses},null,8,["label","modelValue","error","options"])])):h("",!0)])]),_:1},8,["form"])}}}),Ne={class:"grid grid-cols-3 gap-6"},De={class:"col-span-3 sm:col-span-1"},Ue={class:"col-span-3 sm:col-span-1"},Te={class:"col-span-3 sm:col-span-1"},Ie={name:"LibraryBookCopyUpdateBulkLocation"},Le=Object.assign(Ie,{props:{selected:{type:Object,required:!0},selectAll:{type:Boolean,required:!0},selectedBookCopies:{type:Array,required:!0},preRequisites:{type:Object,required:!0}},emits:["completed"],setup(S,{emit:N}){const y=L("emitter"),D=N,B=S,d={roomNumber:"",rackNumber:"",shelfNumber:"",selectAll:!1,bookCopies:[]},f="library/bookCopy/";T(!1);const c=w(f),o=A({...d}),V=async()=>{o.selectAll=!1,y.emit("listItems"),D("completed")};return C([()=>B.selectAll,()=>B.selectedBookCopies],([m,l])=>{o.selectAll=m,o.bookCopies=l},{immediate:!0}),(m,l)=>{const b=g("BaseInput"),U=g("FormAction");return v(),q(U,{"no-card":"","keep-adding":!1,"init-url":f,action:"updateBulkLocation","init-form":d,form:o,"after-submit":V},{default:t(()=>[_("div",Ne,[_("div",De,[e(b,{type:"text",modelValue:o.roomNumber,"onUpdate:modelValue":l[0]||(l[0]=s=>o.roomNumber=s),name:"roomNumber",label:m.$trans("library.book_addition.props.room_number"),error:k(c).roomNumber,"onUpdate:error":l[1]||(l[1]=s=>k(c).roomNumber=s)},null,8,["modelValue","label","error"])]),_("div",Ue,[e(b,{type:"text",modelValue:o.rackNumber,"onUpdate:modelValue":l[2]||(l[2]=s=>o.rackNumber=s),name:"rackNumber",label:m.$trans("library.book_addition.props.rack_number"),error:k(c).rackNumber,"onUpdate:error":l[3]||(l[3]=s=>k(c).rackNumber=s)},null,8,["modelValue","label","error"])]),_("div",Te,[e(b,{type:"text",modelValue:o.shelfNumber,"onUpdate:modelValue":l[4]||(l[4]=s=>o.shelfNumber=s),name:"shelfNumber",label:m.$trans("library.book_addition.props.shelf_number"),error:k(c).shelfNumber,"onUpdate:error":l[5]||(l[5]=s=>k(c).shelfNumber=s)},null,8,["modelValue","label","error"])])])]),_:1},8,["form"])}}}),Ce={class:"mt-8 px-4 pb-4"},Fe={name:"LibraryBookCopyList"},Pe=Object.assign(Fe,{setup(S){const N=te(),y=L("emitter"),{applyVisibility:D}=se("LibraryBookCopy");let B=["filter"],d=[];R("book:export")&&(d=["print","pdf","excel","export_all_excel"]),R("book-addition:create")&&d.unshift("import");const f="library/bookCopy/",c=A({conditions:[]}),o=T(!1),V=T(!1),m=A({selectAll:!1,selectedBookCopies:[],activeTab:"updateCondition"}),l=A({}),b=A({...le}),U=$=>{$.headers=D($.headers),Object.assign(l,$),b.pageItems=l.data.map(u=>u.uuid)},s=()=>{b.items=[],b.pageItems=[],b.all=!1},G=$=>{Object.assign(c,$)};return C(()=>[b.items,b.pageItems],([$,u],[P,O])=>{m.selectedBookCopies=$,b.all=ie(b)}),($,u)=>{const P=g("BaseButton"),O=g("PageHeaderAction"),M=g("PageHeader"),z=g("BaseImport"),I=g("ParentTransition"),J=g("BaseArrayCheckbox"),K=g("BaseCheckbox"),p=g("DataCell"),F=g("TextMuted"),Q=g("DataRow"),W=g("DataTable"),j=g("TabItem"),X=g("TabGroup"),Y=g("BaseCard"),Z=g("ListItem");return v(),q(Z,{"init-url":f,"pre-requisites":!0,onSetPreRequisites:G,onSetItems:U},{header:t(()=>[e(M,{title:$.$trans("library.book_copy.book_copy"),navs:[{label:$.$trans("library.library"),path:"Library"}]},{default:t(()=>[e(O,{url:"library/book-copies/",name:"LibraryBookCopy",title:$.$trans("library.book_copy.book_copy"),actions:k(B),"dropdown-actions":k(d),headers:l.headers,onToggleFilter:u[1]||(u[1]=a=>o.value=!o.value),onToggleImport:u[2]||(u[2]=a=>V.value=!V.value)},{default:t(()=>[e(P,{design:"white",onClick:u[0]||(u[0]=a=>k(N).push({name:"LibraryBookLabel"}))},{default:t(()=>[n(i($.$trans("global.print",{attribute:$.$trans("library.book.label")})),1)]),_:1})]),_:1},8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"])]),import:t(()=>[e(I,{appear:"",visibility:V.value},{default:t(()=>[e(z,{path:"library/book-copies/import",onCancelled:u[3]||(u[3]=a=>V.value=!1),onHide:u[4]||(u[4]=a=>V.value=!1),onCompleted:u[5]||(u[5]=a=>k(y).emit("listItems"))})]),_:1},8,["visibility"])]),filter:t(()=>[e(I,{appear:"",visibility:o.value},{default:t(()=>[e(ke,{onRefresh:u[6]||(u[6]=a=>k(y).emit("listItems")),"pre-requisites":c,onHide:u[7]||(u[7]=a=>o.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"])]),default:t(()=>[e(I,{appear:"",visibility:!0},{default:t(()=>[e(W,{onToggleSelectAll:u[10]||(u[10]=a=>b.items=k(re)(a,b)),onToggleGlobalSelect:u[11]||(u[11]=a=>b.global=!b.global),selected:b,header:l.headers,meta:l.meta,module:"library.book_copy",onRefresh:u[12]||(u[12]=a=>k(y).emit("listItems"))},{actionButton:t(()=>u[16]||(u[16]=[])),default:t(()=>[(v(!0),H(oe,null,ae(l.data,a=>(v(),q(Q,{key:a.uuid},{default:t(()=>[e(p,{name:"selectAll"},{default:t(()=>[b.global?h("",!0):(v(),q(J,{key:0,items:b.items,"onUpdate:items":u[8]||(u[8]=r=>b.items=r),value:a.uuid},null,8,["items","value"])),b.global?(v(),q(K,{key:1,modelValue:b.global,"onUpdate:modelValue":u[9]||(u[9]=r=>b.global=r)},null,8,["modelValue"])):h("",!0)]),_:2},1024),e(p,{name:"number"},{default:t(()=>[n(i(a.number),1)]),_:2},1024),e(p,{name:"book"},{default:t(()=>[n(i(a.book.title)+" ",1),e(F,{block:""},{default:t(()=>[n(i(a.book.subTitle),1)]),_:2},1024)]),_:2},1024),e(p,{name:"issueStatus"},{default:t(()=>{var r;return[n(i(((r=a.issueStatus)==null?void 0:r.label)||"-"),1)]}),_:2},1024),e(p,{name:"transactionCodeNumber"},{default:t(()=>[n(i(a.transactionCodeNumber||"-"),1)]),_:2},1024),e(p,{name:"issuedTo"},{default:t(()=>[n(i(a.issuedTo||"-"),1)]),_:2},1024),e(p,{name:"requester"},{default:t(()=>{var r;return[n(i(((r=a.requester)==null?void 0:r.name)||"-")+" ",1),e(F,{block:""},{default:t(()=>{var E;return[n(i((E=a.requester)==null?void 0:E.codeNumber),1)]}),_:2},1024)]}),_:2},1024),e(p,{name:"requesterDetail"},{default:t(()=>[n(i(a.requesterDetail||"-"),1)]),_:2},1024),e(p,{name:"issueDate"},{default:t(()=>{var r;return[n(i(((r=a.issueDate)==null?void 0:r.formatted)||"-"),1)]}),_:2},1024),e(p,{name:"dueDate"},{default:t(()=>{var r;return[n(i(((r=a.dueDate)==null?void 0:r.formatted)||"-"),1)]}),_:2},1024),e(p,{name:"copiesCount"},{default:t(()=>{var r;return[n(i(((r=a.book)==null?void 0:r.copiesCount)||"-"),1)]}),_:2},1024),e(p,{name:"holdStatus"},{default:t(()=>{var r;return[n(i(((r=a.holdStatus)==null?void 0:r.label)||"-"),1)]}),_:2},1024),e(p,{name:"category"},{default:t(()=>{var r;return[n(i(((r=a.book.category)==null?void 0:r.name)||"-"),1)]}),_:2},1024),e(p,{name:"author"},{default:t(()=>{var r;return[n(i(((r=a.book.author)==null?void 0:r.name)||"-"),1)]}),_:2},1024),e(p,{name:"publisher"},{default:t(()=>{var r;return[n(i(((r=a.book.publisher)==null?void 0:r.name)||"-"),1)]}),_:2},1024),e(p,{name:"topic"},{default:t(()=>{var r;return[n(i(((r=a.book.topic)==null?void 0:r.name)||"-"),1)]}),_:2},1024),e(p,{name:"language"},{default:t(()=>{var r;return[n(i(((r=a.book.language)==null?void 0:r.name)||"-"),1)]}),_:2},1024),e(p,{name:"isbnNumber"},{default:t(()=>[n(i(a.book.isbnNumber),1)]),_:2},1024),e(p,{name:"callNumber"},{default:t(()=>[n(i(a.book.callNumber),1)]),_:2},1024),e(p,{name:"yearPublished"},{default:t(()=>[n(i(a.book.yearPublished),1)]),_:2},1024),e(p,{name:"subject"},{default:t(()=>[n(i(a.book.subject),1)]),_:2},1024),e(p,{name:"volume"},{default:t(()=>[n(i(a.book.volume),1)]),_:2},1024),e(p,{name:"edition"},{default:t(()=>[n(i(a.book.edition),1)]),_:2},1024),e(p,{name:"page"},{default:t(()=>[n(i(a.book.page),1)]),_:2},1024),e(p,{name:"price"},{default:t(()=>{var r;return[n(i(((r=a.book.price)==null?void 0:r.formatted)||"-"),1)]}),_:2},1024),e(p,{name:"additionDate"},{default:t(()=>{var r;return[n(i(((r=a.bookAdditionDate)==null?void 0:r.formatted)||"-"),1)]}),_:2},1024),e(p,{name:"vendor"},{default:t(()=>[n(i(a.vendor)+" ",1),e(F,{block:""},{default:t(()=>[n(i(a.invoiceNumber)+" "+i(a.invoiceDate.formatted),1)]),_:2},1024)]),_:2},1024),e(p,{name:"invoiceNumber"},{default:t(()=>[n(i(a.invoiceNumber),1)]),_:2},1024),e(p,{name:"invoiceDate"},{default:t(()=>[n(i(a.invoiceDate.formatted),1)]),_:2},1024),e(p,{name:"location"},{default:t(()=>[n(i(a.location),1)]),_:2},1024),e(p,{name:"roomNumber"},{default:t(()=>[n(i(a.roomNumber),1)]),_:2},1024),e(p,{name:"rackNumber"},{default:t(()=>[n(i(a.rackNumber),1)]),_:2},1024),e(p,{name:"shelfNumber"},{default:t(()=>[n(i(a.shelfNumber),1)]),_:2},1024),e(p,{name:"condition"},{default:t(()=>{var r;return[n(i(((r=a.condition)==null?void 0:r.name)||"-"),1)]}),_:2},1024),e(p,{name:"createdAt"},{default:t(()=>[n(i(a.createdAt.formatted),1)]),_:2},1024),e(p,{name:"action"})]),_:2},1024))),128))]),_:1},8,["selected","header","meta"])]),_:1}),b.items.length>0&&k(R)("book:edit")?(v(),q(I,{key:0,appear:"",visibility:!0},{default:t(()=>[e(Y,{class:"mt-4","no-padding":"","no-content-padding":""},{title:t(()=>[n(i($.$trans("general.action")),1)]),default:t(()=>[e(X,null,{default:t(()=>[e(j,{first:"",label:$.$trans("library.book.props.condition"),onClick:u[13]||(u[13]=a=>m.activeTab="updateCondition"),"is-active":m.activeTab=="updateCondition"},null,8,["label","is-active"]),e(j,{label:$.$trans("library.book_copy.props.status"),onClick:u[14]||(u[14]=a=>m.activeTab="updateStatus"),"is-active":m.activeTab=="updateStatus"},null,8,["label","is-active"]),e(j,{last:"",label:$.$trans("library.book_addition.props.location"),onClick:u[15]||(u[15]=a=>m.activeTab="updateLocation"),"is-active":m.activeTab=="updateLocation"},null,8,["label","is-active"])]),_:1}),_("div",Ce,[m.activeTab=="updateCondition"?(v(),q(qe,{key:0,selected:b,"select-all":m.selectAll,"selected-book-copies":m.selectedBookCopies,onCompleted:s,"pre-requisites":c},null,8,["selected","select-all","selected-book-copies","pre-requisites"])):h("",!0),m.activeTab=="updateStatus"?(v(),q(Ae,{key:1,selected:b,"select-all":m.selectAll,"selected-book-copies":m.selectedBookCopies,onCompleted:s,"pre-requisites":c},null,8,["selected","select-all","selected-book-copies","pre-requisites"])):h("",!0),m.activeTab=="updateLocation"?(v(),q(Le,{key:2,selected:b,"select-all":m.selectAll,"selected-book-copies":m.selectedBookCopies,onCompleted:s,"pre-requisites":c},null,8,["selected","select-all","selected-book-copies","pre-requisites"])):h("",!0)])]),_:1})]),_:1})):h("",!0)]),_:1})}}});export{Pe as default};
