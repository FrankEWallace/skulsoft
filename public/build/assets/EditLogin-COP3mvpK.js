import{u as T,i as A,k as D,m as U,I as H,c as z,q as K,K as M,r as u,a as d,o as l,t as v,b as p,e as i,f as r,w as V,F as C,d as g,v as h,x as G,z as S}from"./app-Cvm44xuh.js";const J={class:"grid grid-cols-3 gap-6"},Q={class:"col-span-3 sm:col-span-1"},W={class:"grid grid-cols-3 gap-6"},X={class:"col-span-3 sm:col-span-1"},Y={key:0,class:"col-span-3 sm:col-span-1"},Z={key:1,class:"col-span-3 sm:col-span-1"},_={key:2,class:"col-span-3 sm:col-span-1"},ee={key:3,class:"col-span-3 sm:col-span-1"},oe={class:"col-span-3 sm:col-span-1"},se={class:"col-span-3 sm:col-span-1"},ae={name:"EmployeeEditLogin"},te=Object.assign(ae,{props:{employee:{type:Object,default(){return{}}}},setup(c){const B=T(),E=A(),q=D("emitter"),k=c,f={username:"",email:"",forceChangePassword:!1,password:"",passwordConfirmation:"",roles:[]},w="employee/",j="user/",P=U({}),t=H(w),y=z(()=>k.employee.contact.user),n=U({isValidated:!1,existingUser:null}),a=U({...f}),x=s=>{Object.assign(P,s)},F=s=>{n.isValidated=!0,n.existingUser=s||null,a.username=s==null?void 0:s.username},R=()=>{q.emit("employeeUpdated"),E.push({name:"EmployeeShowLogin",params:{uuid:k.employee.uuid}})};return K(async()=>{var s,e,b;n.isValidated=!!y.value,n.existingUser=y.value,Object.assign(f,{username:(s=y.value)==null?void 0:s.username,email:(e=y.value)==null?void 0:e.email,roles:((b=y.value)==null?void 0:b.roles.map(m=>m.uuid))||[]}),Object.assign(a,M(f))}),(s,e)=>{const b=u("PageHeader"),m=u("BaseInput"),O=u("BaseButton"),$=u("FormAction"),N=u("BaseSelect"),I=u("BaseSwitch"),L=u("ParentTransition");return l(),d(C,null,[c.employee.uuid?(l(),v(b,{key:0,title:s.$trans(r(B).meta.trans,{attribute:s.$trans(r(B).meta.label)}),navs:[{label:s.$trans("employee.employee"),path:"Employee"},{label:c.employee.contact.name,path:{name:"EmployeeShow",params:{uuid:c.employee.uuid}}}]},null,8,["title","navs"])):p("",!0),i(L,{appear:"",visibility:!0},{default:V(()=>[c.employee.uuid?(l(),d(C,{key:0},[n.isValidated?(l(),v($,{key:1,"no-data-fetch":"","pre-requisites":!0,"pre-requisite-url":j,onSetPreRequisites:x,"init-url":w,action:n.existingUser?"updateUser":"createUser","init-form":f,form:a,"after-submit":R},{default:V(()=>[g("div",W,[g("div",X,[i(m,{readonly:"",disabled:"",type:"text",modelValue:a.email,"onUpdate:modelValue":e[2]||(e[2]=o=>a.email=o),name:"email",label:s.$trans("contact.login.props.email"),error:r(t).email,"onUpdate:error":e[3]||(e[3]=o=>r(t).email=o)},null,8,["modelValue","label","error"])]),n.existingUser?(l(),d("div",Y,[i(m,{readonly:"",disabled:"",type:"text",modelValue:a.username,"onUpdate:modelValue":e[4]||(e[4]=o=>a.username=o),name:"username",label:s.$trans("contact.login.props.username"),error:r(t).username,"onUpdate:error":e[5]||(e[5]=o=>r(t).username=o)},null,8,["modelValue","label","error"])])):p("",!0),n.existingUser?p("",!0):(l(),d("div",Z,[i(m,{type:"text",modelValue:a.username,"onUpdate:modelValue":e[6]||(e[6]=o=>a.username=o),name:"username",label:s.$trans("contact.login.props.username"),error:r(t).username,"onUpdate:error":e[7]||(e[7]=o=>r(t).username=o)},null,8,["modelValue","label","error"])])),!n.existingUser||n.existingUser&&r(S)("user:change-role")?(l(),d("div",_,[i(N,{modelValue:a.roles,"onUpdate:modelValue":e[8]||(e[8]=o=>a.roles=o),name:"roles",label:s.$trans("contact.login.props.role"),options:P.roles,multiple:"","label-prop":"label","value-prop":"uuid",error:r(t).roles,"onUpdate:error":e[9]||(e[9]=o=>r(t).roles=o)},null,8,["modelValue","label","options","error"])])):p("",!0),n.existingUser&&r(S)("user:force-change-password")?(l(),d("div",ee,[i(I,{vertical:"",modelValue:a.forceChangePassword,"onUpdate:modelValue":e[10]||(e[10]=o=>a.forceChangePassword=o),name:"forceChangePassword",label:s.$trans("global.change",{attribute:s.$trans("contact.login.props.password")}),error:r(t).forceChangePassword,"onUpdate:error":e[11]||(e[11]=o=>r(t).forceChangePassword=o)},null,8,["modelValue","label","error"])])):p("",!0),!n.existingUser||a.forceChangePassword?(l(),d(C,{key:4},[g("div",oe,[i(m,{type:"password",modelValue:a.password,"onUpdate:modelValue":e[12]||(e[12]=o=>a.password=o),name:"password",label:s.$trans("contact.login.props.password"),error:r(t).password,"onUpdate:error":e[13]||(e[13]=o=>r(t).password=o)},null,8,["modelValue","label","error"])]),g("div",se,[i(m,{type:"password",modelValue:a.passwordConfirmation,"onUpdate:modelValue":e[14]||(e[14]=o=>a.passwordConfirmation=o),name:"passwordConfirmation",label:s.$trans("contact.login.props.password_confirmation"),error:r(t).passwordConfirmation,"onUpdate:error":e[15]||(e[15]=o=>r(t).passwordConfirmation=o)},null,8,["modelValue","label","error"])])],64)):p("",!0)])]),_:1},8,["action","form"])):(l(),v($,{key:0,"no-action-button":"","no-data-fetch":"","init-url":w,action:"confirmUser","init-form":f,form:a,"after-submit":F,"stay-on":"",redirect:{name:"EmployeeShowLogin",params:{uuid:c.employee.uuid}}},{default:V(()=>[g("div",J,[g("div",Q,[i(m,{type:"text",modelValue:a.email,"onUpdate:modelValue":e[0]||(e[0]=o=>a.email=o),name:"email",label:s.$trans("contact.login.props.email"),error:r(t).email,"onUpdate:error":e[1]||(e[1]=o=>r(t).email=o)},null,8,["modelValue","label","error"])])]),i(O,{class:"mt-4",type:"submit"},{default:V(()=>[h(G(s.$trans("general.validate")),1)]),_:1})]),_:1},8,["form","redirect"]))],64)):p("",!0)]),_:1})],64)}}});export{te as default};
