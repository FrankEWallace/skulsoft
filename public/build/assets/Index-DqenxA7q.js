import{u as z,m as V,q as G,r as b,t as f,o as g,w as e,d as C,e as o,b as $,i as J,k as K,z as _,p as S,f as r,a as Q,F as W,y as X,v as p,x as d}from"./app-Cvm44xuh.js";import{u as Y}from"./useColumnVisibility-BfQRdpHQ.js";const Z={class:"grid grid-cols-3 gap-6"},x={class:"col-span-3 sm:col-span-1"},ee={class:"col-span-3 sm:col-span-1"},te={class:"col-span-3 sm:col-span-1"},ae={class:"col-span-3 sm:col-span-1"},oe={class:"col-span-3 sm:col-span-1"},se={class:"col-span-3 sm:col-span-1"},le={__name:"Filter",props:{preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup(R,{emit:k}){const s=z(),I=k,L={title:"",authors:[],publishers:[],topics:[],languages:[],categories:[]},u=V({...L});V({});const n=V({isLoaded:!0,isLoaded:!(s.query.authors||s.query.publishers||s.query.topics||s.query.categories)});return G(async()=>{n.authors=s.query.authors?s.query.authors.split(","):[],n.publishers=s.query.publishers?s.query.publishers.split(","):[],n.topics=s.query.topics?s.query.topics.split(","):[],n.languages=s.query.languages?s.query.languages.split(","):[],n.categories=s.query.categories?s.query.categories.split(","):[],n.isLoaded=!0}),(c,l)=>{const q=b("AutoSuggest"),h=b("BaseSelectSearch"),B=b("FilterForm");return g(),f(B,{"init-form":L,form:u,multiple:["authors","publishers","topics","languages","categories"],onHide:l[6]||(l[6]=y=>I("hide"))},{default:e(()=>[C("div",Z,[C("div",x,[o(q,{type:"text",url:"/app/suggestions/library/books",modelValue:u.title,"onUpdate:modelValue":l[0]||(l[0]=y=>u.title=y),name:"title",label:c.$trans("library.book.props.title")},null,8,["modelValue","label"])]),C("div",ee,[n.isLoaded?(g(),f(h,{key:0,multiple:"",name:"authors",label:c.$trans("global.select",{attribute:c.$trans("library.book.props.author")}),modelValue:u.authors,"onUpdate:modelValue":l[1]||(l[1]=y=>u.authors=y),"label-prop":"name","value-prop":"uuid","init-search":n.authors,"search-action":"option/list","additional-search-query":{type:"book_author"}},null,8,["label","modelValue","init-search"])):$("",!0)]),C("div",te,[n.isLoaded?(g(),f(h,{key:0,multiple:"",name:"publishers",label:c.$trans("global.select",{attribute:c.$trans("library.book.props.publisher")}),modelValue:u.publishers,"onUpdate:modelValue":l[2]||(l[2]=y=>u.publishers=y),"label-prop":"name","value-prop":"uuid","init-search":n.publishers,"search-action":"option/list","additional-search-query":{type:"book_publisher"}},null,8,["label","modelValue","init-search"])):$("",!0)]),C("div",ae,[n.isLoaded?(g(),f(h,{key:0,multiple:"",name:"languages",label:c.$trans("global.select",{attribute:c.$trans("library.book.props.language")}),modelValue:u.languages,"onUpdate:modelValue":l[3]||(l[3]=y=>u.languages=y),"label-prop":"name","value-prop":"uuid","init-search":n.languages,"search-action":"option/list","additional-search-query":{type:"book_language"}},null,8,["label","modelValue","init-search"])):$("",!0)]),C("div",oe,[n.isLoaded?(g(),f(h,{key:0,multiple:"",name:"topics",label:c.$trans("global.select",{attribute:c.$trans("library.book.props.topic")}),modelValue:u.topics,"onUpdate:modelValue":l[4]||(l[4]=y=>u.topics=y),"label-prop":"name","value-prop":"uuid","init-search":n.topics,"search-action":"option/list","additional-search-query":{type:"book_topic"}},null,8,["label","modelValue","init-search"])):$("",!0)]),C("div",se,[n.isLoaded?(g(),f(h,{key:0,multiple:"",name:"categories",label:c.$trans("global.select",{attribute:c.$trans("library.book.props.category")}),modelValue:u.categories,"onUpdate:modelValue":l[5]||(l[5]=y=>u.categories=y),"label-prop":"name","value-prop":"uuid","init-search":n.categories,"search-action":"option/list","additional-search-query":{type:"book_category"}},null,8,["label","modelValue","init-search"])):$("",!0)])])]),_:1},8,["form"])}}},ie={name:"LibraryBookList"},ue=Object.assign(ie,{setup(R){const k=J(),s=K("emitter"),{applyVisibility:I}=Y("LibraryBook");let L=["filter"];_("book:create")&&L.unshift("create");let u=[];_("book:export")&&(u=["print","pdf","excel","export_all_excel"]),_("book:create")&&u.unshift("import");const n="library/book/",c=V({authors:[],publishers:[],topics:[],languages:[]}),l=S(!1),q=S(!1),h=V({}),B=V({withCopy:!0}),y=i=>{Object.assign(c,i)},T=i=>{i.headers=I(i.headers),Object.assign(h,i)};return(i,a)=>{const w=b("BaseButton"),A=b("PageHeaderAction"),P=b("PageHeader"),U=b("BaseCheckbox"),H=b("BaseImport"),D=b("ParentTransition"),M=b("TextMuted"),v=b("DataCell"),F=b("FloatingMenuItem"),N=b("FloatingMenu"),j=b("DataRow"),O=b("DataTable"),E=b("ListItem");return g(),f(E,{"init-url":n,"pre-requisites":!0,onSetPreRequisites:y,onSetItems:T},{header:e(()=>[o(P,{title:i.$trans("library.book.book"),navs:[{label:i.$trans("library.library"),path:"Library"}]},{default:e(()=>[o(A,{url:"library/books/",name:"LibraryBook",title:i.$trans("library.book.book"),actions:r(L),"dropdown-actions":r(u),headers:h.headers,onToggleFilter:a[3]||(a[3]=t=>l.value=!l.value),onToggleImport:a[4]||(a[4]=t=>q.value=!q.value)},{after:e(()=>[r(_)("library:config")?(g(),f(w,{key:0,design:"white",onClick:a[2]||(a[2]=t=>r(k).push({name:"LibraryConfig"}))},{default:e(()=>a[13]||(a[13]=[C("i",{class:"fas fa-cog"},null,-1)])),_:1,__:[13]})):$("",!0)]),default:e(()=>[o(w,{design:"white",onClick:a[0]||(a[0]=t=>r(k).push({name:"LibraryBookCopyList"}))},{default:e(()=>[p(d(i.$trans("library.book_copy.book_copies")),1)]),_:1}),o(w,{design:"white",onClick:a[1]||(a[1]=t=>r(k).push({name:"LibraryBookLabel"}))},{default:e(()=>[p(d(i.$trans("global.print",{attribute:i.$trans("library.book.label")})),1)]),_:1})]),_:1},8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"])]),import:e(()=>[o(D,{appear:"",visibility:q.value},{default:e(()=>[o(H,{path:"library/books/import","additional-option":{withCopy:B.withCopy},onCancelled:a[6]||(a[6]=t=>q.value=!1),onHide:a[7]||(a[7]=t=>q.value=!1),onCompleted:a[8]||(a[8]=t=>r(s).emit("listItems"))},{option:e(()=>[o(U,{modelValue:B.withCopy,"onUpdate:modelValue":a[5]||(a[5]=t=>B.withCopy=t),name:"withCopy",label:i.$trans("library.book.import_with_copy")},null,8,["modelValue","label"])]),_:1},8,["additional-option"])]),_:1},8,["visibility"])]),filter:e(()=>[o(D,{appear:"",visibility:l.value},{default:e(()=>[o(le,{onRefresh:a[9]||(a[9]=t=>r(s).emit("listItems")),"pre-requisites":c,onHide:a[10]||(a[10]=t=>l.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"])]),default:e(()=>[o(D,{appear:"",visibility:!0},{default:e(()=>[o(O,{header:h.headers,meta:h.meta,module:"library.book",onRefresh:a[12]||(a[12]=t=>r(s).emit("listItems"))},{actionButton:e(()=>[r(_)("book:create")?(g(),f(w,{key:0,onClick:a[11]||(a[11]=t=>r(k).push({name:"LibraryBookCreate"}))},{default:e(()=>[p(d(i.$trans("global.add",{attribute:i.$trans("library.book.book")})),1)]),_:1})):$("",!0)]),default:e(()=>[(g(!0),Q(W,null,X(h.data,t=>(g(),f(j,{key:t.uuid,onDoubleClick:m=>r(k).push({name:"LibraryBookShow",params:{uuid:t.uuid}})},{default:e(()=>[o(v,{name:"title"},{default:e(()=>[p(d(t.title)+" ",1),o(M,{block:""},{default:e(()=>[p(d(t.subTitle),1)]),_:2},1024)]),_:2},1024),o(v,{name:"copies"},{default:e(()=>[p(d(t.copiesCount),1)]),_:2},1024),o(v,{name:"availableCopies"},{default:e(()=>[p(d(t.availableCopiesCount),1)]),_:2},1024),o(v,{name:"author"},{default:e(()=>{var m;return[p(d(((m=t.author)==null?void 0:m.name)||"-"),1)]}),_:2},1024),o(v,{name:"publisher"},{default:e(()=>{var m;return[p(d(((m=t.publisher)==null?void 0:m.name)||"-"),1)]}),_:2},1024),o(v,{name:"topic"},{default:e(()=>{var m;return[p(d(((m=t.topic)==null?void 0:m.name)||"-"),1)]}),_:2},1024),o(v,{name:"category"},{default:e(()=>{var m;return[p(d(((m=t.category)==null?void 0:m.name)||"-"),1)]}),_:2},1024),o(v,{name:"isbnNumber"},{default:e(()=>[p(d(t.isbnNumber),1)]),_:2},1024),o(v,{name:"createdAt"},{default:e(()=>[p(d(t.createdAt.formatted),1)]),_:2},1024),o(v,{name:"action"},{default:e(()=>[o(N,null,{default:e(()=>[o(F,{icon:"fas fa-arrow-circle-right",onClick:m=>r(k).push({name:"LibraryBookShow",params:{uuid:t.uuid}})},{default:e(()=>[p(d(i.$trans("general.show")),1)]),_:2},1032,["onClick"]),r(_)("book:edit")?(g(),f(F,{key:0,icon:"fas fa-edit",onClick:m=>r(k).push({name:"LibraryBookEdit",params:{uuid:t.uuid}})},{default:e(()=>[p(d(i.$trans("general.edit")),1)]),_:2},1032,["onClick"])):$("",!0),r(_)("book:create")?(g(),f(F,{key:1,icon:"fas fa-copy",onClick:m=>r(k).push({name:"LibraryBookDuplicate",params:{uuid:t.uuid}})},{default:e(()=>[p(d(i.$trans("general.duplicate")),1)]),_:2},1032,["onClick"])):$("",!0),r(_)("book:delete")?(g(),f(F,{key:2,icon:"fas fa-trash",onClick:m=>r(s).emit("deleteItem",{uuid:t.uuid})},{default:e(()=>[p(d(i.$trans("general.delete")),1)]),_:2},1032,["onClick"])):$("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onDoubleClick"]))),128))]),_:1},8,["header","meta"])]),_:1})]),_:1})}}});export{ue as default};
