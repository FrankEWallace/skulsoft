import{j as se,u as oe,i as ne,m as h,I as re,p as I,r as u,a as c,o as n,e as s,w as e,f as m,t as d,b as p,d as _,v as r,x as l,F as B,y as V,z as U,N as ue}from"./app-Cvm44xuh.js";const ie={class:"py-2 px-4"},de={key:0},pe={key:1},me={class:"space-y-4"},ce={class:"grid grid-cols-1 gap-x-4 gap-y-8 sm:grid-cols-2"},ve={class:"grid grid-cols-2 gap-6"},ye={class:"col-span-2 sm:col-span-1"},fe={class:"dark:text-gray-400"},be={key:0,class:"col-span-2 sm:col-span-1"},_e={class:"col-span-2"},ge={name:"EmployeeLeaveRequestShow"},ke=Object.assign(ge,{setup(qe){const P=se(),R=oe(),T=ne(),z={},A={dates:"",status:"",comment:""},D="employee/leave/request/",H=h({statuses:[]}),g=re(D),$=I(!1),v=h({...A}),q=h({isLeaveRequestFetched:!1,leaveRequests:[]}),L=I(!1),a=h({...z}),N=t=>{Object.assign(H,t)},j=t=>{Object.assign(a,t)},O=()=>{L.value=!0},M=async()=>{await ue()&&($.value=!0,P.dispatch("employee/leave/request/undoStatus",{uuid:a.uuid}).then(()=>{L.value=!0,$.value=!1}).catch(()=>{$.value=!1}))},G=async()=>{$.value=!0,P.dispatch("employee/leave/allocation/fetchLeaveRequests",{uuid:a.allocation.uuid}).then(t=>{q.isLeaveRequestFetched=!0,q.leaveRequests=t.leaveRequests}).catch(()=>{$.value=!1})};return(t,i)=>{const J=u("PageHeaderAction"),K=u("PageHeader"),y=u("ListItemView"),S=u("ListContainerVertical"),k=u("BaseCard"),w=u("BaseButton"),C=u("BaseAlert"),E=u("BaseBadge"),f=u("BaseDataView"),Q=u("ListMedia"),W=u("ShowButton"),X=u("BaseSelect"),Y=u("HelperText"),Z=u("DatePicker"),x=u("BaseTextarea"),ee=u("FormAction"),te=u("DetailLayoutVertical"),ae=u("ShowItem"),le=u("ParentTransition");return n(),c(B,null,[s(K,{title:t.$trans(m(R).meta.trans,{attribute:t.$trans(m(R).meta.label)}),navs:[{label:t.$trans("employee.leave.leave"),path:"EmployeeLeave"},{label:t.$trans("employee.leave.request.request"),path:"EmployeeLeaveRequestList"}]},{default:e(()=>[s(J,{name:"EmployeeLeaveRequest",title:t.$trans("employee.leave.request.request"),actions:["list"]},null,8,["title"])]),_:1},8,["title","navs"]),s(le,{appear:"",visibility:!0},{default:e(()=>[s(ae,{"init-url":D,uuid:m(R).params.uuid,onSetItem:j,onRedirectTo:i[7]||(i[7]=o=>m(T).push({name:"EmployeeLeaveRequest"})),refresh:L.value,onRefreshed:i[8]||(i[8]=o=>L.value=!1)},{default:e(()=>[a.uuid?(n(),d(te,{key:0},{detail:e(()=>[s(k,{"no-padding":"","no-content-padding":""},{title:e(()=>[r(l(t.$trans("global.detail",{attribute:t.$trans("employee.employee")})),1)]),default:e(()=>[s(S,null,{default:e(()=>[s(y,{label:t.$trans("employee.props.name")},{default:e(()=>[r(l(a.employee.name),1)]),_:1},8,["label"]),s(y,{label:t.$trans("employee.props.code_number")},{default:e(()=>[r(l(a.employee.codeNumber),1)]),_:1},8,["label"]),s(y,{label:t.$trans("employee.department.department")},{default:e(()=>[r(l(a.employee.department),1)]),_:1},8,["label"]),s(y,{label:t.$trans("employee.designation.designation")},{default:e(()=>[r(l(a.employee.designation),1)]),_:1},8,["label"]),s(y,{label:t.$trans("employee.employment_status.employment_status")},{default:e(()=>[r(l(a.employee.employmentStatus),1)]),_:1},8,["label"])]),_:1})]),_:1}),s(k,{"no-padding":"","no-content-padding":""},{title:e(()=>[r(l(t.$trans("employee.leave.allocation.allocation")),1)]),action:e(()=>[q.isLeaveRequestFetched?p("",!0):(n(),d(w,{key:0,design:"primary",size:"xs",onClick:G},{default:e(()=>[r(l(t.$trans("global.show",{attribute:t.$trans("general.detail")})),1)]),_:1}))]),default:e(()=>{var o;return[(o=a.allocation)!=null&&o.uuid?(n(),d(S,{key:1},{default:e(()=>[s(y,{truncate:!1,label:t.$trans("employee.leave.request.props.duration")},{default:e(()=>[r(l(a.allocation.startDate.formatted)+" - "+l(a.allocation.endDate.formatted),1)]),_:1},8,["label"]),(n(!0),c(B,null,V(a.allocation.records,b=>(n(),d(y,{key:b.uuid,label:b.leaveType.name},{default:e(()=>[r(l(b.used+"/"+b.allotted),1)]),_:2},1032,["label"]))),128))]),_:1})):(n(),d(C,{key:0,design:"info",size:"xs"},{default:e(()=>[r(l(t.$trans("global.could_not_find",{attribute:t.$trans("employee.leave.allocation.allocation")})),1)]),_:1}))]}),_:1}),q.isLeaveRequestFetched?(n(),d(k,{key:0,"no-padding":"","no-content-padding":""},{title:e(()=>[r(l(t.$trans("employee.leave.request.approved_request")),1)]),default:e(()=>[_("div",ie,[q.leaveRequests.length==0?(n(),d(C,{key:0,design:"info",size:"xs"},{default:e(()=>[r(l(t.$trans("global.could_not_find",{attribute:t.$trans("employee.leave.request.approved_request")})),1)]),_:1})):p("",!0)]),s(S,null,{default:e(()=>[(n(!0),c(B,null,V(q.leaveRequests,o=>{var b;return n(),d(y,{dynamic:"",key:o.uuid,truncate:!1,label:((b=o.leaveType)==null?void 0:b.name)||"-"},{default:e(()=>[o.status.value=="approved"?(n(),c("div",de,l(o.period),1)):p("",!0),o.status.value=="partially_approved"?(n(),c("div",pe,[(n(!0),c(B,null,V(o.dates,F=>(n(),c("div",{key:F.date.value},l(F.date.formatted)+" - "+l(F.label),1))),128)),s(E,{design:"info"},{default:e(()=>[r(l(t.$trans("employee.leave.request.statuses.partially_approved")),1)]),_:1})])):p("",!0)]),_:2},1032,["label"])}),128))]),_:1})]),_:1})):p("",!0)]),default:e(()=>[_("div",me,[s(k,null,{title:e(()=>[r(l(t.$trans("employee.leave.request.request"))+" ",1),s(E,{label:a.status.label,design:a.status.color},null,8,["label","design"])]),footer:e(()=>[s(W,null,{default:e(()=>[m(U)("leave-request:edit")&&a.status.value=="requested"?(n(),d(w,{key:0,design:"primary",onClick:i[0]||(i[0]=o=>m(T).push({name:"EmployeeLeaveRequestEdit",params:{uuid:a.uuid}}))},{default:e(()=>[r(l(t.$trans("general.edit")),1)]),_:1})):p("",!0)]),_:1})]),default:e(()=>[_("dl",ce,[s(f,{label:t.$trans("employee.leave.request.props.period")},{default:e(()=>[r(l(a.period),1)]),_:1},8,["label"]),s(f,{label:t.$trans("employee.leave.request.props.duration")},{default:e(()=>[r(l(a.duration)+" ",1),a.isHalfDay?(n(),d(E,{key:0,label:t.$trans("employee.leave.request.props.half_day"),design:"primary"},null,8,["label"])):p("",!0)]),_:1},8,["label"]),a.status.value=="partially_approved"?(n(),d(f,{key:0,dynamic:"",label:t.$trans("employee.leave.request.props.approved_dates")},{default:e(()=>[(n(!0),c(B,null,V(a.dates,o=>(n(),c("div",{key:o.date.value},l(o.date.formatted)+" - "+l(o.label),1))),128))]),_:1},8,["label"])):p("",!0),s(f,{class:"col-span-1 sm:col-span-2",label:t.$trans("employee.leave.request.props.reason")},{default:e(()=>[r(l(a.reason),1)]),_:1},8,["label"]),s(f,{class:"col-span-1 sm:col-span-2",label:t.$trans("employee.leave.request.props.comment")},{default:e(()=>[r(l(a.comment),1)]),_:1},8,["label"]),s(f,{label:t.$trans("general.created_at")},{default:e(()=>[r(l(a.createdAt.formatted),1)]),_:1},8,["label"]),s(f,{label:t.$trans("general.updated_at")},{default:e(()=>[r(l(a.updatedAt.formatted),1)]),_:1},8,["label"]),s(f,{class:"col-span-1 sm:col-span-2"},{default:e(()=>[s(Q,{media:a.media,url:`/app/employee/leave/requests/${a.uuid}/`},null,8,["media","url"])]),_:1})])]),_:1}),m(U)("leave-request:action")?(n(),d(k,{key:0},{title:e(()=>[r(l(t.$trans("employee.leave.request.action")),1)]),action:e(()=>[a.status.value!="requested"?(n(),d(w,{key:0,design:"primary",size:"xs",onClick:M},{default:e(()=>[r(l(t.$trans("employee.leave.request.undo")),1)]),_:1})):p("",!0)]),default:e(()=>[a.status.value!="requested"?(n(),d(C,{key:0,design:"info",size:"xs"},{default:e(()=>[r(l(t.$trans("employee.leave.status_detail",{attribute:a.status.label})),1)]),_:1})):p("",!0),a.status.value=="requested"?(n(),d(ee,{key:1,"no-card":"","keep-adding":!1,"init-url":D,"pre-requisites":!0,onSetPreRequisites:N,uuid:a.uuid,"no-data-fetch":!0,action:"status","init-form":A,form:v,"after-submit":O},{default:e(()=>[_("div",ve,[_("div",ye,[s(X,{name:"status",label:t.$trans("global.select",{attribute:t.$trans("employee.leave.request.props.status")}),modelValue:v.status,"onUpdate:modelValue":i[1]||(i[1]=o=>v.status=o),options:H.statuses,error:m(g).status,"onUpdate:error":i[2]||(i[2]=o=>m(g).status=o)},null,8,["label","modelValue","options","error"]),s(Y,null,{default:e(()=>[_("span",fe,l(t.$trans("employee.leave.request.approval_tip")),1)]),_:1})]),!a.isHalfDay&&v.status=="partially_approved"?(n(),c("div",be,[s(Z,{modelValue:v.dates,"onUpdate:modelValue":i[3]||(i[3]=o=>v.dates=o),config:{minDate:a.startDate.value,maxDate:a.endDate.value},name:"dates",as:"multiple",label:t.$trans("employee.leave.request.props.approved_dates"),error:m(g).dates,"onUpdate:error":i[4]||(i[4]=o=>m(g).dates=o)},null,8,["modelValue","config","label","error"])])):p("",!0),_("div",_e,[s(x,{modelValue:v.comment,"onUpdate:modelValue":i[5]||(i[5]=o=>v.comment=o),name:"comment",label:t.$trans("employee.leave.request.props.comment"),error:m(g).comment,"onUpdate:error":i[6]||(i[6]=o=>m(g).comment=o)},null,8,["modelValue","label","error"])])])]),_:1},8,["uuid","form"])):p("",!0)]),_:1})):p("",!0)])]),_:1})):p("",!0)]),_:1},8,["uuid","refresh"])]),_:1})],64)}}});export{ke as default};
