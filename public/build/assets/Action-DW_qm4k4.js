import{I as Z,m as H,r as _,A as I,t as P,o as i,w as $,b as T,d as o,a as u,v as O,x as w,e as d,f as p,F as B,y as S,n as L,B as v,$ as x,H as R,K as z,u as ee}from"./app-Cvm44xuh.js";const ae={class:"grid grid-cols-3 gap-6"},se={class:"col-span-3 sm:col-span-1"},te={class:"col-span-3 sm:col-span-2"},oe={class:"col-span-1"},le=["onClick"],re={class:"grid grid-cols-4 gap-2"},ne={class:"col-span-4 sm:col-span-2 lg:col-span-1"},ie={class:"col-span-4 sm:col-span-2 lg:col-span-1"},ue={class:"col-span-4 sm:col-span-2 lg:col-span-1"},pe={class:"space-x-2"},ce=["onClick"],de={key:0},fe={key:1},me=["onClick"],_e={key:0},be={key:1},$e={key:2},Fe=["onClick"],ge={key:0},ye={key:1},Ve={key:2},ve={class:"mt-4 grid grid-cols-4 gap-2"},ke={class:"col-span-4 sm:col-span-2 lg:col-span-1"},Te={key:0,class:"col-span-4 sm:col-span-2 lg:col-span-1"},Ue={class:"mt-4 grid grid-cols-4 gap-2"},Ge={class:"col-span-4 sm:col-span-2 lg:col-span-1"},he={class:"col-span-4 sm:col-span-2 lg:col-span-1"},Ee={class:"col-span-4 sm:col-span-2 lg:col-span-1"},Be={class:"mt-4 grid grid-cols-4 gap-2"},Ce={class:"col-span-4 sm:col-span-2 lg:col-span-1"},qe={key:0,class:"mt-2 flex justify-end"},De={name:"FinanceFeeStructureForm"},Oe=Object.assign(De,{setup(K){const b={name:"",description:"",feeGroups:[],isEditable:!0},F="finance/feeStructure/",c=Z(F),U=H({transportFees:[],feeGroups:[],frequencies:[]}),t=H({...b}),A=e=>{Object.assign(U,e),U.feeGroups.forEach(a=>{let g=[j(a)];b.feeGroups.push({...a,installments:g})}),Object.assign(t,z(b))},J=(e,a)=>{a&&(e.applicableTo==="new"?e.applicableTo="old":e.applicableTo==="old"?e.applicableTo="all":e.applicableTo="new")},M=(e,a)=>{a&&(e.applicableToGender==="male"?e.applicableToGender="female":e.applicableToGender==="female"?e.applicableToGender="all":e.applicableToGender="male")},Q=e=>{let a=[];e.feeGroups.forEach(g=>{let k=[];g.installments.forEach(f=>{var q,G,E;let C=[];f.heads.forEach(y=>{var D;C.push({name:y.name,uuid:y.uuid,amount:((D=y.amount)==null?void 0:D.value)||0,isOptional:!!y.isOptional,applicableTo:y.applicableTo,applicableToGender:y.applicableToGender})}),k.push({title:f.title,dueDate:f.dueDate.value,hasTransportFee:!!f.hasTransportFee,transportFee:((q=f.transportFee)==null?void 0:q.uuid)||"",hasLateFee:!!f.hasLateFee,lateFeeFrequency:((G=f.lateFeeFrequency)==null?void 0:G.value)||"",lateFeeType:f.lateFeeType,lateFeeValue:((E=f.lateFeeValue)==null?void 0:E.value)||"",hasNoConcession:!!f.hasNoConcession,uuid:f.uuid||R(),heads:C})}),a.push({...g,installments:k})}),Object.assign(b,{...e,feeGroups:a}),Object.assign(t,z(b))},W=e=>{e.installments.push(j(e))},X=async(e,a)=>{await x()&&e.installments.splice(a,1)},j=e=>{let a=[];return e.heads.forEach(g=>{a.push({...g,amount:0,isOptional:!1,applicableTo:"all",applicableToGender:"all"})}),{uuid:R(),title:"",dueDate:null,hasLateFee:!1,hasTransportFee:!1,lateFeeFrequency:"daily",lateFeeValue:0,lateFeeType:"amount",heads:a,transportFee:""}};return(e,a)=>{const g=_("BaseAlert"),k=_("BaseInput"),f=_("BaseTextarea"),C=_("BaseHeading"),q=_("DatePicker"),G=_("BaseCheckbox"),E=_("BaseSelect"),y=_("BaseFieldset"),D=_("BaseButton"),Y=_("FormAction"),V=I("tooltip");return i(),P(Y,{"pre-requisites":!0,onSetPreRequisites:A,"init-url":F,"init-form":b,form:t,setForm:Q,redirect:"FinanceFeeStructure"},{default:$(()=>[t.isEditable?T("",!0):(i(),P(g,{key:0,class:"mb-6",design:"error"},{default:$(()=>[O(w(e.$trans("finance.fee_structure.not_editable_as_fee_paid")),1)]),_:1})),o("div",ae,[o("div",se,[d(k,{type:"text",modelValue:t.name,"onUpdate:modelValue":a[0]||(a[0]=m=>t.name=m),name:"name",label:e.$trans("finance.fee_structure.props.name"),error:p(c).name,"onUpdate:error":a[1]||(a[1]=m=>p(c).name=m),autofocus:""},null,8,["modelValue","label","error"])]),o("div",te,[d(f,{modelValue:t.description,"onUpdate:modelValue":a[2]||(a[2]=m=>t.description=m),rows:1,name:"description",label:e.$trans("finance.fee_structure.props.description"),error:p(c).description,"onUpdate:error":a[3]||(a[3]=m=>p(c).description=m)},null,8,["modelValue","label","error"])])]),(i(!0),u(B,null,S(t.feeGroups,(m,r)=>(i(),u("div",{class:"mt-4 grid grid-cols-1",key:m.uuid},[o("div",oe,[d(C,null,{default:$(()=>[O(w(m.name),1)]),_:2},1024),(i(!0),u(B,null,S(m.installments,(n,l)=>(i(),P(y,{class:"mt-4",key:n.uuid},{legend:$(()=>[O(w(e.$trans("finance.fee_structure.installment_number",{attribute:l+1}))+" ",1),t.isEditable?(i(),u("span",{key:0,class:"text-danger ml-2 cursor-pointer",onClick:s=>X(m,l)},a[4]||(a[4]=[o("i",{class:"fas fa-times-circle"},null,-1)]),8,le)):T("",!0)]),default:$(()=>[o("div",re,[o("div",ne,[d(k,{type:"text",name:`feeGroups.${r}.installments.${l}.title`,modelValue:n.title,"onUpdate:modelValue":s=>n.title=s,label:e.$trans("finance.fee_structure.props.title"),error:p(c)[`feeGroups.${r}.installments.${l}.title`],"onUpdate:error":s=>p(c)[`feeGroups.${r}.installments.${l}.title`]=s,disabled:!t.isEditable},null,8,["name","modelValue","onUpdate:modelValue","label","error","onUpdate:error","disabled"])]),o("div",ie,[d(q,{modelValue:n.dueDate,"onUpdate:modelValue":s=>n.dueDate=s,name:`feeGroups.${r}.installments.${l}.dueDate`,label:e.$trans("finance.fee_structure.props.due_date"),"no-clear":"",error:p(c)[`feeGroups.${r}.installments.${l}.dueDate`],"onUpdate:error":s=>p(c)[`feeGroups.${r}.installments.${l}.dueDate`]=s,disabled:!t.isEditable},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error","disabled"])]),(i(!0),u(B,null,S(n.heads,(s,N)=>(i(),u("div",ue,[d(k,{name:`feeGroups.${r}.installments.${l}.heads.${N}.amount`,modelValue:s.amount,"onUpdate:modelValue":h=>s.amount=h,label:s.name,currency:"",error:p(c)[`feeGroups.${r}.installments.${l}.heads.${N}.amount`],"onUpdate:error":h=>p(c)[`feeGroups.${r}.installments.${l}.heads.${N}.amount`]=h,disabled:!t.isEditable},{"additional-label":$(()=>[o("div",pe,[o("span",{class:L({"cursor-pointer":t.isEditable}),onClick:h=>t.isEditable?s.isOptional=!s.isOptional:null},[s.isOptional?v((i(),u("span",fe,a[6]||(a[6]=[o("i",{class:"fas fa-question-circle text-gray-900 dark:text-gray-300"},null,-1)]))),[[V,e.$trans("finance.fee_structure.props.is_optional")]]):v((i(),u("span",de,a[5]||(a[5]=[o("i",{class:"fas fa-check-circle text-gray-900 dark:text-gray-300"},null,-1)]))),[[V,e.$trans("finance.fee_structure.props.is_mandatory")]])],10,ce),o("span",{class:L({"cursor-pointer":t.isEditable}),onClick:h=>J(s,t.isEditable)},[s.applicableTo==="new"?v((i(),u("span",_e,a[7]||(a[7]=[o("i",{class:"fas fa-user-plus text-gray-900 dark:text-gray-300"},null,-1)]))),[[V,e.$trans("finance.fee_structure.props.new_student")]]):s.applicableTo==="old"?v((i(),u("span",be,a[8]||(a[8]=[o("i",{class:"fas fa-user-lock text-gray-900 dark:text-gray-300"},null,-1)]))),[[V,e.$trans("finance.fee_structure.props.old_student")]]):s.applicableTo==="all"?v((i(),u("span",$e,a[9]||(a[9]=[o("i",{class:"fas fa-user-graduate text-gray-900 dark:text-gray-300"},null,-1)]))),[[V,e.$trans("finance.fee_structure.props.all_student")]]):T("",!0)],10,me),o("span",{class:L({"cursor-pointer":t.isEditable}),onClick:h=>M(s,t.isEditable)},[s.applicableToGender==="male"?v((i(),u("span",ge,a[10]||(a[10]=[o("i",{class:"fas fa-user-tie text-gray-900 dark:text-gray-300"},null,-1)]))),[[V,e.$trans("finance.fee_structure.props.male_student")]]):s.applicableToGender==="female"?v((i(),u("span",ye,a[11]||(a[11]=[o("i",{class:"fas fa-user-nurse text-gray-900 dark:text-gray-300"},null,-1)]))),[[V,e.$trans("finance.fee_structure.props.female_student")]]):s.applicableToGender==="all"?v((i(),u("span",Ve,a[12]||(a[12]=[o("i",{class:"fas fa-users text-gray-900 dark:text-gray-300"},null,-1)]))),[[V,e.$trans("finance.fee_structure.props.all_student")]]):T("",!0)],10,Fe)])]),_:2},1032,["name","modelValue","onUpdate:modelValue","label","error","onUpdate:error","disabled"])]))),256))]),o("div",ve,[o("div",ke,[d(G,{modelValue:n.hasTransportFee,"onUpdate:modelValue":s=>n.hasTransportFee=s,name:`feeGroups.${r}.installments.${l}.hasTransportFee`,label:e.$trans("finance.fee_structure.props.has_transport_fee"),disabled:!t.isEditable},null,8,["modelValue","onUpdate:modelValue","name","label","disabled"])]),n.hasTransportFee?(i(),u("div",Te,[d(E,{modelValue:n.transportFee,"onUpdate:modelValue":s=>n.transportFee=s,name:`feeGroups.${r}.installments.${l}.transportFee`,label:e.$trans("transport.fee.fee"),options:U.transportFees,"label-prop":"name","value-prop":"uuid",error:p(c)[`feeGroups.${r}.installments.${l}.transportFee`],"onUpdate:error":s=>p(c)[`feeGroups.${r}.installments.${l}.transportFee`]=s,disabled:!t.isEditable},null,8,["modelValue","onUpdate:modelValue","name","label","options","error","onUpdate:error","disabled"])])):T("",!0)]),o("div",Ue,[o("div",Ge,[d(G,{modelValue:n.hasLateFee,"onUpdate:modelValue":s=>n.hasLateFee=s,name:`feeGroups.${r}.installments.${l}.hasLateFee`,label:e.$trans("finance.fee_structure.props.has_late_fee"),disabled:!t.isEditable},null,8,["modelValue","onUpdate:modelValue","name","label","disabled"])]),n.hasLateFee?(i(),u(B,{key:0},[o("div",he,[d(E,{modelValue:n.lateFeeFrequency,"onUpdate:modelValue":s=>n.lateFeeFrequency=s,name:`feeGroups.${r}.installments.${l}.lateFeeFrequency`,label:e.$trans("finance.fee_structure.props.late_fee_frequency"),options:U.frequencies,"label-prop":"label","value-prop":"value",error:p(c)[`feeGroups.${r}.installments.${l}.lateFeeFrequency`],"onUpdate:error":s=>p(c)[`feeGroups.${r}.installments.${l}.lateFeeFrequency`]=s,disabled:!t.isEditable},null,8,["modelValue","onUpdate:modelValue","name","label","options","error","onUpdate:error","disabled"])]),o("div",Ee,[d(k,{modelValue:n.lateFeeValue,"onUpdate:modelValue":s=>n.lateFeeValue=s,name:`feeGroups.${r}.installments.${l}.lateFeeValue`,label:e.$trans("finance.fee_structure.props.late_fee_value"),currency:"",error:p(c)[`feeGroups.${r}.installments.${l}.lateFeeValue`],"onUpdate:error":s=>p(c)[`feeGroups.${r}.installments.${l}.lateFeeValue`]=s,disabled:!t.isEditable},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error","disabled"])])],64)):T("",!0)]),o("div",Be,[o("div",Ce,[d(G,{modelValue:n.hasNoConcession,"onUpdate:modelValue":s=>n.hasNoConcession=s,name:`feeGroups.${r}.installments.${l}.hasNoConcession`,label:e.$trans("finance.fee_concession.no_concession"),disabled:!t.isEditable},null,8,["modelValue","onUpdate:modelValue","name","label","disabled"])])])]),_:2},1024))),128)),t.isEditable?(i(),u("div",qe,[d(D,{design:"primary",size:"xs",onClick:n=>W(m)},{default:$(()=>[O(w(e.$trans("global.add",{attribute:e.$trans("finance.fee_structure.installment")})),1)]),_:2},1032,["onClick"])])):T("",!0)])]))),128))]),_:1},8,["form"])}}}),we={name:"FinanceFeeStructureAction"},Ne=Object.assign(we,{setup(K){const b=ee();return(F,c)=>{const U=_("PageHeaderAction"),t=_("PageHeader"),A=_("ParentTransition");return i(),u(B,null,[d(t,{title:F.$trans(p(b).meta.trans,{attribute:F.$trans(p(b).meta.label)}),navs:[{label:F.$trans("finance.finance"),path:"Finance"},{label:F.$trans("finance.fee_structure.fee_structure"),path:"FinanceFeeStructureList"}]},{default:$(()=>[d(U,{name:"FinanceFeeStructure",title:F.$trans("finance.fee_structure.fee_structure"),actions:["list"]},null,8,["title"])]),_:1},8,["title","navs"]),d(A,{appear:"",visibility:!0},{default:$(()=>[d(Oe)]),_:1})],64)}}});export{Ne as default};
