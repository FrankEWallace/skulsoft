import{u as T,k as A,m as B,I,q as C,r as i,t as D,o as g,w as o,d as c,e as a,b as k,v as u,x as l,i as M,j as E,z as W,p as U,a as O,f as $,F as S,y as z}from"./app-Cvm44xuh.js";const J={class:"grid grid-cols-3 gap-6"},K={class:"col-span-3 sm:col-span-1"},Q={class:"col-span-3 sm:col-span-1"},X={class:"col-span-3 sm:col-span-1"},Y={class:"col-span-3 sm:col-span-1"},Z={class:"col-span-3 sm:col-span-1"},x={class:"col-span-3 sm:col-span-1"},ee={class:"col-span-3 sm:col-span-1"},ae={class:"col-span-3 sm:col-span-1"},te={class:"col-span-3 sm:col-span-1"},ne={__name:"Filter",props:{initUrl:{type:String,default:""},preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup(q,{emit:v}){const f=T();A("moment");const V=v,N=q,h={installment:"",codeNumber:"",name:"",batches:[],feeGroup:"",dueOn:"",minDue:"",groups:[],address:""},t=B({...h});I(N.initUrl);const p=B({isLoaded:!(f.query.batches||f.query.groups)});return C(async()=>{p.batches=f.query.batches?f.query.batches.split(","):[],p.groups=f.query.groups?f.query.groups.split(","):[],p.isLoaded=!0}),(s,n)=>{const m=i("BaseInput"),F=i("BaseSelectSearch"),y=i("BaseSelect"),d=i("DatePicker"),b=i("FilterForm");return g(),D(b,{"init-form":h,multiple:["batches","groups"],form:t,onHide:n[9]||(n[9]=e=>V("hide"))},{default:o(()=>[c("div",J,[c("div",K,[a(m,{type:"text",modelValue:t.installment,"onUpdate:modelValue":n[0]||(n[0]=e=>t.installment=e),name:"installment",label:s.$trans("finance.fee_structure.installment")},null,8,["modelValue","label"])]),c("div",Q,[a(m,{type:"text",modelValue:t.codeNumber,"onUpdate:modelValue":n[1]||(n[1]=e=>t.codeNumber=e),name:"codeNumber",label:s.$trans("student.admission.props.code_number")},null,8,["modelValue","label"])]),c("div",X,[a(m,{type:"text",modelValue:t.name,"onUpdate:modelValue":n[2]||(n[2]=e=>t.name=e),name:"name",label:s.$trans("contact.props.name")},null,8,["modelValue","label"])]),c("div",Y,[p.isLoaded?(g(),D(F,{key:0,multiple:"",name:"batches",label:s.$trans("global.select",{attribute:s.$trans("academic.batch.batch")}),modelValue:t.batches,"onUpdate:modelValue":n[3]||(n[3]=e=>t.batches=e),"value-prop":"uuid","init-search":p.batches,"search-key":"course_batch","search-action":"academic/batch/list"},{selectedOption:o(e=>[u(l(e.value.course.name)+" "+l(e.value.name),1)]),listOption:o(e=>[u(l(e.option.course.nameWithTerm)+" "+l(e.option.name),1)]),_:1},8,["label","modelValue","init-search"])):k("",!0)]),c("div",Z,[a(y,{name:"feeGroup",label:s.$trans("global.select",{attribute:s.$trans("finance.fee_group.fee_group")}),modelValue:t.feeGroup,"onUpdate:modelValue":n[4]||(n[4]=e=>t.feeGroup=e),options:q.preRequisites.feeGroups,"value-prop":"uuid","label-prop":"name"},null,8,["label","modelValue","options"])]),c("div",x,[a(d,{modelValue:t.dueOn,"onUpdate:modelValue":n[5]||(n[5]=e=>t.dueOn=e),name:"dueOn",as:"date",label:s.$trans("finance.report.fee_due.props.due_on")},null,8,["modelValue","label"])]),c("div",ee,[a(m,{type:"text",modelValue:t.minDue,"onUpdate:modelValue":n[6]||(n[6]=e=>t.minDue=e),name:"minDue",label:s.$trans("global.min_item",{attribute:s.$trans("finance.fee.due")})},null,8,["modelValue","label"])]),c("div",ae,[p.isLoaded?(g(),D(F,{key:0,multiple:"",modelValue:t.groups,"onUpdate:modelValue":n[7]||(n[7]=e=>t.groups=e),name:"groups","label-prop":"name","value-prop":"uuid",label:s.$trans("student.group.group"),"init-search":p.groups,"search-action":"option/list","additional-search-query":{type:"student_group"}},null,8,["modelValue","label","init-search"])):k("",!0)]),c("div",te,[a(m,{type:"text",modelValue:t.address,"onUpdate:modelValue":n[8]||(n[8]=e=>t.address=e),name:"address",label:s.$trans("contact.props.address.address")},null,8,["modelValue","label"])])])]),_:1},8,["form"])}}},oe={name:"FinanceReportFeeDue"},le=Object.assign(oe,{setup(q){const v=T(),f=M(),V=E();let N=["filter"],h=[];W("finance:export")&&(h=["print","pdf","excel"]);const t="finance/report/",p=U(!1),s=U(!1),n=B({feeGroups:[]}),m=B({headers:[],data:[],meta:{total:0}}),F=async()=>{s.value=!0,await V.dispatch(t+"preRequisite",{name:"fee-due",params:v.query}).then(d=>{s.value=!1,Object.assign(n,d)}).catch(d=>{s.value=!1})},y=async()=>{s.value=!0,await V.dispatch(t+"fetchReport",{name:"fee-due",params:v.query}).then(d=>{s.value=!1,Object.assign(m,d)}).catch(d=>{s.value=!1})};return C(async()=>{await F(),await y()}),(d,b)=>{const e=i("BaseButton"),G=i("PageHeaderAction"),j=i("PageHeader"),w=i("ParentTransition"),_=i("DataCell"),R=i("TextMuted"),H=i("DataRow"),L=i("DataTable"),P=i("BaseCard");return g(),O(S,null,[a(j,{title:d.$trans($(v).meta.label),navs:[{label:d.$trans("finance.finance"),path:"Finance"},{label:d.$trans("finance.report.report"),path:"FinanceReport"}]},{default:o(()=>[a(G,{url:"finance/reports/fee-due/",name:"FinanceReportFeeDue",title:d.$trans("finance.report.fee_due.fee_due"),actions:$(N),"dropdown-actions":$(h),headers:m.headers,onToggleFilter:b[1]||(b[1]=r=>p.value=!p.value)},{default:o(()=>[a(e,{design:"white",onClick:b[0]||(b[0]=r=>$(f).push({name:"FinanceReportInstallmentWiseFeeDue"}))},{default:o(()=>[u(l(d.$trans("finance.report.installment_wise_fee_due.installment_wise_fee_due")),1)]),_:1})]),_:1},8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"]),a(w,{appear:"",visibility:p.value},{default:o(()=>[a(ne,{onAfterFilter:y,"init-url":t,"pre-requisites":n,onHide:b[2]||(b[2]=r=>p.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"]),a(w,{appear:"",visibility:!0},{default:o(()=>[a(P,{"no-padding":"","no-content-padding":"","is-loading":s.value},{default:o(()=>[a(L,{header:m.headers,footer:m.footers,meta:m.meta,module:"finance.report.fee_due",onRefresh:y},{default:o(()=>[(g(!0),O(S,null,z(m.data,r=>(g(),D(H,{key:r.uuid},{default:o(()=>[a(_,{name:"codeNumber"},{default:o(()=>[u(l(r.codeNumber),1)]),_:2},1024),a(_,{name:"name"},{default:o(()=>[u(l(r.name)+" ",1),a(R,{block:""},{default:o(()=>[u(l(r.rollNumber),1)]),_:2},1024)]),_:2},1024),a(_,{name:"fatherName"},{default:o(()=>[u(l(r.fatherName)+" ",1),a(R,{block:""},{default:o(()=>[u(l(r.contactNumber),1)]),_:2},1024)]),_:2},1024),a(_,{name:"course"},{default:o(()=>[u(l(r.courseName)+" ",1),a(R,{block:""},{default:o(()=>[u(l(r.batchName),1)]),_:2},1024)]),_:2},1024),a(_,{name:"feeGroup"},{default:o(()=>[u(l(r.feeGroupName),1)]),_:2},1024),a(_,{name:"dueFee"},{default:o(()=>[u(l(r.dueFee.formatted),1)]),_:2},1024),a(_,{name:"finalDueDate"},{default:o(()=>[u(l(r.finalDueDate.formatted),1)]),_:2},1024),a(_,{name:"overdueBy"},{default:o(()=>[u(l(r.overdueBy),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","footer","meta"])]),_:1},8,["is-loading"])]),_:1})],64)}}});export{le as default};
