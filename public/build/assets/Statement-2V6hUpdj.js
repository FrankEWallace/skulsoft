import{u as V,m as $,q as C,r as l,t as D,o as _,w as a,d as y,b as R,e,j as I,z as U,p as S,a as B,f as w,v as m,x as p,F as P,y as j,Y as M}from"./app-Cvm44xuh.js";const O={class:"grid grid-cols-3 gap-6"},z={class:"col-span-3 sm:col-span-1"},E={class:"col-span-3 sm:col-span-1"},Y={__name:"StatementFilter",emits:["hide"],setup(T,{emit:c}){const b=V(),g=c,v={startDate:"",endDate:"",vendor:""},s=$({...v}),d=$({vendor:"",isLoaded:!b.query.vendor});return C(async()=>{d.vendor=b.query.vendor,d.isLoaded=!0}),(u,t)=>{const f=l("BaseSelectSearch"),h=l("DatePicker"),n=l("FilterForm");return _(),D(n,{"init-form":v,form:s,onHide:t[3]||(t[3]=o=>g("hide"))},{default:a(()=>[y("div",O,[y("div",z,[d.isLoaded?(_(),D(f,{key:0,name:"vendor",label:u.$trans("global.select",{attribute:u.$trans("inventory.vendor.vendor")}),modelValue:s.vendor,"onUpdate:modelValue":t[0]||(t[0]=o=>s.vendor=o),"label-props":"name","value-prop":"uuid","track-by":["name"],"init-search":d.vendor,"search-action":"inventory/vendor/list"},null,8,["label","modelValue","init-search"])):R("",!0)]),y("div",E,[e(h,{start:s.startDate,"onUpdate:start":t[1]||(t[1]=o=>s.startDate=o),end:s.endDate,"onUpdate:end":t[2]||(t[2]=o=>s.endDate=o),name:"dateBetween",as:"range",label:u.$trans("general.date_between")},null,8,["start","end","label"])])])]),_:1},8,["form"])}}},x=["onClick"],G={name:"InventoryVendorStatement"},Q=Object.assign(G,{setup(T){const c=V(),b=I();let g=[],v=[];U("vendor:export")&&(v=["print","pdf","excel"]);const s="inventory/vendor/",d=S(!0),u=S(!1),t=$({headers:[],data:[],meta:{total:0}}),f=async()=>{u.value=!0,await b.dispatch(s+"fetchStatement",{params:c.query}).then(n=>{u.value=!1,Object.assign(t,n)}).catch(n=>{u.value=!1})},h=n=>{n.type=="Purchase"?window.open(`/app/inventory/stock-purchases/${n.uuid}`,"_blank"):n.type=="Return"?window.open(`/app/inventory/stock-returns/${n.uuid}`,"_blank"):n.type=="Payment"&&window.open(`/app/finance/transactions/${n.uuid}`,"_blank")};return C(async()=>{c.query.vendor&&await f()}),(n,o)=>{const N=l("PageHeaderAction"),q=l("PageHeader"),k=l("ParentTransition"),r=l("DataCell"),F=l("DataRow"),H=l("DataTable"),A=l("BaseCard");return _(),B(P,null,[e(q,{title:n.$trans(w(c).meta.label),navs:[{label:n.$trans("inventory.inventory"),path:"Inventory"},{label:n.$trans("inventory.vendor.vendor"),path:"InventoryVendor"}]},{default:a(()=>[e(N,{url:"inventory/vendor/statement/",name:"InventoryVendorStatement",title:n.$trans("inventory.vendor.statement.statement"),actions:w(g),"dropdown-actions":w(v),headers:t.headers,onToggleFilter:o[0]||(o[0]=i=>d.value=!d.value)},null,8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"]),e(k,{appear:"",visibility:d.value},{default:a(()=>[e(Y,{onAfterFilter:f,"init-url":s,onHide:o[1]||(o[1]=i=>d.value=!1)})]),_:1},8,["visibility"]),e(k,{appear:"",visibility:!0},{default:a(()=>[e(A,{"no-padding":"","no-content-padding":"","is-loading":u.value},{default:a(()=>[e(H,{header:t.headers,footer:t.footers,meta:t.meta,module:"inventory.vendor.statement",onRefresh:f},{default:a(()=>[e(F,null,{default:a(()=>[e(r,{name:"sno"}),e(r,{name:"codeNumber"},{default:a(()=>[m(p(n.$trans("finance.ledger.props.opening_balance")),1)]),_:1}),e(r,{name:"date"}),e(r,{name:"type"}),e(r,{name:"amount"}),e(r,{name:"balance"},{default:a(()=>[m(p(t.meta.openingBalance.formatted),1)]),_:1})]),_:1}),(_(!0),B(P,null,j(t.data,(i,L)=>(_(),D(F,{key:i.uuid},{default:a(()=>[e(r,{name:"sno"},{default:a(()=>[m(p(t.meta.sno+L),1)]),_:2},1024),e(r,{name:"codeNumber"},{default:a(()=>[m(p(i.codeNumber)+" ",1),y("span",{onClick:M(J=>h(i),["stop"])},o[2]||(o[2]=[y("i",{class:"fas fa-up-right-from-square ml-2 cursor-pointer"},null,-1)]),8,x)]),_:2},1024),e(r,{name:"date"},{default:a(()=>[m(p(i.date.formatted),1)]),_:2},1024),e(r,{name:"type"},{default:a(()=>[m(p(i.type),1)]),_:2},1024),e(r,{name:"amount"},{default:a(()=>[m(p(i.amount.formatted),1)]),_:2},1024),e(r,{name:"balance"},{default:a(()=>[m(p(i.balance.formatted),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","footer","meta"])]),_:1},8,["is-loading"])]),_:1})],64)}}});export{Q as default};
