import{u as I,i as L,k as T,m as v,I as A,c as H,q as h,K as z,r as d,a as c,o as i,t as y,b as f,e as l,f as t,w as V,F as C,d as m,v as K,x as M,B as G,ap as J,z as Q}from"./app-Cvm44xuh.js";const W={class:"grid grid-cols-3 gap-6"},X={class:"col-span-3 sm:col-span-1"},Y={class:"grid grid-cols-3 gap-6"},Z={class:"col-span-3 sm:col-span-1"},_={key:0,class:"col-span-3 sm:col-span-1"},ee={key:1,class:"col-span-3 sm:col-span-1"},oe={class:"col-span-3 sm:col-span-1"},ae={key:2,class:"col-span-3 sm:col-span-1"},se={class:"col-span-3 sm:col-span-1"},te={class:"col-span-3 sm:col-span-1"},re={name:"ContactEditLogin"},le=Object.assign(re,{props:{contact:{type:Object,default(){return{}}}},setup(p){const B=I(),S=L(),q=T("emitter"),P=p,g={username:"",email:"",forceChangePassword:!1,password:"",passwordConfirmation:"",roles:[]},U="contact/",j="user/",$=v({}),r=A(U),b=H(()=>P.contact.user),n=v({isValidated:!1,existingUser:null}),s=v({...g}),F=a=>{Object.assign($,a)},R=a=>{n.isValidated=!0,n.existingUser=a||null,s.username=a==null?void 0:a.username},O=()=>{q.emit("contactUpdated"),S.push({name:"ContactShowLogin",params:{uuid:P.contact.uuid}})};return h(async()=>{var a,e,w;n.isValidated=!!b.value,n.existingUser=b.value,Object.assign(g,{username:(a=b.value)==null?void 0:a.username,email:(e=b.value)==null?void 0:e.email,roles:((w=b.value)==null?void 0:w.roles.map(u=>u.uuid))||[]}),Object.assign(s,z(g))}),(a,e)=>{const w=d("PageHeader"),u=d("BaseInput"),x=d("BaseButton"),k=d("FormAction"),E=d("BaseSelect"),N=d("BaseSwitch"),D=d("ParentTransition");return i(),c(C,null,[p.contact.uuid?(i(),y(w,{key:0,title:a.$trans(t(B).meta.trans,{attribute:a.$trans(t(B).meta.label)}),navs:[{label:a.$trans("contact.contact"),path:"Contact"},{label:p.contact.name,path:{name:"ContactShow",params:{uuid:p.contact.uuid}}}]},null,8,["title","navs"])):f("",!0),l(D,{appear:"",visibility:!0},{default:V(()=>[p.contact.uuid?(i(),c(C,{key:0},[n.isValidated?(i(),y(k,{key:1,"no-data-fetch":"","pre-requisites":!0,"pre-requisite-url":j,onSetPreRequisites:F,"init-url":U,action:n.existingUser?"updateUser":"createUser","init-form":g,form:s,"after-submit":O},{default:V(()=>[m("div",Y,[m("div",Z,[l(u,{readonly:"",disabled:"",type:"text",modelValue:s.email,"onUpdate:modelValue":e[2]||(e[2]=o=>s.email=o),name:"email",label:a.$trans("contact.login.props.email"),error:t(r).email,"onUpdate:error":e[3]||(e[3]=o=>t(r).email=o)},null,8,["modelValue","label","error"])]),n.existingUser?(i(),c("div",_,[l(u,{readonly:"",disabled:"",type:"text",modelValue:s.username,"onUpdate:modelValue":e[4]||(e[4]=o=>s.username=o),name:"username",label:a.$trans("contact.login.props.username"),error:t(r).username,"onUpdate:error":e[5]||(e[5]=o=>t(r).username=o)},null,8,["modelValue","label","error"])])):f("",!0),n.existingUser?f("",!0):(i(),c("div",ee,[l(u,{type:"text",modelValue:s.username,"onUpdate:modelValue":e[6]||(e[6]=o=>s.username=o),name:"username",label:a.$trans("contact.login.props.username"),error:t(r).username,"onUpdate:error":e[7]||(e[7]=o=>t(r).username=o)},null,8,["modelValue","label","error"])])),G(m("div",oe,[l(E,{modelValue:s.roles,"onUpdate:modelValue":e[8]||(e[8]=o=>s.roles=o),name:"roles",label:a.$trans("contact.login.props.role"),options:$.roles,multiple:"","label-prop":"label","value-prop":"uuid",error:t(r).roles,"onUpdate:error":e[9]||(e[9]=o=>t(r).roles=o)},null,8,["modelValue","label","options","error"])],512),[[J,!1]]),n.existingUser&&t(Q)("user:force-change-password")?(i(),c("div",ae,[l(N,{vertical:"",modelValue:s.forceChangePassword,"onUpdate:modelValue":e[10]||(e[10]=o=>s.forceChangePassword=o),name:"forceChangePassword",label:a.$trans("global.change",{attribute:a.$trans("contact.login.props.password")}),error:t(r).forceChangePassword,"onUpdate:error":e[11]||(e[11]=o=>t(r).forceChangePassword=o)},null,8,["modelValue","label","error"])])):f("",!0),!n.existingUser||s.forceChangePassword?(i(),c(C,{key:3},[m("div",se,[l(u,{type:"password",modelValue:s.password,"onUpdate:modelValue":e[12]||(e[12]=o=>s.password=o),name:"password",label:a.$trans("contact.login.props.password"),error:t(r).password,"onUpdate:error":e[13]||(e[13]=o=>t(r).password=o)},null,8,["modelValue","label","error"])]),m("div",te,[l(u,{type:"password",modelValue:s.passwordConfirmation,"onUpdate:modelValue":e[14]||(e[14]=o=>s.passwordConfirmation=o),name:"passwordConfirmation",label:a.$trans("contact.login.props.password_confirmation"),error:t(r).passwordConfirmation,"onUpdate:error":e[15]||(e[15]=o=>t(r).passwordConfirmation=o)},null,8,["modelValue","label","error"])])],64)):f("",!0)])]),_:1},8,["action","form"])):(i(),y(k,{key:0,"no-action-button":"","no-data-fetch":"","init-url":U,action:"confirmUser","init-form":g,form:s,"after-submit":R,"stay-on":"",redirect:{name:"ContactShowLogin",params:{uuid:p.contact.uuid}}},{default:V(()=>[m("div",W,[m("div",X,[l(u,{type:"text",modelValue:s.email,"onUpdate:modelValue":e[0]||(e[0]=o=>s.email=o),name:"email",label:a.$trans("contact.login.props.email"),error:t(r).email,"onUpdate:error":e[1]||(e[1]=o=>t(r).email=o)},null,8,["modelValue","label","error"])])]),l(x,{class:"mt-4",type:"submit"},{default:V(()=>[K(M(a.$trans("general.validate")),1)]),_:1})]),_:1},8,["form","redirect"]))],64)):f("",!0)]),_:1})],64)}}});export{le as default};
