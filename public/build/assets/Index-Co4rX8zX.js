import{u as Q,k as X,I as oe,m as j,q as Y,L as ae,r as c,t as y,b as p,o as m,w as n,e as r,f as o,a as _,d as v,n as Z,F as S,v as f,x as u,K,_ as ne,i as le,p as G,s as se,y as J,z}from"./app-Cvm44xuh.js";const re={key:0,class:"grid grid-cols-3 gap-4"},de={class:"col-span-3 sm:col-span-1"},ue={class:"col-span-3"},ie={class:"col-span-3 sm:col-span-1"},me={class:"col-span-3 sm:col-span-1"},ce={class:"col-span-3 sm:col-span-1"},pe={key:0,class:"col-span-3 sm:col-span-1"},be={class:"col-span-3"},fe={key:1,class:"col-span-3 sm:col-span-1"},ge={class:"col-span-3"},ve={class:"col-span-3 sm:col-span-1"},ke={class:"dark:text-gray-400"},ye={class:"col-span-3 sm:col-span-1"},_e={class:"text-danger"},Ve={class:"col-span-3 sm:col-span-1"},Be={class:"col-span-3 sm:col-span-1"},Ce={class:"col-span-3"},De={name:"StudentEditRecord"},$e=Object.assign(De,{props:{visibility:{type:Boolean,default:!1},student:{type:Object,default(){return{}}},record:{type:Object,default(){return{}}}},emits:["close","completed"],setup(b,{emit:O}){const P=Q(),U=O,g=b,i=X("$trans"),V={convertToRegular:!1,editCodeNumber:!1,codeNumberFormat:"",codeNumber:"",joiningDate:"",startDate:"",editBatch:!1,editCourse:!1,batch:"",courseBatch:"",deleteFeeReceipt:!1,enrollmentType:"",enrollmentStatus:"",remarks:""},T="student/record/",d=oe(T),D=j({enrollmentTypes:[],enrollmentStatuses:[]}),a=j({...V}),F=j({isLoaded:!1}),A=$=>{Object.assign(D,$),Object.assign(a,K(V))},w=()=>{U("close")},M=()=>{U("close"),U("completed")},x=()=>{var $,t,s,k;V.codeNumberFormat=g.record.numberFormat,V.codeNumber=g.record.codeNumber,V.joiningDate=($=g.record.joiningDate)==null?void 0:$.value,V.startDate=(t=g.record.startDate)==null?void 0:t.value,V.enrollmentType=(s=g.record.enrollmentType)==null?void 0:s.uuid,V.enrollmentStatus=(k=g.record.enrollmentStatus)==null?void 0:k.uuid,F.isLoaded=!0,Object.assign(a,K(V))};return Y(()=>{x()}),ae(()=>g.record.uuid,$=>{x()},{deep:!0}),($,t)=>{const s=c("BaseSwitch"),k=c("DatePicker"),L=c("BaseFieldset"),I=c("BaseInput"),h=c("BaseSelectSearch"),N=c("HelperText"),H=c("BaseCheckbox"),B=c("BaseSelect"),R=c("BaseTextarea"),E=c("FormAction"),q=c("BaseModal");return b.record.uuid?(m(),y(q,{key:0,show:b.visibility,onClose:w},{title:n(()=>[f(u(o(i)("global.detail",{attribute:o(i)("student.record.record")})),1)]),default:n(()=>[r(E,{"no-card":"","no-data-fetch":"","is-modal":"",confirmation:"","pre-requisites":!0,onSetPreRequisites:A,uuid:o(P).params.uuid,"module-uuid":b.record.uuid,action:"update","init-url":T,"init-form":V,form:a,"keep-adding":!1,"after-submit":M,onCancelled:w},{default:n(()=>[b.student.isProvisional?(m(),y(L,{key:0},{legend:n(()=>[r(s,{reverse:"",modelValue:a.convertToRegular,"onUpdate:modelValue":t[0]||(t[0]=e=>a.convertToRegular=e),name:"convertToRegular",label:o(i)("student.admission.convert_to_regular"),error:o(d).convertToRegular,"onUpdate:error":t[1]||(t[1]=e=>o(d).convertToRegular=e)},null,8,["modelValue","label","error"])]),default:n(()=>[a.convertToRegular?(m(),_("div",re,[v("div",de,[r(k,{modelValue:a.joiningDate,"onUpdate:modelValue":t[2]||(t[2]=e=>a.joiningDate=e),name:"joiningDate",label:o(i)("student.admission.props.date"),"no-clear":"",error:o(d).joiningDate,"onUpdate:error":t[3]||(t[3]=e=>o(d).joiningDate=e)},null,8,["modelValue","label","error"])])])):p("",!0)]),_:1})):p("",!0),a.convertToRegular?p("",!0):(m(),_("div",{key:1,class:Z(["grid grid-cols-3 gap-4",{"mt-4":b.student.isProvisional}])},[b.student.isProvisional?p("",!0):(m(),_(S,{key:0},[v("div",ue,[r(s,{vertical:"",modelValue:a.editCodeNumber,"onUpdate:modelValue":t[4]||(t[4]=e=>a.editCodeNumber=e),name:"editCodeNumber",label:o(i)("global.edit",{attribute:o(i)("student.admission.props.code_number")}),error:o(d).editCodeNumber,"onUpdate:error":t[5]||(t[5]=e=>o(d).editCodeNumber=e)},null,8,["modelValue","label","error"])]),a.editCodeNumber?(m(),_(S,{key:0},[v("div",ie,[r(I,{type:"text",modelValue:a.codeNumberFormat,"onUpdate:modelValue":t[6]||(t[6]=e=>a.codeNumberFormat=e),name:"codeNumberFormat",label:o(i)("student.admission.props.code_number_format"),error:o(d).codeNumberFormat,"onUpdate:error":t[7]||(t[7]=e=>o(d).codeNumberFormat=e)},null,8,["modelValue","label","error"])]),v("div",me,[r(I,{type:"text",modelValue:a.codeNumber,"onUpdate:modelValue":t[8]||(t[8]=e=>a.codeNumber=e),name:"codeNumber",label:o(i)("student.admission.props.code_number"),error:o(d).codeNumber,"onUpdate:error":t[9]||(t[9]=e=>o(d).codeNumber=e)},null,8,["modelValue","label","error"])]),v("div",ce,[r(k,{modelValue:a.joiningDate,"onUpdate:modelValue":t[10]||(t[10]=e=>a.joiningDate=e),name:"joiningDate",label:o(i)("student.admission.props.date"),"no-clear":"",error:o(d).joiningDate,"onUpdate:error":t[11]||(t[11]=e=>o(d).joiningDate=e)},null,8,["modelValue","label","error"])]),b.record.isPromoted?(m(),_("div",pe,[r(k,{modelValue:a.startDate,"onUpdate:modelValue":t[12]||(t[12]=e=>a.startDate=e),name:"startDate",label:o(i)("student.record.props.promotion_date"),"no-clear":"",error:o(d).startDate,"onUpdate:error":t[13]||(t[13]=e=>o(d).startDate=e)},null,8,["modelValue","label","error"])])):p("",!0)],64)):p("",!0)],64)),v("div",be,[r(s,{vertical:"",modelValue:a.editBatch,"onUpdate:modelValue":t[14]||(t[14]=e=>a.editBatch=e),name:"editBatch",label:o(i)("global.edit",{attribute:o(i)("academic.batch.batch")}),error:o(d).editBatch,"onUpdate:error":t[15]||(t[15]=e=>o(d).editBatch=e)},null,8,["modelValue","label","error"])]),a.editBatch?(m(),_("div",fe,[r(h,{name:"batch",label:o(i)("global.change",{attribute:o(i)("academic.batch.batch")}),modelValue:a.batch,"onUpdate:modelValue":t[16]||(t[16]=e=>a.batch=e),error:o(d).batch,"onUpdate:error":t[17]||(t[17]=e=>o(d).batch=e),"search-key":"course_batch","value-prop":"uuid","search-action":"academic/batch/list"},{selectedOption:n(e=>[f(u(e.value.course.name)+" - "+u(e.value.name),1)]),listOption:n(e=>[f(u(e.option.course.nameWithTerm)+" - "+u(e.option.name),1)]),_:1},8,["label","modelValue","error"])])):p("",!0),v("div",ge,[r(s,{vertical:"",modelValue:a.editCourse,"onUpdate:modelValue":t[18]||(t[18]=e=>a.editCourse=e),name:"editCourse",label:o(i)("global.edit",{attribute:o(i)("academic.course.course")}),error:o(d).editCourse,"onUpdate:error":t[19]||(t[19]=e=>o(d).editCourse=e)},null,8,["modelValue","label","error"])]),a.editCourse?(m(),_(S,{key:2},[v("div",ve,[r(h,{name:"courseBatch",label:o(i)("global.change",{attribute:o(i)("academic.batch.batch")}),modelValue:a.courseBatch,"onUpdate:modelValue":t[20]||(t[20]=e=>a.courseBatch=e),error:o(d).courseBatch,"onUpdate:error":t[21]||(t[21]=e=>o(d).courseBatch=e),"search-key":"course_batch","value-prop":"uuid","search-action":"academic/batch/list"},{selectedOption:n(e=>[f(u(e.value.course.name)+" - "+u(e.value.name),1)]),listOption:n(e=>[f(u(e.option.course.nameWithTerm)+" - "+u(e.option.name),1)]),_:1},8,["label","modelValue","error"]),r(N,null,{default:n(()=>[v("span",ke,u(o(i)("student.record.changing_course_info")),1)]),_:1})]),v("div",ye,[r(H,{modelValue:a.deleteFeeReceipt,"onUpdate:modelValue":t[22]||(t[22]=e=>a.deleteFeeReceipt=e),name:"deleteFeeReceipt",label:o(i)("student.record.delete_fee_receipt")},null,8,["modelValue","label"]),r(N,null,{default:n(()=>[v("span",_e,u(o(i)("student.record.force_changing_course_info")),1)]),_:1})])],64)):p("",!0),v("div",Ve,[F.isLoaded?(m(),y(B,{key:0,name:"enrollmentType",label:o(i)("global.select",{attribute:o(i)("student.enrollment_type.enrollment_type")}),modelValue:a.enrollmentType,"onUpdate:modelValue":t[23]||(t[23]=e=>a.enrollmentType=e),error:o(d).enrollmentType,"onUpdate:error":t[24]||(t[24]=e=>o(d).enrollmentType=e),options:D.enrollmentTypes,"value-prop":"uuid","label-prop":"name"},null,8,["label","modelValue","error","options"])):p("",!0)]),v("div",Be,[F.isLoaded?(m(),y(B,{key:0,name:"enrollmentStatus",label:o(i)("global.select",{attribute:o(i)("student.enrollment_status.enrollment_status")}),modelValue:a.enrollmentStatus,"onUpdate:modelValue":t[25]||(t[25]=e=>a.enrollmentStatus=e),error:o(d).enrollmentStatus,"onUpdate:error":t[26]||(t[26]=e=>o(d).enrollmentStatus=e),options:D.enrollmentStatuses,"value-prop":"uuid","label-prop":"name"},null,8,["label","modelValue","error","options"])):p("",!0)]),v("div",Ce,[r(R,{rows:1,modelValue:a.remarks,"onUpdate:modelValue":t[27]||(t[27]=e=>a.remarks=e),name:"remarks",label:o(i)("student.record.props.remarks"),error:o(d).remarks,"onUpdate:error":t[28]||(t[28]=e=>o(d).remarks=e)},null,8,["modelValue","label","error"])])],2))]),_:1},8,["uuid","module-uuid","form"])]),_:1},8,["show"])):p("",!0)}}}),Ne={name:"TemplateName"};function Te(b,O,P,U,g,i){return null}const Re=ne(Ne,[["render",Te]]),Se={key:0,class:"ml-1 far fa-check-circle fa-xl text-success"},Ue={class:"text-danger"},Fe={class:"text-danger"},he={class:"space-y-2"},je={class:"text-lg font-bold text-gray-400 dark:text-gray-500"},Pe={name:"StudentRecordList"},xe=Object.assign(Pe,{props:{student:{type:Object,default(){return{}}}},emits:["close","refresh"],setup(b,{emit:O}){const P=Q(),U=le(),g=X("emitter");let i=[];const V="student/record/",T=G(!1),d=G(!1),D=j({}),a=j({selectedRecord:{}}),F=s=>{a.selectedRecord=s,d.value=!0},A=()=>{d.value=!1},w=()=>{g.emit("studentUpdated"),g.emit("listItems")},M=s=>{Object.assign(D,s)},x=s=>{g.emit("actionItem",{uuid:s.uuid,action:"cancelAdmission",confirmation:!0})},$=s=>{g.emit("actionItem",{uuid:s.uuid,action:"cancelPromotion",confirmation:!0})},t=s=>{g.emit("actionItem",{uuid:s.uuid,action:"setDefaultPeriod",confirmation:!0})};return Y(()=>{g.on("actionPerformed",()=>{g.emit("studentUpdated")})}),se(()=>{g.all.delete("actionPerformed")}),(s,k)=>{const L=c("PageHeaderAction"),I=c("PageHeader"),h=c("ParentTransition"),N=c("TextMuted"),H=c("BaseBadge"),B=c("DataCell"),R=c("FloatingMenuItem"),E=c("FloatingMenu"),q=c("DataRow"),e=c("DataTable"),ee=c("ListItem"),te=c("BaseCard");return m(),_(S,null,[r(ee,{"init-url":V,uuid:o(P).params.uuid,onSetItems:M},{header:n(()=>[b.student.uuid?(m(),y(I,{key:0,title:s.$trans("student.record.record"),navs:[{label:s.$trans("student.student"),path:"Student"},{label:b.student.contact.name,path:{name:"StudentShow",params:{uuid:b.student.uuid}}}]},{default:n(()=>[r(L,{url:`students/${b.student.uuid}/records/`,name:"StudentRecord",title:s.$trans("student.record.record"),actions:o(i),"dropdown-actions":["print","pdf","excel"],onToggleFilter:k[0]||(k[0]=l=>T.value=!T.value)},null,8,["url","title","actions"])]),_:1},8,["title","navs"])):p("",!0)]),filter:n(()=>[r(h,{appear:"",visibility:T.value},{default:n(()=>[r(Re,{onRefresh:k[1]||(k[1]=l=>o(g).emit("listItems")),onHide:k[2]||(k[2]=l=>T.value=!1)})]),_:1},8,["visibility"])]),default:n(()=>[r(h,{appear:"",visibility:!0},{default:n(()=>[r(e,{header:D.headers,meta:D.meta,module:"student.record",onRefresh:k[3]||(k[3]=l=>o(g).emit("listItems"))},{actionButton:n(()=>k[4]||(k[4]=[])),default:n(()=>[(m(!0),_(S,null,J(D.data,l=>(m(),y(q,{key:l.uuid},{default:n(()=>[r(B,{name:"period"},{default:n(()=>{var C,W;return[v("span",{class:Z({"text-danger":l.period.id==((W=(C=b.student.contact)==null?void 0:C.user)==null?void 0:W.currentPeriodId)})},u(l.period.name),3),l.uuid==b.student.uuid?(m(),_("i",Se)):p("",!0),r(N,{block:""},{default:n(()=>[f(u(l.codeNumber)+" ("+u(l.joiningDate.formatted)+")",1)]),_:2},1024),l.cancelledAt.value?(m(),y(H,{key:1,design:"danger"},{default:n(()=>[f(u(s.$trans("student.statuses.cancelled")),1)]),_:1})):p("",!0)]}),_:2},1024),r(B,{name:"enrollmentType"},{default:n(()=>[f(u(l.enrollmentTypeName||"-")+" ",1),l.enrollmentStatusName?(m(),y(N,{key:0,block:""},{default:n(()=>[f(u(l.enrollmentStatusName),1)]),_:2},1024)):p("",!0)]),_:2},1024),r(B,{name:"course"},{default:n(()=>[f(u(l.courseName)+" ",1),r(N,{block:""},{default:n(()=>[f(u(l.batchName),1)]),_:2},1024)]),_:2},1024),r(B,{name:"startDate"},{default:n(()=>[f(u(l.startDate.formatted),1)]),_:2},1024),r(B,{name:"endDate"},{default:n(()=>[f(u(l.endDate.formatted||"-")+" ",1),l.transferReason?(m(),y(N,{key:0,block:""},{default:n(()=>[v("span",Ue,u(l.transferReason),1)]),_:2},1024)):p("",!0),l.transferCertificateNumber?(m(),y(N,{key:1,block:""},{default:n(()=>[v("span",Fe,u(l.transferCertificateNumber),1)]),_:2},1024)):p("",!0)]),_:2},1024),r(B,{name:"action"},{default:n(()=>[r(E,null,{default:n(()=>[l.uuid!=b.student.uuid?(m(),y(R,{key:0,icon:"fas fa-arrow-circle-right",onClick:C=>o(U).push({name:"StudentRecord",params:{uuid:l.uuid}})},{default:n(()=>[f(u(s.$trans("general.show")),1)]),_:2},1032,["onClick"])):p("",!0),o(z)("student:edit")?(m(),_(S,{key:1},[r(R,{icon:"fas fa-clock",onClick:C=>t(l)},{default:n(()=>[f(u(s.$trans("global.set_default",{attribute:s.$trans("academic.period.period")})),1)]),_:2},1032,["onClick"]),r(R,{icon:"fas fa-edit",onClick:C=>F(l)},{default:n(()=>[f(u(s.$trans("general.edit")),1)]),_:2},1032,["onClick"]),o(z)("student:edit")&&l.isAdmitted&&!l.cancelledAt.value?(m(),y(R,{key:0,icon:"fas fa-times",onClick:C=>x(l)},{default:n(()=>[f(u(s.$trans("global.cancel",{attribute:s.$trans("student.admission.admission")})),1)]),_:2},1032,["onClick"])):p("",!0),o(z)("student:edit")&&l.isPromoted&&!l.cancelledAt.value?(m(),y(R,{key:1,icon:"fas fa-times",onClick:C=>$(l)},{default:n(()=>[f(u(s.$trans("global.cancel",{attribute:s.$trans("student.promotion.promotion")})),1)]),_:2},1032,["onClick"])):p("",!0)],64)):p("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","meta"])]),_:1})]),_:1},8,["uuid"]),b.student.enrollmentStatusLogs.length?(m(),y(te,{key:0},{title:n(()=>[f(u(s.$trans("global.log",{attribute:s.$trans("student.enrollment_status.enrollment_status")})),1)]),default:n(()=>[v("div",he,[(m(!0),_(S,null,J(b.student.enrollmentStatusLogs,(l,C)=>(m(),_("div",{class:"text-sm dark:text-gray-400",key:l.uuid},[v("span",je,u(C+1)+".",1),f(" "+u(s.$trans("student.enrollment_status.log_detail",{status:l.enrollmentStatus,datetime:l.createdAt.formatted,user:l.createdBy})),1)]))),128))])]),_:1})):p("",!0),a.selectedRecord.uuid?(m(),y($e,{key:1,visibility:d.value,student:b.student,record:a.selectedRecord,onClose:A,onCompleted:w},null,8,["visibility","student","record"])):p("",!0)],64)}}});export{xe as default};
