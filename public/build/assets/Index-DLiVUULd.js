import{u as O,m as U,q as E,r as u,t as y,o as n,w as e,d as C,e as s,b as A,j as z,H as K,I as G,p as S,a as h,F as P,y as H,f as i,v as d,x as l,L as ne,i as le,k as re,z as R,A as ie,B as Q}from"./app-Cvm44xuh.js";import{d as X}from"./vuedraggable.umd-CV6Buk_j.js";const de={class:"grid grid-cols-3 gap-6"},ce={class:"col-span-3 sm:col-span-1"},ue={class:"col-span-3 sm:col-span-1"},me={class:"col-span-3 sm:col-span-1"},pe={class:"col-span-3 sm:col-span-1"},fe={__name:"Filter",emits:["hide"],setup(F,{emit:M}){const v=O(),f=M,B={name:"",code:"",shortcode:"",divisions:[]},p=U({...B}),_=U({divisions:[],isLoaded:!v.query.divisions});return E(async()=>{_.divisions=v.query.divisions?v.query.divisions.split(","):[],_.isLoaded=!0}),(c,m)=>{const k=u("BaseInput"),$=u("BaseSelectSearch"),g=u("FilterForm");return n(),y(g,{"init-form":B,form:p,multiple:["divisions"],onHide:m[4]||(m[4]=r=>f("hide"))},{default:e(()=>[C("div",de,[C("div",ce,[s(k,{type:"text",modelValue:p.name,"onUpdate:modelValue":m[0]||(m[0]=r=>p.name=r),name:"name",label:c.$trans("academic.course.props.name")},null,8,["modelValue","label"])]),C("div",ue,[s(k,{type:"text",modelValue:p.code,"onUpdate:modelValue":m[1]||(m[1]=r=>p.code=r),name:"code",label:c.$trans("academic.course.props.code")},null,8,["modelValue","label"])]),C("div",me,[s(k,{type:"text",modelValue:p.shortcode,"onUpdate:modelValue":m[2]||(m[2]=r=>p.shortcode=r),name:"shortcode",label:c.$trans("academic.course.props.shortcode")},null,8,["modelValue","label"])]),C("div",pe,[_.isLoaded?(n(),y($,{key:0,multiple:"",name:"divisions",label:c.$trans("global.select",{attribute:c.$trans("academic.division.division")}),modelValue:p.divisions,"onUpdate:modelValue":m[3]||(m[3]=r=>p.divisions=r),"value-prop":"uuid","init-search":_.divisions,"search-action":"academic/division/list"},null,8,["label","modelValue","init-search"])):A("",!0)])])]),_:1},8,["form"])}}},ve={class:"col-span-3 sm:col-span-1"},be={class:"col-span-3 sm:col-span-1"},_e={class:"col-span-3 sm:col-span-1"},he={class:"mt-4"},W="academic/course/",$e={__name:"BatchForm",props:{selectedCourse:{type:Object,default:()=>{}},visibility:{type:Boolean,default:!1}},emits:["close","refresh"],setup(F,{emit:M}){O(),z();const v=M,f={batches:[]},B={uuid:K(),name:"",maxStrength:"",rollNumberPrefix:""},p=G(W);S(!1);const _=U({...f}),c=()=>{_.batches.push({...B,uuid:K()})},m=()=>{v("close")},k=()=>{f.batches=[],Object.assign(_,f),c(),v("refresh"),v("close")};return E(async()=>{c()}),($,g)=>{const r=u("BaseInput"),V=u("BaseBadge"),j=u("FormAction"),L=u("BaseModal");return n(),y(L,{show:F.visibility,onClose:m},{title:e(()=>[d(l(F.selectedCourse.name)+" - "+l($.$trans("global.add",{attribute:$.$trans("academic.batch.batches")})),1)]),default:e(()=>[s(j,{"no-card":"","init-url":W,"init-form":f,form:_,uuid:F.selectedCourse.uuid,action:"addBatches","keep-adding":!1,"validate-unchanged":!1,"after-submit":k},{default:e(()=>[(n(!0),h(P,null,H(_.batches,(w,o)=>(n(),h("div",{class:"mt-4 grid grid-cols-3 gap-4",key:w.uuid},[C("div",ve,[s(r,{modelValue:w.name,"onUpdate:modelValue":t=>w.name=t,name:`batches.${o}.name`,label:$.$trans("academic.batch.props.name"),error:i(p)[`batches.${o}.name`],"onUpdate:error":t=>i(p)[`batches.${o}.name`]=t},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])]),C("div",be,[s(r,{type:"number",modelValue:w.maxStrength,"onUpdate:modelValue":t=>w.maxStrength=t,name:`batches.${o}.maxStrength`,label:$.$trans("academic.batch.props.max_strength"),error:i(p)[`batches.${o}.maxStrength`],"onUpdate:error":t=>i(p)[`batches.${o}.maxStrength`]=t},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])]),C("div",_e,[s(r,{modelValue:w.rollNumberPrefix,"onUpdate:modelValue":t=>w.rollNumberPrefix=t,name:`batches.${o}.rollNumberPrefix`,label:$.$trans("academic.batch.props.roll_number_prefix"),error:i(p)[`batches.${o}.rollNumberPrefix`],"onUpdate:error":t=>i(p)[`batches.${o}.rollNumberPrefix`]=t},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])])]))),128)),C("div",he,[s(V,{design:"primary",onClick:c,class:"cursor-pointer"},{default:e(()=>[d(l($.$trans("global.add",{attribute:$.$trans("academic.batch.batch")})),1)]),_:1})])]),_:1},8,["form","uuid"])]),_:1},8,["show"])}}},ge={key:0},ye={class:"flex border rounded-xl px-4 py-2"},Ce={key:1},Be={key:2,class:"mt-4 flex justify-end"},ke={name:"AcademicCourseReorder"},we=Object.assign(ke,{props:{visibility:{type:Boolean,default:!1}},emits:["close","refresh"],setup(F,{emit:M}){O();const v=z(),f=M,B={courses:[]};G("academic/course/");const _=S(!1),c=U({courses:[]});U({...B});const m=async()=>{_.value=!0,await v.dispatch("academic/course/list",{params:{all:!0}}).then(g=>{_.value=!1,c.courses=g}).catch(g=>{_.value=!1})},k=async()=>{_.value=!0,await v.dispatch("academic/course/reorder",{data:{courses:c.courses}}).then(g=>{_.value=!1,f("refresh"),f("close")}).catch(g=>{_.value=!1})},$=()=>{f("close")};return E(()=>{m()}),(g,r)=>{const V=u("BaseLabel"),j=u("BaseAlert"),L=u("BaseButton"),w=u("BaseModal");return n(),y(w,{show:F.visibility,onClose:$},{title:e(()=>[d(l(g.$trans("global.reorder",{attribute:g.$trans("academic.course.course")})),1)]),default:e(()=>[c.courses.length?(n(),h("div",ge,[s(i(X),{class:"space-y-2",list:c.courses,"item-key":"uuid"},{item:e(({element:o,index:t})=>[C("div",ye,[r[0]||(r[0]=C("i",{class:"fas fa-arrows mr-2 cursor-pointer"},null,-1)),s(V,null,{default:e(()=>[d(l(o.name),1)]),_:2},1024)])]),_:1},8,["list"])])):(n(),h("div",Ce,[s(j,{design:"info",size:"xs"},{default:e(()=>[d(l(g.$trans("general.errors.record_not_found")),1)]),_:1})])),c.courses.length?(n(),h("div",Be,[s(L,{onClick:k},{default:e(()=>[d(l(g.$trans("general.reorder")),1)]),_:1})])):A("",!0)]),_:1},8,["show"])}}}),Ve={key:0},Ae={class:"flex border rounded-xl px-4 py-2"},Fe={key:1},Ie={key:2,class:"mt-4 flex justify-end"},Ue={name:"AcademicCourseReorderBatch"},Me=Object.assign(Ue,{props:{selectedCourse:{type:Object,default:()=>{}},visibility:{type:Boolean,default:!1}},emits:["close","refresh"],setup(F,{emit:M}){O();const v=z(),f=M,B=F,p={batches:[]};G("academic/course/");const c=S(!1),m=U({batches:[]});U({...p});const k=async()=>{c.value=!0,await v.dispatch("academic/batch/list",{params:{courses:[B.selectedCourse.uuid],all:!0}}).then(r=>{c.value=!1,m.batches=r}).catch(r=>{c.value=!1})},$=async()=>{c.value=!0,await v.dispatch("academic/course/reorderBatch",{data:{course:B.selectedCourse.uuid,batches:m.batches}}).then(r=>{c.value=!1,f("refresh"),f("close")}).catch(r=>{c.value=!1})},g=()=>{f("close")};return ne(()=>B.selectedCourse,r=>{r&&k()},{deep:!0}),(r,V)=>{const j=u("BaseLabel"),L=u("BaseAlert"),w=u("BaseButton"),o=u("BaseModal");return n(),y(o,{show:F.visibility,onClose:g},{title:e(()=>[d(l(r.$trans("global.reorder",{attribute:r.$trans("academic.batch.batch")})),1)]),default:e(()=>[m.batches.length?(n(),h("div",Ve,[s(i(X),{class:"space-y-2",list:m.batches,"item-key":"uuid"},{item:e(({element:t,index:x})=>[C("div",Ae,[V[0]||(V[0]=C("i",{class:"fas fa-arrows mr-2 cursor-pointer"},null,-1)),s(j,null,{default:e(()=>[d(l(t.name),1)]),_:2},1024)])]),_:1},8,["list"])])):(n(),h("div",Fe,[s(L,{design:"info",size:"xs"},{default:e(()=>[d(l(r.$trans("general.errors.record_not_found")),1)]),_:1})])),m.batches.length?(n(),h("div",Ie,[s(w,{onClick:$},{default:e(()=>[d(l(r.$trans("general.reorder")),1)]),_:1})])):A("",!0)]),_:1},8,["show"])}}}),Re={key:0},Se={class:"flex text-xs flex-wrap gap-2"},je={class:"flex text-xs flex-wrap gap-2"},Le={key:0,class:"far fa-check-circle fa-xl text-success"},De={key:1,class:"far fa-circle-xmark fa-xl text-danger"},Pe={name:"AcademicCourseList"},Te=Object.assign(Pe,{emits:["refresh"],setup(F,{emit:M}){const v=le(),f=re("emitter");let B=["filter"];R("course:create")&&B.unshift("create");let p=[];R("course:export")&&(p=["print","pdf","excel"]),R("course:create")&&p.unshift("import");const _="academic/course/",c=S(!1),m=S(!1),k=S(!1),$=S(!1),g=S(!1),r=U({}),V=U({selectedCourse:null}),j=o=>{Object.assign(r,o)},L=o=>{V.selectedCourse=o,k.value=!0},w=o=>{V.selectedCourse=o,g.value=!0};return(o,t)=>{const x=u("BaseButton"),Y=u("PageHeaderAction"),Z=u("PageHeader"),ee=u("BaseImport"),q=u("ParentTransition"),N=u("TextMuted"),I=u("DataCell"),D=u("FloatingMenuItem"),te=u("FloatingMenu"),se=u("DataRow"),ae=u("DataTable"),oe=u("ListItem"),J=ie("tooltip");return n(),h(P,null,[s(oe,{"init-url":_,"additional-query":{details:!0},onSetItems:j},{header:e(()=>[s(Z,{title:o.$trans("academic.course.course"),navs:[{label:o.$trans("academic.academic"),path:"Academic"}]},{default:e(()=>[s(Y,{url:"academic/courses/",name:"AcademicCourse",title:o.$trans("academic.course.course"),actions:i(B),"dropdown-actions":i(p),"additional-dropdown-actions-query":{details:!0},onToggleFilter:t[3]||(t[3]=a=>c.value=!c.value),onToggleImport:t[4]||(t[4]=a=>m.value=!m.value)},{default:e(()=>[Q((n(),y(x,{design:"white",onClick:t[0]||(t[0]=a=>$.value=!$.value)},{default:e(()=>t[18]||(t[18]=[C("i",{class:"fas fa-arrows-up-down-left-right"},null,-1)])),_:1,__:[18]})),[[J,o.$trans("global.reorder",{attribute:o.$trans("academic.course.course")})]]),i(R)("course-incharge:read")?(n(),y(x,{key:0,design:"white",onClick:t[1]||(t[1]=a=>i(v).push({name:"AcademicCourseIncharge"}))},{default:e(()=>[d(l(o.$trans("employee.incharge.incharge")),1)]),_:1})):A("",!0),s(x,{design:"white",onClick:t[2]||(t[2]=a=>i(v).push({name:"AcademicEnrollmentSeat"}))},{default:e(()=>[d(l(o.$trans("academic.enrollment_seat.enrollment_seat")),1)]),_:1})]),_:1},8,["title","actions","dropdown-actions"])]),_:1},8,["title","navs"])]),import:e(()=>[s(q,{appear:"",visibility:m.value},{default:e(()=>[s(ee,{path:"academic/courses/import",onCancelled:t[5]||(t[5]=a=>m.value=!1),onHide:t[6]||(t[6]=a=>m.value=!1),onCompleted:t[7]||(t[7]=a=>i(f).emit("listItems"))})]),_:1},8,["visibility"])]),filter:e(()=>[s(q,{appear:"",visibility:c.value},{default:e(()=>[s(fe,{onRefresh:t[8]||(t[8]=a=>i(f).emit("listItems")),onHide:t[9]||(t[9]=a=>c.value=!1)})]),_:1},8,["visibility"])]),default:e(()=>[s(q,{appear:"",visibility:!0},{default:e(()=>[s(ae,{header:r.headers,meta:r.meta,module:"academic.course",onRefresh:t[11]||(t[11]=a=>i(f).emit("listItems"))},{actionButton:e(()=>[i(R)("course:create")?(n(),y(x,{key:0,onClick:t[10]||(t[10]=a=>i(v).push({name:"AcademicCourseCreate"}))},{default:e(()=>[d(l(o.$trans("global.add",{attribute:o.$trans("academic.course.course")})),1)]),_:1})):A("",!0)]),default:e(()=>[(n(!0),h(P,null,H(r.data,a=>(n(),y(se,{key:a.uuid,onDoubleClick:b=>i(v).push({name:"AcademicCourseShow",params:{uuid:a.uuid}})},{default:e(()=>[s(I,{name:"name"},{default:e(()=>[d(l(a.name)+" ",1),a.term?(n(),h("span",Re,"("+l(a.term)+")",1)):A("",!0),a.enableRegistration?(n(),y(N,{key:1,block:""},{default:e(()=>[d(l(a.registrationFee.formatted),1)]),_:2},1024)):A("",!0),a.pgAccount?(n(),y(N,{key:2,block:""},{default:e(()=>[d(l(a.pgAccount),1)]),_:2},1024)):A("",!0)]),_:2},1024),s(I,{name:"division"},{default:e(()=>[d(l(a.division.name)+" ",1),s(N,{block:""},{default:e(()=>{var b;return[d(l((b=a.division.program)==null?void 0:b.name),1)]}),_:2},1024)]),_:2},1024),s(I,{name:"code"},{default:e(()=>[d(l(a.code)+" ",1),s(N,{block:""},{default:e(()=>[d(l(a.shortcode),1)]),_:2},1024)]),_:2},1024),s(I,{name:"incharge"},{default:e(()=>[(n(!0),h(P,null,H(a.incharges,b=>{var T;return n(),h("div",null,[d(l(((T=b==null?void 0:b.employee)==null?void 0:T.name)||"-")+" ",1),s(N,null,{default:e(()=>[d(l(b==null?void 0:b.period),1)]),_:2},1024)])}),256))]),_:2},1024),s(I,{name:"batches"},{default:e(()=>[(n(!0),h(P,null,H(a.batches,b=>(n(),h("span",Se,l(b.name),1))),256))]),_:2},1024),s(I,{name:"subjects"},{default:e(()=>[(n(!0),h(P,null,H(a.subjectRecords,b=>{var T;return n(),h("span",je,l((T=b.subject)==null?void 0:T.name),1)}),256))]),_:2},1024),s(I,{name:"registration"},{default:e(()=>[a.enableRegistration?Q((n(),h("i",Le,null,512)),[[J,o.$trans("academic.course.props.enable_registartion")]]):(n(),h("i",De))]),_:2},1024),s(I,{name:"createdAt"},{default:e(()=>[d(l(a.createdAt.formatted),1)]),_:2},1024),s(I,{name:"action"},{default:e(()=>[s(te,null,{default:e(()=>[s(D,{icon:"fas fa-arrow-circle-right",onClick:b=>i(v).push({name:"AcademicCourseShow",params:{uuid:a.uuid}})},{default:e(()=>[d(l(o.$trans("general.show")),1)]),_:2},1032,["onClick"]),s(D,{icon:"fas fa-plus",onClick:b=>L(a)},{default:e(()=>[d(l(o.$trans("global.add",{attribute:o.$trans("academic.batch.batches")})),1)]),_:2},1032,["onClick"]),s(D,{icon:"fas fa-arrows-alt",onClick:b=>w(a)},{default:e(()=>[d(l(o.$trans("general.reorder")),1)]),_:2},1032,["onClick"]),i(R)("course:edit")?(n(),y(D,{key:0,icon:"fas fa-edit",onClick:b=>i(v).push({name:"AcademicCourseEdit",params:{uuid:a.uuid}})},{default:e(()=>[d(l(o.$trans("general.edit")),1)]),_:2},1032,["onClick"])):A("",!0),i(R)("course:create")?(n(),y(D,{key:1,icon:"fas fa-copy",onClick:b=>i(v).push({name:"AcademicCourseDuplicate",params:{uuid:a.uuid}})},{default:e(()=>[d(l(o.$trans("general.duplicate")),1)]),_:2},1032,["onClick"])):A("",!0),i(R)("course:delete")?(n(),y(D,{key:2,icon:"fas fa-trash",onClick:b=>i(f).emit("deleteItem",{uuid:a.uuid})},{default:e(()=>[d(l(o.$trans("general.delete")),1)]),_:2},1032,["onClick"])):A("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onDoubleClick"]))),128))]),_:1},8,["header","meta"])]),_:1})]),_:1}),V.selectedCourse?(n(),y($e,{key:0,"selected-course":V.selectedCourse,visibility:k.value,onClose:t[12]||(t[12]=a=>k.value=!1),onRefresh:t[13]||(t[13]=a=>i(f).emit("listItems"))},null,8,["selected-course","visibility"])):A("",!0),s(we,{visibility:$.value,onClose:t[14]||(t[14]=a=>$.value=!1),onRefresh:t[15]||(t[15]=a=>i(f).emit("listItems"))},null,8,["visibility"]),s(Me,{"selected-course":V.selectedCourse,visibility:g.value,onClose:t[16]||(t[16]=a=>g.value=!1),onRefresh:t[17]||(t[17]=a=>i(f).emit("listItems"))},null,8,["selected-course","visibility"])],64)}}});export{Te as default};
