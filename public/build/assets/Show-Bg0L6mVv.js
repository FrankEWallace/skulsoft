import{k as X,m as H,I as Y,r as m,t as y,o as u,w as e,e as t,d as R,a as B,b,f as s,v as i,x as n,u as Z,H as re,j as ue,i as pe,p as O,z,F as h,y as G,n as de}from"./app-Cvm44xuh.js";const me={class:"grid grid-cols-2 gap-6"},ce={class:"col-span-2 sm:col-span-1"},be={key:0,class:"col-span-2 sm:col-span-1"},ve={class:"col-span-2"},K="approval/request/",ye={__name:"ActionForm",props:{approvalRequest:Object},emits:["complete"],setup(M,{emit:S}){const T=M,o=S,w=X("$trans"),A={status:"",comment:""},V=H({statuses:[]}),c=Y(K),k=H({...A}),a=$=>{Object.assign(V,$)},L=()=>{let $=[];$.push({uuid:"requester",name:w("approval.request.props.requester")});const r=T.approvalRequest.records.findIndex(C=>C.isActionable===!0);return(r!==-1?T.approvalRequest.records.slice(0,r):T.approvalRequest.records).forEach(C=>{$.push({uuid:C.employee.uuid,name:C.employee.name+" ("+C.employee.codeNumber+")"})}),$},f=()=>{o("complete")};return($,r)=>{const D=m("BaseSelect"),C=m("BaseTextarea"),p=m("FormAction"),F=m("BaseCard");return u(),y(F,null,{title:e(()=>[i(n(s(w)("approval.request.action")),1)]),action:e(()=>r[6]||(r[6]=[])),default:e(()=>[t(p,{"no-card":"","keep-adding":!1,"init-url":K,"pre-requisites":!0,"pre-requisite-custom-url":"actionPreRequisite",onSetPreRequisites:a,uuid:M.approvalRequest.uuid,"no-data-fetch":!0,action:"status","init-form":A,form:k,"after-submit":f},{default:e(()=>[R("div",me,[R("div",ce,[t(D,{name:"status",label:s(w)("global.select",{attribute:s(w)("approval.request.props.status")}),modelValue:k.status,"onUpdate:modelValue":r[0]||(r[0]=g=>k.status=g),options:V.statuses,error:s(c).status,"onUpdate:error":r[1]||(r[1]=g=>s(c).status=g)},null,8,["label","modelValue","options","error"])]),k.status=="returned"?(u(),B("div",be,[t(D,{name:"returnTo",label:s(w)("approval.request.props.return_to"),modelValue:k.returnTo,"onUpdate:modelValue":r[2]||(r[2]=g=>k.returnTo=g),options:L(),"label-prop":"name","value-prop":"uuid",error:s(c).returnTo,"onUpdate:error":r[3]||(r[3]=g=>s(c).returnTo=g)},null,8,["label","modelValue","options","error"])])):b("",!0),R("div",ve,[t(C,{modelValue:k.comment,"onUpdate:modelValue":r[4]||(r[4]=g=>k.comment=g),name:"comment",label:s(w)("approval.request.props.comment"),error:s(c).comment,"onUpdate:error":r[5]||(r[5]=g=>s(c).comment=g)},null,8,["modelValue","label","error"])])])]),_:1},8,["uuid","form"])]),_:1})}}},fe={class:"grid grid-cols-1"},_e={class:"col"},qe={name:"ApprovalRequestMediaForm"},ge=Object.assign(qe,{props:{approvalRequest:{type:Object,default(){return{}}},visibility:{type:Boolean,default:!1}},emits:["close","completed"],setup(M,{emit:S}){Z();const T=S,o={media:[],mediaUpdated:!1,mediaToken:re(),mediaHash:[]},w="approval/request/media/";Y(w);const A=H({...o});return(V,c)=>{const k=m("MediaUpload"),a=m("FormAction"),L=m("BaseSideover");return u(),y(L,{visibility:M.visibility,onClose:c[6]||(c[6]=f=>T("close"))},{title:e(()=>[R("span",null,n(V.$trans("global.add",{attribute:V.$trans("general.media")})),1)]),default:e(()=>[t(a,{sideover:"","no-card":"","no-data-fetch":"","cancel-action":"",action:"create","init-url":w,"init-form":o,form:A,onEnd:c[3]||(c[3]=f=>T("close")),onCompleted:c[4]||(c[4]=f=>T("completed")),onCancelled:c[5]||(c[5]=f=>T("close"))},{default:e(()=>[R("div",fe,[R("div",_e,[M.approvalRequest.uuid?(u(),y(k,{key:0,multiple:"",label:V.$trans("general.file"),module:"approval_request",media:A.media,onIsUpdated:c[0]||(c[0]=f=>A.mediaUpdated=!0),onSetHash:c[1]||(c[1]=f=>A.mediaHash=f),onSetToken:c[2]||(c[2]=f=>A.mediaToken=f)},null,8,["label","media"])):b("",!0)])])]),_:1},8,["form"])]),_:1},8,["visibility"])}}}),ke={class:"space-y-2"},Te={class:"grid grid-cols-1 gap-x-4 gap-y-8 px-4 pt-4 sm:grid-cols-2"},we={key:0},$e={key:0,class:"font-semibold"},Ae={key:1},Ce={name:"ApprovalRequestShow"},Re=Object.assign(Ce,{setup(M){ue();const S=Z(),T=pe(),o=X("$trans"),w={},A="approval/request/",V=[{key:"employee",label:o("employee.employee"),visibility:!0},{key:"receivedAt",label:o("approval.request.props.received_at"),visibility:!0},{key:"status",label:o("approval.request.props.status"),visibility:!0},{key:"comment",label:o("approval.request.props.comment"),visibility:!0},{key:"action",label:"",visibility:!0}];o("general.file"),o("user.user"),o("general.created_at");const c=[{key:"item",label:o("approval.request.item"),visibility:!0},{key:"quantity",label:o("inventory.stock_item.props.quantity"),visibility:!0},{key:"unit",label:o("inventory.stock_item.props.unit"),visibility:!0},{key:"price",label:o("inventory.stock_item.props.price"),visibility:!0},{key:"action",label:"",visibility:!0}],k=[{key:"item",label:o("approval.request.item"),visibility:!0},{key:"amount",label:o("inventory.stock_item.props.amount"),visibility:!0},{key:"action",label:"",visibility:!0}];o("inventory.item"),o("finance.transaction.props.amount"),o("approval.request.props.description");const a=H({...w}),L=C=>{Object.assign(a,C)};O(!1);const f=O(!1),$=O(!1),r=H({activeTab:"showApprovers"}),D=()=>{window.open(`/app/approval/requests/${a.uuid}/export?action=print`)};return(C,p)=>{const F=m("BaseButton"),g=m("PageHeaderAction"),ee=m("PageHeader"),q=m("ListItemView"),U=m("TextMuted"),I=m("BaseBadge"),te=m("ListContainerVertical"),P=m("BaseCard"),v=m("DataCell"),E=m("DataRow"),j=m("SimpleTable"),_=m("BaseDataView"),Q=m("ListMedia"),N=m("TabItem"),ae=m("TabGroup"),le=m("BaseComment"),oe=m("ActivityLog"),se=m("DetailLayoutVertical"),ne=m("ShowItem"),ie=m("ParentTransition");return u(),B(h,null,[t(ee,{title:s(o)(s(S).meta.trans,{attribute:s(o)(s(S).meta.label)}),navs:[{label:s(o)("approval.approval"),path:"Approval"},{label:s(o)("approval.request.request"),path:"ApprovalRequestList"}]},{default:e(()=>[t(g,{name:"ApprovalRequest",title:s(o)("approval.request.request"),actions:["list"]},{default:e(()=>{var l;return[((l=a==null?void 0:a.status)==null?void 0:l.value)=="approved"?(u(),y(F,{key:0,design:"white",onClick:D},{default:e(()=>[p[12]||(p[12]=R("i",{class:"fas fa-print mr-2"},null,-1)),i(" "+n(s(o)("general.print")),1)]),_:1,__:[12]})):b("",!0),s(z)("approval-request:edit")&&a.isEditable?(u(),y(F,{key:1,design:"white",onClick:p[0]||(p[0]=d=>s(T).push({name:"ApprovalRequestEdit",params:{uuid:a.uuid}}))},{default:e(()=>[i(n(s(o)("global.edit",{attribute:s(o)("approval.request.request")})),1)]),_:1})):b("",!0),!$.value&&a.isEditable?(u(),y(F,{key:2,design:"white",onClick:p[1]||(p[1]=d=>$.value=!0)},{default:e(()=>[i(n(s(o)("global.add",{attribute:s(o)("general.media")})),1)]),_:1})):b("",!0)]}),_:1},8,["title"])]),_:1},8,["title","navs"]),t(ie,{appear:"",visibility:!0},{default:e(()=>[t(ne,{"init-url":A,uuid:s(S).params.uuid,onSetItem:L,onRedirectTo:p[8]||(p[8]=l=>s(T).push({name:"ApprovalRequest"})),refresh:f.value,onRefreshed:p[9]||(p[9]=l=>f.value=!1)},{default:e(()=>[a.uuid?(u(),y(se,{key:0},{detail:e(()=>[R("div",ke,[t(P,{"no-padding":"","no-content-padding":""},{title:e(()=>[i(n(s(o)("approval.request.request")),1)]),action:e(()=>p[13]||(p[13]=[])),default:e(()=>[t(te,null,{default:e(()=>[t(q,{label:s(o)("approval.request.props.code_number")},{default:e(()=>[i(n(a.codeNumber),1)]),_:1},8,["label"]),t(q,{label:s(o)("approval.request.props.title")},{default:e(()=>[i(n(a.title),1)]),_:1},8,["label"]),t(q,{label:s(o)("approval.request.props.requester"),dynamic:""},{default:e(()=>{var l;return[i(n(((l=a.requester)==null?void 0:l.name)||"-")+" ",1),t(U,{block:""},{default:e(()=>{var d;return[i(n(((d=a.requester)==null?void 0:d.designation)||"-"),1)]}),_:1})]}),_:1},8,["label"]),t(q,{label:s(o)("approval.type.type")},{default:e(()=>{var l;return[i(n(((l=a.type)==null?void 0:l.name)||"-"),1)]}),_:1},8,["label"]),t(q,{label:s(o)("approval.request.props.amount")},{default:e(()=>[i(n(a.amount.value>0?a.amount.formatted:"-"),1)]),_:1},8,["label"]),t(q,{label:s(o)("approval.request.props.date")},{default:e(()=>{var l;return[i(n(((l=a.date)==null?void 0:l.formatted)||"-"),1)]}),_:1},8,["label"]),t(q,{label:s(o)("approval.request.props.due_date")},{default:e(()=>{var l;return[i(n(((l=a.dueDate)==null?void 0:l.formatted)||"-"),1)]}),_:1},8,["label"]),t(q,{label:s(o)("approval.type.props.category")},{default:e(()=>{var l,d;return[i(n(((d=(l=a.type)==null?void 0:l.category)==null?void 0:d.label)||"-"),1)]}),_:1},8,["label"]),t(q,{label:s(o)("approval.request.props.priority"),dynamic:""},{default:e(()=>{var l;return[t(I,{design:"custom",color:(l=a.priority)==null?void 0:l.color},{default:e(()=>{var d;return[i(n(((d=a.priority)==null?void 0:d.name)||"-"),1)]}),_:1},8,["color"])]}),_:1},8,["label"]),t(q,{label:s(o)("approval.request.group.group"),dynamic:""},{default:e(()=>{var l;return[t(I,{design:"custom",color:(l=a.group)==null?void 0:l.color},{default:e(()=>{var d;return[i(n(((d=a.group)==null?void 0:d.name)||"-"),1)]}),_:1},8,["color"])]}),_:1},8,["label"]),t(q,{label:s(o)("approval.request.nature.nature"),dynamic:""},{default:e(()=>{var l;return[t(I,{design:"custom",color:(l=a.nature)==null?void 0:l.color},{default:e(()=>{var d;return[i(n(((d=a.nature)==null?void 0:d.name)||"-"),1)]}),_:1},8,["color"])]}),_:1},8,["label"]),t(q,{label:s(o)("approval.request.props.status"),dynamic:""},{default:e(()=>{var l;return[t(I,{design:(l=a.status)==null?void 0:l.color},{default:e(()=>{var d;return[i(n(((d=a.status)==null?void 0:d.label)||"-"),1)]}),_:1},8,["design"])]}),_:1},8,["label"]),t(q,{label:s(o)("general.created_at")},{default:e(()=>[i(n(a.createdAt.formatted),1)]),_:1},8,["label"]),t(q,{label:s(o)("general.updated_at")},{default:e(()=>[i(n(a.updatedAt.formatted),1)]),_:1},8,["label"])]),_:1})]),_:1})])]),default:e(()=>[t(P,{"no-padding":"","no-content-padding":"","bottom-content-padding":""},{title:e(()=>[i(n(s(o)("global.detail",{attribute:s(o)("approval.request.request")}))+" - "+n(a.type.category.label),1)]),default:e(()=>[a.type.category.value=="item_based"&&a.type.itemBasedType=="item_with_quantity"?(u(),y(j,{key:0,header:c},{default:e(()=>[(u(!0),B(h,null,G(a.items,l=>(u(),y(E,{key:l.uuid},{default:e(()=>[t(v,{name:"item"},{default:e(()=>[i(n(l.item)+" ",1),t(U,{block:""},{default:e(()=>[i(n(l.description),1)]),_:2},1024)]),_:2},1024),t(v,{name:"quantity"},{default:e(()=>[i(n(l.quantity),1)]),_:2},1024),t(v,{name:"unit"},{default:e(()=>[i(n(l.unit),1)]),_:2},1024),t(v,{name:"price"},{default:e(()=>[i(n(l.price.formatted),1)]),_:2},1024),t(v,{name:"action"})]),_:2},1024))),128)),t(E,{"is-heading":""},{default:e(()=>[t(v,{name:"item"},{default:e(()=>[i(n(s(o)("general.total")),1)]),_:1}),t(v,{name:"quantity"}),t(v,{name:"unit"}),t(v,{name:"price"},{default:e(()=>[i(n(a.amount.formatted),1)]),_:1}),t(v,{name:"action"})]),_:1})]),_:1})):b("",!0),a.type.category.value=="item_based"&&a.type.itemBasedType=="item_without_quantity"?(u(),y(j,{key:1,header:k},{default:e(()=>[(u(!0),B(h,null,G(a.items,l=>(u(),y(E,{key:l.uuid},{default:e(()=>[t(v,{name:"item"},{default:e(()=>[i(n(l.item)+" ",1),t(U,{block:""},{default:e(()=>[i(n(l.description),1)]),_:2},1024)]),_:2},1024),t(v,{name:"amount"},{default:e(()=>[i(n(l.amount.formatted),1)]),_:2},1024),t(v,{name:"action"})]),_:2},1024))),128)),t(E,{"is-heading":""},{default:e(()=>[t(v,{name:"item"},{default:e(()=>[i(n(s(o)("general.total")),1)]),_:1}),t(v,{name:"amount"},{default:e(()=>[i(n(a.amount.formatted),1)]),_:1}),t(v,{name:"action"})]),_:1})]),_:1})):b("",!0),R("dl",Te,[a.type.category.value=="contact_based"?(u(),B(h,{key:0},[t(_,{class:"col-span-1",label:s(o)("contact.props.name")},{default:e(()=>[i(n(a.contact.name),1)]),_:1},8,["label"]),t(_,{class:"col-span-1",label:s(o)("contact.props.contact_number")},{default:e(()=>[i(n(a.contact.contactNumber),1)]),_:1},8,["label"]),t(_,{class:"col-span-1",label:s(o)("contact.props.email")},{default:e(()=>[i(n(a.contact.email),1)]),_:1},8,["label"]),t(_,{class:"col-span-1",label:s(o)("contact.props.website")},{default:e(()=>[i(n(a.contact.website),1)]),_:1},8,["label"]),t(_,{class:"col-span-1",label:s(o)("contact.props.tax_number")},{default:e(()=>[i(n(a.contact.taxNumber),1)]),_:1},8,["label"]),t(_,{class:"col-span-1",label:s(o)("contact.props.address.address")},{default:e(()=>[i(n(a.contact.addressDisplay),1)]),_:1},8,["label"])],64)):b("",!0),a.type.category.value=="payment_based"?(u(),B(h,{key:1},[t(_,{class:"col-span-1",label:s(o)("inventory.vendor.vendor")},{default:e(()=>{var l;return[i(n(((l=a.vendor)==null?void 0:l.name)||"-"),1)]}),_:1},8,["label"]),t(_,{class:"col-span-1",label:s(o)("finance.transaction.props.payee_detail")},{default:e(()=>[i(n(a.payment.payee),1)]),_:1},8,["label"]),t(_,{class:"col-span-1",label:s(o)("finance.transaction.props.amount")},{default:e(()=>[i(n(a.payment.amount.formatted),1)]),_:1},8,["label"]),t(_,{class:"col-span-1",label:s(o)("finance.transaction.props.invoice_number")},{default:e(()=>[i(n(a.payment.invoiceNumber),1)]),_:1},8,["label"]),t(_,{class:"col-span-1",label:s(o)("finance.transaction.props.invoice_date")},{default:e(()=>{var l;return[i(n(((l=a.payment.invoiceDate)==null?void 0:l.formatted)||"-"),1)]}),_:1},8,["label"]),t(_,{class:"col-span-1",label:s(o)("finance.transaction.props.mode")},{default:e(()=>[i(n(a.payment.mode),1)]),_:1},8,["label"]),t(_,{class:"col-span-1",label:s(o)("finance.transaction.props.details")},{default:e(()=>[i(n(a.payment.details),1)]),_:1},8,["label"])],64)):b("",!0),a.type.category.value=="other"?(u(),y(_,{key:2,class:"col-span-1 sm:col-span-2",label:s(o)("approval.request.props.purpose")},{default:e(()=>[i(n(a.purpose),1)]),_:1},8,["label"])):b("",!0),t(_,{class:"col-span-1 sm:col-span-2",label:s(o)("academic.course.props.description")},{default:e(()=>[i(n(a.description),1)]),_:1},8,["label"]),r.activeTab!="showMedia"?(u(),y(_,{key:3,class:"col-span-1 sm:col-span-2"},{default:e(()=>[t(Q,{media:a.media,url:`/app/approval/requests/${a.uuid}/`},null,8,["media","url"])]),_:1})):b("",!0)])]),_:1}),s(z)("approval-request:action")&&a.isActionable?(u(),y(ye,{key:0,"approval-request":a,onComplete:p[2]||(p[2]=l=>f.value=!0)},null,8,["approval-request"])):b("",!0),t(P,{class:"mt-4","no-padding":"","no-content-padding":""},{title:e(()=>[i(n(s(o)("general.action")),1)]),default:e(()=>[t(ae,null,{default:e(()=>[t(N,{first:"",label:s(o)("approval.approvers"),onClick:p[3]||(p[3]=l=>r.activeTab="showApprovers"),"is-active":r.activeTab=="showApprovers"},null,8,["label","is-active"]),t(N,{first:"",label:s(o)("general.media"),onClick:p[4]||(p[4]=l=>r.activeTab="showMedia"),"is-active":r.activeTab=="showMedia"},null,8,["label","is-active"]),t(N,{first:"",label:s(o)("comment.comment"),onClick:p[5]||(p[5]=l=>r.activeTab="showComment"),"is-active":r.activeTab=="showComment"},null,8,["label","is-active"]),t(N,{first:"",label:s(o)("activity.activity"),onClick:p[6]||(p[6]=l=>r.activeTab="showActivity"),"is-active":r.activeTab=="showActivity"},null,8,["label","is-active"])]),_:1}),R("div",{class:de({"mt-8 px-4 pb-4":r.activeTab!="showApprovers"&&r.activeTab!="showMedia"})},[r.activeTab=="showApprovers"?(u(),B("div",we,[a.records.length>0?(u(),y(j,{key:0,header:V},{default:e(()=>[(u(!0),B(h,null,G(a.records,l=>(u(),y(E,{key:l.uuid},{default:e(()=>[t(v,{name:"employee"},{default:e(()=>{var d,x;return[i(n((d=l.employee)==null?void 0:d.name)+" ("+n((x=l.employee)==null?void 0:x.codeNumber)+") ",1),t(U,{block:""},{default:e(()=>{var W,J;return[i(n((W=l.employee)==null?void 0:W.designation)+" ",1),l.isOtherTeamMember?(u(),B("span",$e,n((J=l.employee)==null?void 0:J.teamCode),1)):b("",!0)]}),_:2},1024),l.duration?(u(),y(U,{key:0,block:""},{default:e(()=>[i(n(l.duration),1)]),_:2},1024)):b("",!0)]}),_:2},1024),t(v,{name:"receivedAt"},{default:e(()=>{var d;return[i(n((d=l.receivedAt)==null?void 0:d.formatted)+" ",1),l.processedAt?(u(),y(U,{key:0,block:""},{default:e(()=>{var x;return[i(n((x=l.processedAt)==null?void 0:x.formatted),1)]}),_:2},1024)):b("",!0)]}),_:2},1024),t(v,{name:"status"},{default:e(()=>{var d;return[l.status.value?(u(),y(I,{key:0,design:(d=l.status)==null?void 0:d.color},{default:e(()=>{var x;return[i(n((x=l.status)==null?void 0:x.label),1)]}),_:2},1032,["design"])):b("",!0)]}),_:2},1024),t(v,{name:"comment"},{default:e(()=>[i(n(l.comment),1)]),_:2},1024),t(v,{name:"action"})]),_:2},1024))),128))]),_:1})):b("",!0)])):b("",!0),r.activeTab=="showMedia"?(u(),B("div",Ae,[t(Q,{onRefresh:p[7]||(p[7]=l=>f.value=!0),layout:"table",module:a,media:a.media,url:`/app/approval/requests/${a.uuid}/`,"show-delete-action":!!s(z)("approval-request:edit"),"delete-url":"approval/request/media/delete"},null,8,["module","media","url","show-delete-action"])])):b("",!0),r.activeTab=="showComment"?(u(),y(le,{key:2,type:"approval_request",uuid:a.uuid,comments:a.comments,"can-comment":!0},null,8,["uuid","comments"])):b("",!0),r.activeTab=="showActivity"?(u(),y(oe,{key:3,type:"approval_request",uuid:a.uuid,activities:a.activities},null,8,["uuid","activities"])):b("",!0)],2)]),_:1})]),_:1})):b("",!0)]),_:1},8,["uuid","refresh"])]),_:1}),t(ge,{"approval-request":a,visibility:$.value,onCompleted:p[10]||(p[10]=l=>f.value=!0),onClose:p[11]||(p[11]=l=>$.value=!1)},null,8,["approval-request","visibility"])],64)}}});export{Re as default};
