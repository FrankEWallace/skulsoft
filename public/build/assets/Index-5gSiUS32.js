import{u as G,j as N,p as C,I as z,m as T,q as L,ai as S,r as c,t as B,o as d,w as i,a as g,b as v,d as p,e as u,f as s,v as V,x as m,C as J,F as H,i as K,z as Q}from"./app-Cvm44xuh.js";const X={key:0,class:"grid grid-cols-3 gap-6"},Y={class:"col-span-3 sm:col-span-1"},Z={key:0,class:"col-span-3 sm:col-span-1"},P={class:"ml-1"},ee={class:"ml-1"},te={key:1,class:"col-span-3 sm:col-span-1"},ae={key:0,class:"ml-1"},se={key:0,class:"ml-1"},oe={class:"col-span-3 sm:col-span-1"},le={class:"col-span-3 sm:col-span-1"},re={class:"flex items-center gap-2"},ne={key:0,class:"grid grid-cols-3 gap-6"},ue={key:0,class:"col-span-3 sm:col-span-1"},me={class:"col-span-3 sm:col-span-1"},ie={class:"col-span-3 sm:col-span-1"},de={class:"col-span-3 sm:col-span-1"},pe={class:"col-span-3 sm:col-span-1"},ve={class:"col-span-3 sm:col-span-1"},ye={class:"col-span-3 sm:col-span-1"},ce={class:"col-span-3 sm:col-span-1"},be={class:"col-span-3 sm:col-span-1"},he={key:0,class:"col-span-3 sm:col-span-1"},we={__name:"Filter",props:{initUrl:{type:String,default:""},preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup(U,{emit:O}){const r=G(),A=N(),F=O,x=U,R={type:"",term:"",exam:"",batch:"",students:[],cumulativeAssessment:!1,resultDate:"",column:1,marginTop:0,showOverallTotal:!1,showOverallGrade:!1,showCourseWise:!1,showAllStudent:!1,showSummaryReport:!1,sortSummaryReportByRank:!1},k=C(!1),y=C(!1),o=z(x.initUrl),a=T({...R}),$=T({exams:x.preRequisites.exams,students:[]}),n=T({exam:"",batch:"",students:[],isLoaded:!(r.query.exam||r.query.batch||r.query.students)}),f=async l=>{$.students=[],a.students=[];let t="studying";a.showAllStudent&&(t="all"),k.value=!0,await A.dispatch("student/listAll",{params:{batch:l.uuid,status:t}}).then(w=>{$.students=w,k.value=!1}).catch(w=>{k.value=!1}),n.students=[]},D=()=>{$.students=[],a.students=[],n.students=[]};return L(async()=>{if(_.isEmpty(r.query)){n.isLoaded=!0;return}a.type=r.query.type,n.exam=r.query.exam,a.exam=r.query.exam,n.batch=r.query.batch,a.batch=r.query.batch,r.query.batch&&(await f({uuid:r.query.batch}),a.students=r.query.students?r.query.students.split(","):[]),a.showOverallTotal=S(r.query.showOverallTotal||""),a.showOverallGrade=S(r.query.showOverallGrade||""),a.showCourseWise=S(r.query.showCourseWise||""),a.showAllStudent=S(r.query.showAllStudent||""),a.showSummaryReport=S(r.query.showSummaryReport||""),a.sortSummaryReportByRank=S(r.query.sortSummaryReportByRank||""),a.cumulativeAssessment=S(r.query.cumulativeAssessment||""),n.isLoaded=!0}),(l,t)=>{const w=c("BaseSelect"),W=c("BaseSelectSearch"),b=c("BaseSwitch"),j=c("DatePicker"),E=c("BaseInput"),M=c("BaseFieldset"),I=c("FilterForm");return d(),B(I,{"init-form":R,multiple:["students"],form:a,onHide:t[31]||(t[31]=e=>F("hide"))},{default:i(()=>[n.isLoaded?(d(),g("div",X,[p("div",Y,[u(w,{modelValue:a.type,"onUpdate:modelValue":t[0]||(t[0]=e=>a.type=e),name:"type",label:l.$trans("exam.marksheet.type"),options:U.preRequisites.types,error:s(o).type,"onUpdate:error":t[1]||(t[1]=e=>s(o).type=e)},null,8,["modelValue","label","options","error"])]),a.type=="term_wise"?(d(),g("div",Z,[u(w,{modelValue:a.term,"onUpdate:modelValue":t[2]||(t[2]=e=>a.term=e),name:"term",label:l.$trans("exam.term.term"),options:U.preRequisites.terms,"value-prop":"uuid",error:s(o).term,"onUpdate:error":t[3]||(t[3]=e=>s(o).term=e)},{selectedOption:i(e=>{var h;return[V(m(e.value.name)+" ",1),p("span",P,"("+m(((h=e.value.division)==null?void 0:h.name)||l.$trans("general.all"))+")",1)]}),listOption:i(e=>{var h;return[V(m(e.option.name)+" ",1),p("span",ee,"("+m(((h=e.option.division)==null?void 0:h.name)||l.$trans("general.all"))+")",1)]}),_:1},8,["modelValue","label","options","error"])])):v("",!0),a.type=="exam_wise"||a.type=="exam_wise_default"||a.type=="exam_wise_credit_based"?(d(),g("div",te,[u(w,{modelValue:a.exam,"onUpdate:modelValue":t[4]||(t[4]=e=>a.exam=e),name:"exam",label:l.$trans("exam.exam"),"value-prop":"uuid",options:U.preRequisites.exams,error:s(o).exam,"onUpdate:error":t[5]||(t[5]=e=>s(o).exam=e)},{selectedOption:i(e=>{var h,q;return[V(m(e.value.name)+" ",1),e.value.term?(d(),g("span",ae,"("+m(((q=(h=e.value.term)==null?void 0:h.division)==null?void 0:q.name)||l.$trans("general.all"))+")",1)):v("",!0)]}),listOption:i(e=>{var h,q;return[V(m(e.option.name)+" ",1),e.option.term?(d(),g("span",se,"("+m(((q=(h=e.option.term)==null?void 0:h.division)==null?void 0:q.name)||l.$trans("general.all"))+")",1)):v("",!0)]}),_:1},8,["modelValue","label","options","error"])])):v("",!0),p("div",oe,[n.isLoaded?(d(),B(W,{key:0,name:"batch",label:l.$trans("global.select",{attribute:l.$trans("academic.batch.batch")}),modelValue:a.batch,"onUpdate:modelValue":t[6]||(t[6]=e=>a.batch=e),error:s(o).batch,"onUpdate:error":t[7]||(t[7]=e=>s(o).batch=e),"value-prop":"uuid","init-search":n.batch,"search-key":"course_batch","search-action":"academic/batch/list",onSelected:f,onRemoved:D},{selectedOption:i(e=>[V(m(e.value.course.name)+" "+m(e.value.name),1)]),listOption:i(e=>[V(m(e.option.course.nameWithTerm)+" "+m(e.option.name),1)]),_:1},8,["label","modelValue","error","init-search"])):v("",!0)]),p("div",le,[a.batch?(d(),B(w,{key:0,multiple:"",name:"students",label:l.$trans("global.select",{attribute:l.$trans("student.student")}),options:$.students,modelValue:a.students,"onUpdate:modelValue":t[8]||(t[8]=e=>a.students=e),error:s(o).students,"onUpdate:error":t[9]||(t[9]=e=>s(o).students=e),"track-by":"name","value-prop":"uuid"},{selectedOption:i(e=>[V(m(e.value.name)+" ("+m(e.value.courseName+" "+e.value.batchName)+") ",1)]),listOption:i(e=>[V(m(e.option.name)+" ("+m(e.option.courseName+" "+e.option.batchName)+") ",1)]),_:1},8,["label","options","modelValue","error"])):v("",!0)])])):v("",!0),s(J)(["student","guardian"],"any")?v("",!0):(d(),B(M,{key:1,class:"mt-4"},{legend:i(()=>[p("div",re,[V(m(l.$trans("global.show",{attribute:l.$trans("general.options")}))+" ",1),u(b,{reverse:"",modelValue:y.value,"onUpdate:modelValue":t[10]||(t[10]=e=>y.value=e),name:"showOptions"},null,8,["modelValue"])])]),default:i(()=>[y.value?(d(),g("div",ne,[a.type=="exam_wise"||a.type=="exam_wise_default"?(d(),g("div",ue,[u(b,{vertical:"",modelValue:a.cumulativeAssessment,"onUpdate:modelValue":t[11]||(t[11]=e=>a.cumulativeAssessment=e),name:"showSno",label:l.$trans("exam.marksheet.cumulative_assessment"),error:s(o).cumulativeAssessment,"onUpdate:error":t[12]||(t[12]=e=>s(o).cumulativeAssessment=e)},null,8,["modelValue","label","error"])])):v("",!0),p("div",me,[u(j,{modelValue:a.resultDate,"onUpdate:modelValue":t[13]||(t[13]=e=>a.resultDate=e),name:"resultDate",label:l.$trans("exam.result_date"),"no-clear":"",error:s(o).resultDate,"onUpdate:error":t[14]||(t[14]=e=>s(o).resultDate=e)},null,8,["modelValue","label","error"])]),p("div",ie,[u(b,{vertical:"",modelValue:a.showOverallTotal,"onUpdate:modelValue":t[15]||(t[15]=e=>a.showOverallTotal=e),name:"showOverallTotal",label:l.$trans("exam.marksheet.show_overall_total"),error:s(o).showOverallTotal,"onUpdate:error":t[16]||(t[16]=e=>s(o).showOverallTotal=e)},null,8,["modelValue","label","error"])]),p("div",de,[u(b,{vertical:"",modelValue:a.showOverallGrade,"onUpdate:modelValue":t[17]||(t[17]=e=>a.showOverallGrade=e),name:"showOverallGrade",label:l.$trans("exam.marksheet.show_overall_grade"),error:s(o).showOverallGrade,"onUpdate:error":t[18]||(t[18]=e=>s(o).showOverallGrade=e)},null,8,["modelValue","label","error"])]),p("div",pe,[u(E,{type:"number",modelValue:a.column,"onUpdate:modelValue":t[19]||(t[19]=e=>a.column=e),name:"column",label:l.$trans("print.column"),error:s(o).column,"onUpdate:error":t[20]||(t[20]=e=>s(o).column=e)},null,8,["modelValue","label","error"])]),p("div",ve,[u(E,{"leading-text":l.$trans("list.unit.mm"),type:"number",modelValue:a.marginTop,"onUpdate:modelValue":t[21]||(t[21]=e=>a.marginTop=e),name:"marginTop",label:l.$trans("print.margin_top"),error:s(o).marginTop,"onUpdate:error":t[22]||(t[22]=e=>s(o).marginTop=e)},null,8,["leading-text","modelValue","label","error"])]),p("div",ye,[u(b,{vertical:"",modelValue:a.showCourseWise,"onUpdate:modelValue":t[23]||(t[23]=e=>a.showCourseWise=e),name:"showCourseWise",label:l.$trans("exam.marksheet.course_wise"),error:s(o).showCourseWise,"onUpdate:error":t[24]||(t[24]=e=>s(o).showCourseWise=e)},null,8,["modelValue","label","error"])]),p("div",ce,[u(b,{vertical:"",modelValue:a.showAllStudent,"onUpdate:modelValue":t[25]||(t[25]=e=>a.showAllStudent=e),name:"showAllStudent",label:l.$trans("global.list_all",{attribute:l.$trans("student.student")}),error:s(o).showAllStudent,"onUpdate:error":t[26]||(t[26]=e=>s(o).showAllStudent=e)},null,8,["modelValue","label","error"])]),a.students.length==0?(d(),g(H,{key:1},[p("div",be,[u(b,{vertical:"",modelValue:a.showSummaryReport,"onUpdate:modelValue":t[27]||(t[27]=e=>a.showSummaryReport=e),name:"showSummaryReport",label:l.$trans("exam.marksheet.show_summary_report"),error:s(o).showSummaryReport,"onUpdate:error":t[28]||(t[28]=e=>s(o).showSummaryReport=e)},null,8,["modelValue","label","error"])]),a.showSummaryReport?(d(),g("div",he,[u(b,{vertical:"",modelValue:a.sortSummaryReportByRank,"onUpdate:modelValue":t[29]||(t[29]=e=>a.sortSummaryReportByRank=e),name:"sortSummaryReportByRank",label:l.$trans("exam.marksheet.sort_summary_report_by_rank"),error:s(o).sortSummaryReportByRank,"onUpdate:error":t[30]||(t[30]=e=>s(o).sortSummaryReportByRank=e)},null,8,["modelValue","label","error"])])):v("",!0)],64)):v("",!0)])):v("",!0)]),_:1}))]),_:1},8,["form"])}}},ge={name:"ExamMarksheet"},fe=Object.assign(ge,{setup(U){const O=G(),r=K(),A=N();let F=[],x=[];const R="exam/marksheet/",k=C(!0),y=C(!1),o=T({types:[],terms:[],exams:[]}),a=async()=>{y.value=!0,await A.dispatch(R+"preRequisite").then(n=>{y.value=!1,Object.assign(o,n)}).catch(n=>{y.value=!1})},$=async()=>{y.value=!0,await A.dispatch(R+"fetchReport",{params:O.query}).then(n=>{y.value=!1,window.open("/print").document.write(n)}).catch(n=>{y.value=!1})};return L(async()=>{await a()}),(n,f)=>{const D=c("BaseButton"),l=c("PageHeaderAction"),t=c("PageHeader"),w=c("ParentTransition"),W=c("BaseCard");return d(),g(H,null,[u(t,{title:n.$trans(s(O).meta.label),navs:[{label:n.$trans("exam.exam"),path:"Exam"}]},{default:i(()=>[u(l,{name:"ExamMarksheet",title:n.$trans("exam.marksheet.marksheet"),actions:s(F),"dropdown-actions":s(x),onToggleFilter:f[1]||(f[1]=b=>k.value=!k.value)},{default:i(()=>[s(Q)("exam-marksheet:access")?(d(),B(D,{key:0,design:"white",onClick:f[0]||(f[0]=b=>s(r).push({name:"ExamMarksheetPrint"}))},{default:i(()=>[V(m(n.$trans("global.print",{attribute:n.$trans("exam.marksheet.marksheet")})),1)]),_:1})):v("",!0)]),_:1},8,["title","actions","dropdown-actions"])]),_:1},8,["title","navs"]),u(w,{appear:"",visibility:k.value},{default:i(()=>[u(we,{"is-loading":y.value,onAfterFilter:$,"init-url":R,"pre-requisites":o,onHide:f[2]||(f[2]=b=>k.value=!1)},null,8,["is-loading","pre-requisites"])]),_:1},8,["visibility"]),u(w,{appear:"",visibility:!0},{default:i(()=>[u(W,{"no-padding":"","no-content-padding":"","is-loading":y.value},null,8,["is-loading"])]),_:1})],64)}}});export{fe as default};
