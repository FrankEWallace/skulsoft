import{u as I,i as L,k as T,m as v,I as A,c as H,q as h,K as z,r as d,a as c,o as i,t as y,b as f,e as l,f as a,w as V,F as C,d as m,v as K,x as M,B as G,ap as J,z as Q}from"./app-Cvm44xuh.js";const W={class:"grid grid-cols-3 gap-6"},X={class:"col-span-3 sm:col-span-1"},Y={class:"grid grid-cols-3 gap-6"},Z={class:"col-span-3 sm:col-span-1"},_={key:0,class:"col-span-3 sm:col-span-1"},ee={key:1,class:"col-span-3 sm:col-span-1"},se={class:"col-span-3 sm:col-span-1"},oe={key:2,class:"col-span-3 sm:col-span-1"},te={class:"col-span-3 sm:col-span-1"},ae={class:"col-span-3 sm:col-span-1"},re={name:"StudentEditLogin"},le=Object.assign(re,{props:{student:{type:Object,default(){return{}}}},setup(p){const S=I(),k=L(),q=T("emitter"),B=p,g={username:"",email:"",forceChangePassword:!1,password:"",passwordConfirmation:"",roles:[]},U="student/",j="user/",P=v({}),r=A(U),b=H(()=>{var o,e;return(e=(o=B.student)==null?void 0:o.contact)==null?void 0:e.user}),n=v({isValidated:!1,existingUser:null}),t=v({...g}),F=o=>{Object.assign(P,o)},R=o=>{n.isValidated=!0,n.existingUser=o||null,t.username=o==null?void 0:o.username},O=()=>{q.emit("studentUpdated"),k.push({name:"StudentShowLogin",params:{uuid:B.student.uuid}})};return h(async()=>{var o,e,w;n.isValidated=!!b.value,n.existingUser=b.value,Object.assign(g,{username:(o=b.value)==null?void 0:o.username,email:(e=b.value)==null?void 0:e.email,roles:((w=b.value)==null?void 0:w.roles.map(u=>u.uuid))||[]}),Object.assign(t,z(g))}),(o,e)=>{const w=d("PageHeader"),u=d("BaseInput"),x=d("BaseButton"),$=d("FormAction"),E=d("BaseSelect"),N=d("BaseSwitch"),D=d("ParentTransition");return i(),c(C,null,[p.student.uuid?(i(),y(w,{key:0,title:o.$trans(a(S).meta.trans,{attribute:o.$trans(a(S).meta.label)}),navs:[{label:o.$trans("student.student"),path:"Student"},{label:p.student.contact.name,path:{name:"StudentShow",params:{uuid:p.student.uuid}}}]},null,8,["title","navs"])):f("",!0),l(D,{appear:"",visibility:!0},{default:V(()=>[p.student.uuid?(i(),c(C,{key:0},[n.isValidated?(i(),y($,{key:1,"no-data-fetch":"","pre-requisites":!0,"pre-requisite-url":j,onSetPreRequisites:F,"init-url":U,action:n.existingUser?"updateUser":"createUser","init-form":g,form:t,"after-submit":O},{default:V(()=>[m("div",Y,[m("div",Z,[l(u,{readonly:"",disabled:"",type:"text",modelValue:t.email,"onUpdate:modelValue":e[2]||(e[2]=s=>t.email=s),name:"email",label:o.$trans("contact.login.props.email"),error:a(r).email,"onUpdate:error":e[3]||(e[3]=s=>a(r).email=s)},null,8,["modelValue","label","error"])]),n.existingUser?(i(),c("div",_,[l(u,{readonly:"",disabled:"",type:"text",modelValue:t.username,"onUpdate:modelValue":e[4]||(e[4]=s=>t.username=s),name:"username",label:o.$trans("contact.login.props.username"),error:a(r).username,"onUpdate:error":e[5]||(e[5]=s=>a(r).username=s)},null,8,["modelValue","label","error"])])):f("",!0),n.existingUser?f("",!0):(i(),c("div",ee,[l(u,{type:"text",modelValue:t.username,"onUpdate:modelValue":e[6]||(e[6]=s=>t.username=s),name:"username",label:o.$trans("contact.login.props.username"),error:a(r).username,"onUpdate:error":e[7]||(e[7]=s=>a(r).username=s)},null,8,["modelValue","label","error"])])),G(m("div",se,[l(E,{modelValue:t.roles,"onUpdate:modelValue":e[8]||(e[8]=s=>t.roles=s),name:"roles",label:o.$trans("contact.login.props.role"),options:P.roles,multiple:"","label-prop":"label","value-prop":"uuid",error:a(r).roles,"onUpdate:error":e[9]||(e[9]=s=>a(r).roles=s)},null,8,["modelValue","label","options","error"])],512),[[J,!1]]),n.existingUser&&a(Q)("user:force-change-password")?(i(),c("div",oe,[l(N,{vertical:"",modelValue:t.forceChangePassword,"onUpdate:modelValue":e[10]||(e[10]=s=>t.forceChangePassword=s),name:"forceChangePassword",label:o.$trans("global.change",{attribute:o.$trans("contact.login.props.password")}),error:a(r).forceChangePassword,"onUpdate:error":e[11]||(e[11]=s=>a(r).forceChangePassword=s)},null,8,["modelValue","label","error"])])):f("",!0),!n.existingUser||t.forceChangePassword?(i(),c(C,{key:3},[m("div",te,[l(u,{type:"password",modelValue:t.password,"onUpdate:modelValue":e[12]||(e[12]=s=>t.password=s),name:"password",label:o.$trans("contact.login.props.password"),error:a(r).password,"onUpdate:error":e[13]||(e[13]=s=>a(r).password=s)},null,8,["modelValue","label","error"])]),m("div",ae,[l(u,{type:"password",modelValue:t.passwordConfirmation,"onUpdate:modelValue":e[14]||(e[14]=s=>t.passwordConfirmation=s),name:"passwordConfirmation",label:o.$trans("contact.login.props.password_confirmation"),error:a(r).passwordConfirmation,"onUpdate:error":e[15]||(e[15]=s=>a(r).passwordConfirmation=s)},null,8,["modelValue","label","error"])])],64)):f("",!0)])]),_:1},8,["action","form"])):(i(),y($,{key:0,"no-action-button":"","no-data-fetch":"","init-url":U,action:"confirmUser","init-form":g,form:t,"after-submit":R,"stay-on":"",redirect:{name:"StudentShowLogin",params:{uuid:p.student.uuid}}},{default:V(()=>[m("div",W,[m("div",X,[l(u,{type:"text",modelValue:t.email,"onUpdate:modelValue":e[0]||(e[0]=s=>t.email=s),name:"email",label:o.$trans("contact.login.props.email"),error:a(r).email,"onUpdate:error":e[1]||(e[1]=s=>a(r).email=s)},null,8,["modelValue","label","error"])])]),l(x,{class:"mt-4",type:"submit"},{default:V(()=>[K(M(o.$trans("general.validate")),1)]),_:1})]),_:1},8,["form","redirect"]))],64)):f("",!0)]),_:1})],64)}}});export{le as default};
