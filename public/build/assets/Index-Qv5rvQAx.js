import{u as L,k as x,m as g,I as N,q as P,r as o,t as T,o as y,w as a,d as F,e,j as S,z as V,p as k,a as R,f as h,F as $,y as E,v as m,x as f}from"./app-Cvm44xuh.js";const O={class:"grid grid-cols-3 gap-6"},z={class:"col-span-3 sm:col-span-1"},I={__name:"Filter",props:{initUrl:{type:String,default:""}},emits:["hide"],setup(D,{emit:_}){L(),x("moment");const v=_,w=D,p={startDate:null,endDate:null},n=g({...p});N(w.initUrl);const l=g({isLoaded:!0});return P(async()=>{l.isLoaded=!0}),(d,s)=>{const r=o("DatePicker"),u=o("FilterForm");return y(),T(u,{"init-form":p,multiple:[],form:n,onHide:s[2]||(s[2]=t=>v("hide"))},{default:a(()=>[F("div",O,[F("div",z,[e(r,{start:n.startDate,"onUpdate:start":s[0]||(s[0]=t=>n.startDate=t),end:n.endDate,"onUpdate:end":s[1]||(s[1]=t=>n.endDate=t),name:"dateBetween",as:"range",label:d.$trans("general.date_between")},null,8,["start","end","label"])])])]),_:1},8,["form"])}}},M={name:"LibraryReportTopBorrowedBook"},J=Object.assign(M,{setup(D){const _=L(),v=S();let w=["filter"],p=[];V("library:export")&&(p=["print","pdf","excel"]);const n="library/report/",l=k(!1),d=k(!1),s=g({}),r=g({headers:[],data:[],meta:{total:0}}),u=async()=>{d.value=!0,await v.dispatch(n+"fetchReport",{name:"top-borrowed-book",params:_.query}).then(t=>{d.value=!1,Object.assign(r,t)}).catch(t=>{d.value=!1})};return P(async()=>{await u()}),(t,b)=>{const C=o("PageHeaderAction"),H=o("PageHeader"),B=o("ParentTransition"),c=o("DataCell"),q=o("DataRow"),A=o("DataTable"),U=o("BaseCard");return y(),R($,null,[e(H,{title:t.$trans(h(_).meta.label),navs:[{label:t.$trans("library.library"),path:"Library"},{label:t.$trans("library.report.report"),path:"LibraryReport"}]},{default:a(()=>[e(C,{url:"library/reports/top-borrowed-book/",name:"LibraryReportTopBorrowedBook",title:t.$trans("library.report.top_borrowed_book.top_borrowed_book"),actions:h(w),"dropdown-actions":h(p),headers:r.headers,onToggleFilter:b[0]||(b[0]=i=>l.value=!l.value)},null,8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"]),e(B,{appear:"",visibility:l.value},{default:a(()=>[e(I,{onAfterFilter:u,"init-url":n,"pre-requisites":s,onHide:b[1]||(b[1]=i=>l.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"]),e(B,{appear:"",visibility:!0},{default:a(()=>[e(U,{"no-padding":"","no-content-padding":"","is-loading":d.value},{default:a(()=>[e(A,{header:r.headers,footer:r.footers,meta:r.meta,module:"library.report.top_borrowed_book",onRefresh:u},{default:a(()=>[(y(!0),R($,null,E(r.data,(i,j)=>(y(),T(q,{key:i.uuid},{default:a(()=>[e(c,{name:"sno"},{default:a(()=>[m(f(r.meta.sno+j),1)]),_:2},1024),e(c,{name:"title"},{default:a(()=>[m(f(i.title),1)]),_:2},1024),e(c,{name:"author"},{default:a(()=>[m(f(i.author),1)]),_:2},1024),e(c,{name:"publisher"},{default:a(()=>[m(f(i.publisher),1)]),_:2},1024),e(c,{name:"totalBorrowed"},{default:a(()=>[m(f(i.count),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","footer","meta"])]),_:1},8,["is-loading"])]),_:1})],64)}}});export{J as default};
