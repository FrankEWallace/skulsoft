import{u as h,H as j,m as z,I as pe,c as ie,q as de,r as V,t as L,o as m,w as v,d,b as y,a as b,e as i,f as r,v as A,x as g,F as x,y as ue,J as me,N as ce,K as ye}from"./app-Cvm44xuh.js";import{a as Z,f as ve}from"./currency-B2avElsq.js";const be={class:"grid grid-cols-3 gap-6"},Ve={class:"col-span-3 sm:col-span-3"},ge={class:"col-span-3 sm:col-span-1"},Ue={class:"col-span-3 sm:col-span-1"},$e={class:"col-span-3 sm:col-span-1"},fe={class:"col-span-3 sm:col-span-1"},qe={class:"col-span-3 sm:col-span-1"},ke=["onClick"],_e={class:"mt-4 grid grid-cols-4 gap-4"},Ne={class:"col-span-4 sm:col-span-1"},Be={key:0,class:"col-span-4 sm:col-span-1"},De={key:1,class:"col-span-4 sm:col-span-1"},Te={key:2,class:"col-span-4 sm:col-span-1"},Ae={key:3,class:"col-span-4 sm:col-span-1"},we={class:"col-span-4"},Ie={class:"mt-4 flex justify-end text-lg font-semibold"},Le={class:"mt-4 flex justify-end"},Re={class:"grid grid-cols-3 gap-6"},Fe={class:"col-span-3 sm:col-span-1"},Pe={class:"col-span-3 sm:col-span-1"},Se={class:"col-span-3 sm:col-span-1"},Ee={key:0,class:"col-span-3 sm:col-span-1"},Ce={key:1,class:"col-span-3 sm:col-span-1"},He={key:2,class:"col-span-3 sm:col-span-1"},Me={key:3,class:"col-span-3 sm:col-span-1"},je={class:"grid grid-cols-3 gap-6"},Oe={class:"col-span-3 sm:col-span-1"},ze={key:0,class:"col-span-3 sm:col-span-1"},We={key:1,class:"col-span-3 sm:col-span-1"},Je={key:2,class:"col-span-3 sm:col-span-1"},Ke={key:3,class:"col-span-3 sm:col-span-1"},Ge={class:"grid grid-cols-3 gap-6"},Qe={class:"col-span-3"},Xe={class:"mt-4 grid grid-cols-3 gap-6"},Ye={class:"col-span-3"},Ze={key:4,class:"grid grid-cols-1"},he={class:"col"},xe={name:"ApprovalRequestForm"},et=Object.assign(xe,{setup(ee){const R=h(),q={title:"",type:null,priority:"",nature:"",group:"",dueDate:"",items:[],contact:{name:"",contactNumber:"",email:"",website:"",taxNumber:"",address:{addressLine1:"",addressLine2:"",city:"",state:"",country:"",zipcode:""}},payment:{vendor:null,payee:"",amount:"",invoiceNumber:"",invoiceDate:"",mode:"",details:""},purpose:"",description:"",media:[],mediaUpdated:!1,mediaToken:j(),mediaHash:[]},O={uuid:j(),item:"",quantity:1,unit:"",price:0,amount:0,description:""},S="approval/request/",w=z({types:[],priorities:[],natures:[],groups:[]}),k=z({isLoaded:!R.params.uuid,vendor:""}),n=pe(S),t=z({...q}),te=o=>{Object.assign(w,o)},oe=ie(()=>{var c,$,B,I,f,U;let o=[],e=0;return(($=(c=t.type)==null?void 0:c.category)==null?void 0:$.value)=="item_based"&&((B=t.type)==null?void 0:B.itemBasedType)=="item_with_quantity"?(o=t.items,o.forEach(_=>{e+=Z(_.price*_.quantity)})):((f=(I=t.type)==null?void 0:I.category)==null?void 0:f.value)=="item_based"&&((U=t.type)==null?void 0:U.itemBasedType)=="item_without_quantity"&&(o=t.items,o.forEach(_=>{e+=Z(_.amount)})),ve(e)}),W=()=>{t.items.push({...O,uuid:j()})},ae=async o=>{await ce()&&(t.items.length==1?t.items=[O]:t.items.splice(o,1))},re=()=>{t.mediaToken=j(),t.mediaHash=[]},ne=o=>{var e;((e=o.category)==null?void 0:e.value)=="item_based"&&(t.items=[],W())},se=o=>{t.items=[]},le=o=>{var $,B,I,f,U,_,E,C,H,M,F,P;let e=[],c={};o.type.category.value=="item_based"&&o.type.itemBasedType=="item_with_quantity"?e=o.items.map(D=>({...D,price:D.price.value})):o.type.category.value=="item_based"&&o.type.itemBasedType=="item_without_quantity"?e=o.items.map(D=>({...D,amount:D.amount.value})):o.type.category.value=="payment_based"&&(c={...o.payment,amount:($=o.payment.amount)==null?void 0:$.value,invoiceDate:(B=o.payment.invoiceDate)==null?void 0:B.value}),Object.assign(q,{...o,items:e,payment:c,vendor:(I=o.vendor)==null?void 0:I.uuid,dueDate:(f=o.dueDate)==null?void 0:f.value,type:o.type,priority:(U=o.priority)==null?void 0:U.uuid,nature:(_=o.nature)==null?void 0:_.uuid,group:(E=o.group)==null?void 0:E.uuid}),Object.assign(t,ye(q)),k.vendor=(C=o.vendor)==null?void 0:C.uuid,k.type=(H=o.type)==null?void 0:H.uuid,k.nature=(M=o.nature)==null?void 0:M.uuid,k.group=(F=o.group)==null?void 0:F.uuid,k.priority=(P=o.priority)==null?void 0:P.uuid,k.isLoaded=!0};return de(async()=>{}),(o,e)=>{const c=V("BaseInput"),$=V("BaseSelect"),B=V("DatePicker"),I=V("AutoSuggest"),f=V("BaseTextarea"),U=V("BaseFieldset"),_=V("BaseBadge"),E=V("BaseSelectSearch"),C=V("AddressInput"),H=V("MediaUpload"),M=V("FormAction");return m(),L(M,{"pre-requisites":!0,onSetPreRequisites:te,"init-url":S,"init-form":q,form:t,"set-form":le,redirect:"ApprovalRequest",onResetMediaFiles:re},{default:v(()=>{var F,P,D,J,K,G,Q,X,Y;return[d("div",be,[d("div",Ve,[i(c,{type:"text",modelValue:t.title,"onUpdate:modelValue":e[0]||(e[0]=a=>t.title=a),name:"title",label:o.$trans("approval.request.props.title"),error:r(n).title,"onUpdate:error":e[1]||(e[1]=a=>r(n).title=a),autofocus:""},null,8,["modelValue","label","error"])]),d("div",ge,[i($,{disabled:!!r(R).params.uuid,modelValue:t.type,"onUpdate:modelValue":e[2]||(e[2]=a=>t.type=a),name:"type",label:o.$trans("approval.type.type"),"label-prop":"name","value-prop":"uuid","object-prop":!0,options:w.types,onSelected:ne,onRemoved:se,error:r(n).type,"onUpdate:error":e[3]||(e[3]=a=>r(n).type=a)},{selectedOption:v(a=>{var p;return[A(g(a.value.name)+" ("+g(((p=a.value.department)==null?void 0:p.name)||"-")+") ",1)]}),listOption:v(a=>{var p;return[A(g(a.option.name)+" ("+g(((p=a.option.department)==null?void 0:p.name)||"-")+") ",1)]}),_:1},8,["disabled","modelValue","label","options","error"])]),d("div",Ue,[i($,{modelValue:t.priority,"onUpdate:modelValue":e[4]||(e[4]=a=>t.priority=a),name:"priority",label:o.$trans("approval.request.priority.priority"),"label-prop":"name","value-prop":"uuid",options:w.priorities,error:r(n).priority,"onUpdate:error":e[5]||(e[5]=a=>r(n).priority=a)},null,8,["modelValue","label","options","error"])]),d("div",$e,[i($,{modelValue:t.nature,"onUpdate:modelValue":e[6]||(e[6]=a=>t.nature=a),name:"nature",label:o.$trans("approval.request.nature.nature"),"label-prop":"name","value-prop":"uuid",options:w.natures,error:r(n).nature,"onUpdate:error":e[7]||(e[7]=a=>r(n).nature=a)},null,8,["modelValue","label","options","error"])]),d("div",fe,[i($,{modelValue:t.group,"onUpdate:modelValue":e[8]||(e[8]=a=>t.group=a),name:"group",label:o.$trans("approval.request.group.group"),"label-prop":"name","value-prop":"uuid",options:w.groups,error:r(n).group,"onUpdate:error":e[9]||(e[9]=a=>r(n).group=a)},null,8,["modelValue","label","options","error"])]),d("div",qe,[i(B,{modelValue:t.dueDate,"onUpdate:modelValue":e[10]||(e[10]=a=>t.dueDate=a),name:"dueDate",label:o.$trans("approval.request.props.due_date"),"no-clear":"",error:r(n).dueDate,"onUpdate:error":e[11]||(e[11]=a=>r(n).dueDate=a)},null,8,["modelValue","label","error"])])]),((P=(F=t.type)==null?void 0:F.category)==null?void 0:P.value)=="item_based"?(m(),L(U,{key:0,class:"mt-4"},{legend:v(()=>[A(g(o.$trans("approval.type_approval",{type:o.$trans("approval.categories.item_based")})),1)]),default:v(()=>[(m(!0),b(x,null,ue(t.items,(a,p)=>(m(),L(U,{class:"mt-4",key:a.uuid},{legend:v(()=>[A(g(o.$trans("approval.request.item"))+" "+g(p+1)+". ",1),d("span",{class:"text-danger ml-2 cursor-pointer",onClick:N=>ae(p)},e[49]||(e[49]=[d("i",{class:"fas fa-times-circle"},null,-1)]),8,ke)]),default:v(()=>{var N,T,l,s;return[d("div",_e,[d("div",Ne,[i(c,{modelValue:a.item,"onUpdate:modelValue":u=>a.item=u,name:`items.${p}.item`,label:o.$trans("approval.request.item"),error:r(n)[`items.${p}.item`],"onUpdate:error":u=>r(n)[`items.${p}.item`]=u},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])]),((N=t.type)==null?void 0:N.itemBasedType)=="item_with_quantity"?(m(),b("div",Be,[i(c,{type:"number",modelValue:a.quantity,"onUpdate:modelValue":u=>a.quantity=u,name:`items.${p}.quantity`,label:o.$trans("inventory.stock_item.props.quantity"),error:r(n)[`items.${p}.quantity`],"onUpdate:error":u=>r(n)[`items.${p}.quantity`]=u},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])])):y("",!0),((T=t.type)==null?void 0:T.itemBasedType)=="item_with_quantity"?(m(),b("div",De,[i(I,{type:"text",url:"/app/suggestions/units",modelValue:a.unit,"onUpdate:modelValue":u=>a.unit=u,name:`items.${p}.unit`,label:o.$trans("inventory.stock_item.props.unit"),error:r(n)[`items.${p}.unit`],"onUpdate:error":u=>r(n)[`items.${p}.unit`]=u},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])])):y("",!0),((l=t.type)==null?void 0:l.itemBasedType)=="item_with_quantity"?(m(),b("div",Te,[i(c,{currency:"",modelValue:a.price,"onUpdate:modelValue":u=>a.price=u,name:`items.${p}.price`,label:o.$trans("inventory.stock_item.props.price"),error:r(n)[`items.${p}.price`],"onUpdate:error":u=>r(n)[`items.${p}.price`]=u},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])])):y("",!0),((s=t.type)==null?void 0:s.itemBasedType)=="item_without_quantity"?(m(),b("div",Ae,[i(c,{currency:"",modelValue:a.amount,"onUpdate:modelValue":u=>a.amount=u,name:`items.${p}.amount`,label:o.$trans("inventory.stock_item.props.amount"),error:r(n)[`items.${p}.amount`],"onUpdate:error":u=>r(n)[`items.${p}.amount`]=u},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])])):y("",!0),d("div",we,[i(f,{modelValue:a.description,"onUpdate:modelValue":u=>a.description=u,name:`items.${p}.description`,label:o.$trans("approval.request.props.description"),error:r(n)[`items.${p}.description`],"onUpdate:error":u=>r(n)[`items.${p}.description`]=u},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])])])]}),_:2},1024))),128)),d("div",Ie,g(o.$trans("general.total"))+" "+g(oe.value),1),d("div",Le,[i(_,{design:"primary",onClick:W,class:"cursor-pointer"},{default:v(()=>[A(g(o.$trans("global.add",{attribute:o.$trans("approval.request.item")})),1)]),_:1})])]),_:1})):y("",!0),((J=(D=t.type)==null?void 0:D.category)==null?void 0:J.value)=="payment_based"?(m(),L(U,{key:1,class:"mt-4"},{legend:v(()=>[A(g(o.$trans("approval.type_approval",{type:o.$trans("approval.categories.payment_based")})),1)]),default:v(()=>{var a,p,N,T;return[d("div",Re,[d("div",Fe,[i(E,{name:"vendor",label:o.$trans("global.select",{attribute:o.$trans("inventory.vendor.vendor")}),modelValue:t.vendor,"onUpdate:modelValue":e[12]||(e[12]=l=>t.vendor=l),error:r(n).vendor,"onUpdate:error":e[13]||(e[13]=l=>r(n).vendor=l),"label-prop":"name","value-prop":"uuid","init-search":k.vendor,"search-action":"inventory/vendor/list"},null,8,["label","modelValue","error","init-search"])]),d("div",Pe,[i(c,{type:"text",modelValue:t.payment.payee,"onUpdate:modelValue":e[14]||(e[14]=l=>t.payment.payee=l),name:"paymentPayee",label:o.$trans("finance.transaction.props.payee"),placeholder:o.$trans("finance.transaction.props.payee_detail"),error:r(n).paymentPayee,"onUpdate:error":e[15]||(e[15]=l=>r(n).paymentPayee=l)},null,8,["modelValue","label","placeholder","error"])]),d("div",Se,[i(c,{type:"text",modelValue:t.payment.amount,"onUpdate:modelValue":e[16]||(e[16]=l=>t.payment.amount=l),name:"paymentAmount",label:o.$trans("finance.transaction.props.amount"),error:r(n).paymentAmount,"onUpdate:error":e[17]||(e[17]=l=>r(n).paymentAmount=l)},null,8,["modelValue","label","error"])]),(a=t.type)!=null&&a.enableInvoiceNumber?(m(),b("div",Ee,[i(c,{type:"text",modelValue:t.payment.invoiceNumber,"onUpdate:modelValue":e[18]||(e[18]=l=>t.payment.invoiceNumber=l),name:"invoiceNumber",label:o.$trans("finance.transaction.props.invoice_number"),error:r(n).paymentInvoiceNumber,"onUpdate:error":e[19]||(e[19]=l=>r(n).paymentInvoiceNumber=l)},null,8,["modelValue","label","error"])])):y("",!0),(p=t.type)!=null&&p.enableInvoiceDate?(m(),b("div",Ce,[i(B,{modelValue:t.payment.invoiceDate,"onUpdate:modelValue":e[20]||(e[20]=l=>t.payment.invoiceDate=l),name:"invoiceDate",label:o.$trans("finance.transaction.props.invoice_date"),error:r(n).paymentInvoiceDate,"onUpdate:error":e[21]||(e[21]=l=>r(n).paymentInvoiceDate=l)},null,8,["modelValue","label","error"])])):y("",!0),(N=t.type)!=null&&N.enablePaymentMode?(m(),b("div",He,[i(c,{type:"text",modelValue:t.payment.mode,"onUpdate:modelValue":e[22]||(e[22]=l=>t.payment.mode=l),name:"paymentMode",label:o.$trans("finance.transaction.props.mode"),error:r(n).paymentMode,"onUpdate:error":e[23]||(e[23]=l=>r(n).paymentMode=l)},null,8,["modelValue","label","error"])])):y("",!0),(T=t.type)!=null&&T.enablePaymentDetails?(m(),b("div",Me,[i(f,{modelValue:t.payment.details,"onUpdate:modelValue":e[24]||(e[24]=l=>t.payment.details=l),name:"paymentDetails",label:o.$trans("finance.transaction.props.details"),error:r(n).paymentDetails,"onUpdate:error":e[25]||(e[25]=l=>r(n).paymentDetails=l)},null,8,["modelValue","label","error"])])):y("",!0)])]}),_:1})):y("",!0),((G=(K=t.type)==null?void 0:K.category)==null?void 0:G.value)=="contact_based"?(m(),L(U,{key:2,class:"mt-4"},{legend:v(()=>[A(g(o.$trans("approval.type_approval",{type:o.$trans("approval.categories.contact_based")})),1)]),default:v(()=>{var a,p,N,T,l;return[d("div",je,[d("div",Oe,[i(c,{type:"text",modelValue:t.contact.name,"onUpdate:modelValue":e[26]||(e[26]=s=>t.contact.name=s),name:"contactName",label:o.$trans("contact.props.name"),error:r(n).contactName,"onUpdate:error":e[27]||(e[27]=s=>r(n).contactName=s)},null,8,["modelValue","label","error"])]),(a=t.type)!=null&&a.enableContactNumber?(m(),b("div",ze,[i(c,{type:"text",modelValue:t.contact.contactNumber,"onUpdate:modelValue":e[28]||(e[28]=s=>t.contact.contactNumber=s),name:"contactContactNumber",label:o.$trans("contact.props.contact_number"),error:r(n).contactContactNumber,"onUpdate:error":e[29]||(e[29]=s=>r(n).contactContactNumber=s)},null,8,["modelValue","label","error"])])):y("",!0),(p=t.type)!=null&&p.enableEmail?(m(),b("div",We,[i(c,{modelValue:t.contact.email,"onUpdate:modelValue":e[30]||(e[30]=s=>t.contact.email=s),name:"contactEmail",label:o.$trans("contact.props.email"),error:r(n).contactEmail,"onUpdate:error":e[31]||(e[31]=s=>r(n).contactEmail=s)},null,8,["modelValue","label","error"])])):y("",!0),(N=t.type)!=null&&N.enableWebsite?(m(),b("div",Je,[i(c,{type:"text",modelValue:t.contact.website,"onUpdate:modelValue":e[32]||(e[32]=s=>t.contact.website=s),name:"contactWebsite",label:o.$trans("contact.props.website"),error:r(n).contactWebsite,"onUpdate:error":e[33]||(e[33]=s=>r(n).contactWebsite=s)},null,8,["modelValue","label","error"])])):y("",!0),(T=t.type)!=null&&T.enableTaxNumber?(m(),b("div",Ke,[i(c,{type:"text",modelValue:t.contact.taxNumber,"onUpdate:modelValue":e[34]||(e[34]=s=>t.contact.taxNumber=s),name:"contactTaxNumber",label:o.$trans("contact.props.tax_number"),error:r(n).contactTaxNumber,"onUpdate:error":e[35]||(e[35]=s=>r(n).contactTaxNumber=s)},null,8,["modelValue","label","error"])])):y("",!0),(l=t.type)!=null&&l.enableAddress?(m(),L(C,{key:4,addressLine1:t.contact.address.addressLine1,"onUpdate:addressLine1":e[36]||(e[36]=s=>t.contact.address.addressLine1=s),addressLine2:t.contact.address.addressLine2,"onUpdate:addressLine2":e[37]||(e[37]=s=>t.contact.address.addressLine2=s),city:t.contact.address.city,"onUpdate:city":e[38]||(e[38]=s=>t.contact.address.city=s),state:t.contact.address.state,"onUpdate:state":e[39]||(e[39]=s=>t.contact.address.state=s),zipcode:t.contact.address.zipcode,"onUpdate:zipcode":e[40]||(e[40]=s=>t.contact.address.zipcode=s),country:t.vendor.address.country,"onUpdate:country":e[41]||(e[41]=s=>t.vendor.address.country=s),formErrors:r(n),"onUpdate:formErrors":e[42]||(e[42]=s=>me(n)?n.value=s:null)},null,8,["addressLine1","addressLine2","city","state","zipcode","country","formErrors"])):y("",!0)])]}),_:1})):y("",!0),((X=(Q=t.type)==null?void 0:Q.category)==null?void 0:X.value)=="other"?(m(),L(U,{key:3,class:"mt-4"},{legend:v(()=>[A(g(o.$trans("approval.type_approval",{type:o.$trans("approval.categories.other")})),1)]),default:v(()=>[d("div",Ge,[d("div",Qe,[i(f,{modelValue:t.purpose,"onUpdate:modelValue":e[43]||(e[43]=a=>t.purpose=a),name:"purpose",label:o.$trans("approval.request.props.purpose"),error:r(n).purpose,"onUpdate:error":e[44]||(e[44]=a=>r(n).purpose=a)},null,8,["modelValue","label","error"])])])]),_:1})):y("",!0),d("div",Xe,[d("div",Ye,[i(f,{modelValue:t.description,"onUpdate:modelValue":e[45]||(e[45]=a=>t.description=a),name:"description",label:o.$trans("approval.request.props.description"),error:r(n).description,"onUpdate:error":e[46]||(e[46]=a=>r(n).description=a)},null,8,["modelValue","label","error"])])]),(Y=t.type)!=null&&Y.enableFileUpload?(m(),b("div",Ze,[d("div",he,[i(H,{multiple:"",label:o.$trans("general.file"),module:"approval_request",media:t.media,"media-token":t.mediaToken,onIsUpdated:e[47]||(e[47]=a=>t.mediaUpdated=!0),onSetHash:e[48]||(e[48]=a=>t.mediaHash.push(a))},null,8,["label","media","media-token"])])])):y("",!0)]}),_:1},8,["form"])}}}),tt={name:"ApprovalRequestAction"},rt=Object.assign(tt,{setup(ee){const R=h();return(q,O)=>{const S=V("PageHeaderAction"),w=V("PageHeader"),k=V("ParentTransition");return m(),b(x,null,[i(w,{title:q.$trans(r(R).meta.trans,{attribute:q.$trans(r(R).meta.label)}),navs:[{label:q.$trans("approval.approval"),path:"Approval"}]},{default:v(()=>[i(S,{name:"ApprovalRequest",title:q.$trans("approval.request.request"),actions:["list"]},null,8,["title"])]),_:1},8,["title","navs"]),i(k,{appear:"",visibility:!0},{default:v(()=>[i(et)]),_:1})],64)}}});export{rt as default};
