import{u as L,m as V,I as w,q as C,r as s,t as k,o as g,w as t,d as o,b as D,f as u,v as c,x as r,e as n,i as W,j as R,k as z,p as I,a as S,F as q,y as K,K as G}from"./app-Cvm44xuh.js";const J={class:"grid grid-cols-3 gap-6"},Q={class:"col-span-3 sm:col-span-1"},X={class:"col-span-4 sm:col-span-1"},Y={__name:"FormFilter",props:{initUrl:{type:String,default:""}},emits:["hide"],setup(P,{emit:h}){const B=L(),U=h,p=P,f={batch:"",date:""},l=V({...f}),m=w(p.initUrl),d=V({batch:"",isLoaded:!B.query.batch});return C(async()=>{d.batch=B.query.batch,d.isLoaded=!0}),(v,e)=>{const i=s("BaseSelectSearch"),$=s("DatePicker"),y=s("FilterForm");return g(),k(y,{"init-form":f,form:l,onHide:e[4]||(e[4]=a=>U("hide"))},{default:t(()=>[o("div",J,[o("div",Q,[d.isLoaded?(g(),k(i,{key:0,name:"batch",label:v.$trans("global.select",{attribute:v.$trans("academic.batch.batch")}),modelValue:l.batch,"onUpdate:modelValue":e[0]||(e[0]=a=>l.batch=a),error:u(m).batch,"onUpdate:error":e[1]||(e[1]=a=>u(m).batch=a),"value-prop":"uuid","init-search":d.batch,"search-key":"course_batch","search-action":"academic/batch/list"},{selectedOption:t(a=>[c(r(a.value.course.nameWithTerm)+" "+r(a.value.name),1)]),listOption:t(a=>[c(r(a.option.course.nameWithTerm)+" "+r(a.option.name),1)]),_:1},8,["label","modelValue","error","init-search"])):D("",!0)]),o("div",X,[n($,{modelValue:l.date,"onUpdate:modelValue":e[2]||(e[2]=a=>l.date=a),name:"date",label:v.$trans("student.timesheet.props.date"),"no-clear":"",error:u(m).date,"onUpdate:error":e[3]||(e[3]=a=>u(m).date=a)},null,8,["modelValue","label","error"])])])]),_:1},8,["form"])}}},Z={class:"p-2"},x={class:"divide-y divide-gray-200 dark:divide-gray-700"},ee={class:"grid grid-cols-4 gap-6 px-4 py-2"},te={class:"col-span-4 sm:col-span-1"},ae={class:"col-span-4 sm:col-span-1"},ne={class:"col-span-4 sm:col-span-1"},se={class:"col-span-4 sm:col-span-1"},oe={class:"col-span-4 sm:col-span-1"},re={class:"col-span-4 sm:col-span-1"},le={name:"StudentTimesheetBatch"},ie=Object.assign(le,{setup(P){const h=L(),B=W(),U=R();z("emitter");const p={batch:"",date:"",students:[]},f="student/timesheet/",l=I(!1);V({});const m=w(f),d=V({...p});V({});const v=async()=>{l.value=!0,await U.dispatch(f+"fetch",{params:h.query}).then(e=>{l.value=!1,p.batch=h.query.batch,p.date=h.query.date,p.students=e.data.map(i=>{var $,y;return{...i,inAt:($=i.inAt)==null?void 0:$.at,outAt:(y=i.outAt)==null?void 0:y.at}}),Object.assign(d,G(p))}).catch(e=>{l.value=!1})};return C(async()=>{h.query.batch&&await v()}),(e,i)=>{const $=s("BaseButton"),y=s("PageHeaderAction"),a=s("PageHeader"),H=s("ParentTransition"),N=s("BaseAlert"),F=s("BaseLabel"),j=s("TextMuted"),E=s("BaseDataView"),T=s("DatePicker"),O=s("FormAction"),M=s("BaseCard");return g(),S(q,null,[n(a,{title:e.$trans(u(h).meta.label),navs:[{label:e.$trans("student.student"),path:"Student"},{label:e.$trans("student.attendance.attendance"),path:"StudentAttendance"}]},{default:t(()=>[n(y,null,{default:t(()=>[n($,{design:"primary",onClick:i[0]||(i[0]=_=>u(B).push({name:"StudentAttendance"}))},{default:t(()=>[c(r(e.$trans("student.attendance.attendance")),1)]),_:1})]),_:1})]),_:1},8,["title","navs"]),n(H,{appear:"",visibility:!0},{default:t(()=>[n(Y,{onAfterFilter:v,"init-url":f})]),_:1}),n(M,{"no-padding":"","no-content-padding":"","is-loading":l.value},{title:t(()=>[c(r(e.$trans("global.update",{attribute:e.$trans("student.timesheet.timesheet")})),1)]),action:t(()=>i[1]||(i[1]=[])),default:t(()=>[o("div",Z,[d.students.length==0?(g(),k(N,{key:0,size:"xs",design:"error"},{default:t(()=>[c(r(e.$trans("general.errors.record_not_found")),1)]),_:1})):D("",!0)]),d.students.length?(g(),k(O,{key:0,"no-card":"","button-padding":"","keep-adding":!1,"stay-on":!0,"init-url":f,action:"batchWiseStore","init-form":p,form:d},{default:t(()=>[o("div",x,[o("div",ee,[o("div",te,[n(F,null,{default:t(()=>[c(r(e.$trans("student.student")),1)]),_:1})]),o("div",ae,[n(F,null,{default:t(()=>[c(r(e.$trans("student.timesheet.props.in_at")),1)]),_:1})]),o("div",ne,[n(F,null,{default:t(()=>[c(r(e.$trans("student.timesheet.props.out_at")),1)]),_:1})])]),(g(!0),S(q,null,K(d.students,(_,A)=>(g(),S("div",{class:"grid grid-cols-4 gap-6 px-4 py-2",key:_.uuid},[o("div",se,[n(E,null,{default:t(()=>[c(r(_.name)+" ",1),n(j,{block:""},{default:t(()=>[c(r(_.codeNumber),1)]),_:2},1024)]),_:2},1024)]),o("div",oe,[n(T,{modelValue:_.inAt,"onUpdate:modelValue":b=>_.inAt=b,name:`students.${A}.in_at`,placeholder:e.$trans("student.timesheet.props.in_at"),as:"time",error:u(m)[`students.${A}.inAt`],"onUpdate:error":b=>u(m)[`students.${A}.inAt`]=b},null,8,["modelValue","onUpdate:modelValue","name","placeholder","error","onUpdate:error"])]),o("div",re,[n(T,{modelValue:_.outAt,"onUpdate:modelValue":b=>_.outAt=b,name:`students.${A}.out_at`,placeholder:e.$trans("student.timesheet.props.out_at"),as:"time",error:u(m)[`students.${A}.outAt`],"onUpdate:error":b=>u(m)[`students.${A}.outAt`]=b},null,8,["modelValue","onUpdate:modelValue","name","placeholder","error","onUpdate:error"])])]))),128))])]),_:1},8,["form"])):D("",!0)]),_:1},8,["is-loading"])],64)}}});export{ie as default};
