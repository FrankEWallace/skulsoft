import{i as H,j as N,k as z,c as E,g as f,m as B,q as F,r as v,A as I,a as o,o as r,d as e,f as g,v as c,x as l,t as A,b as n,w as x,e as D,F as q,y as O,B as m,n as R}from"./app-Cvm44xuh.js";import{_ as U,u as G}from"./ShowImages-BG8SVuPv.js";import"./index-Dfe-y4c7.js";const J={class:"max-w-3xl mx-auto px-4 py-8 text-sm"},K={class:"bg-white dark:bg-dark-header rounded-lg shadow-md"},Q={class:"p-6 border-b border-gray-200 dark:border-gray-700"},W={class:"flex items-center justify-between"},X=["src"],Y={class:"flex items-center gap-2 dark:text-gray-300"},Z={class:"flex justify-center items-center p-6"},ee={class:"text-center text-xs border border-gray-300 dark:border-gray-600 rounded-full px-4 py-2 cursor-pointer"},se={key:1,class:"px-4 py-2"},te={class:"p-6"},ae={class:"flex items-center justify-between"},re=["onClick"],oe=["src"],ie={class:"ml-3 dark:text-gray-300"},ne={class:"font-semibold"},le={class:"text-xs text-gray-500 dark:text-gray-400"},de={class:"ml-1"},ce={key:0},ue={key:1},ge={key:2},me={key:0,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},pe={class:"flex items-center gap-2"},_e={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},he=["onClick"],ye=["innerHTML"],fe={key:0},ve=["onClick"],xe={key:0,class:"border-b border-gray-200 dark:border-gray-700"},ke={key:2,class:"text-center py-4"},Be={__name:"Index",setup(be){const p=H(),S=N();z("moment");const T=E(()=>f("layout.display").value=="dark").value?f("assets.iconLight"):f("assets.icon"),d=B({data:[],meta:{}}),i=B({isLoading:!1,nextCursor:null,posts:[],images:[]}),_=async a=>{i.isLoading||(i.isLoading=!0,await S.dispatch("site/post/list",{params:{cursor:a}}).then(s=>{a?d.data=[...d.data,...s.data]:Object.assign(d,s),i.nextCursor=s.meta.nextCursor}).catch(s=>{console.error("Error loading posts:",s)}).finally(()=>{i.isLoading=!1}))},V=a=>{const{scrollTop:s,scrollHeight:h,clientHeight:y}=a.target;h-s-y<50&&i.nextCursor&&!i.isLoading&&_(i.nextCursor)},j=a=>G(new Date(a.replace(" ","T")));return F(()=>{_()}),(a,s)=>{const h=v("BaseLoader"),y=v("BaseAlert"),M=v("BaseBadge"),u=I("tooltip");return r(),o("div",J,[e("div",K,[e("div",Q,[e("div",W,[e("img",{src:g(T),alt:"Logo",class:"h-10"},null,8,X),e("div",Y,[e("span",{class:"text-sm text-gray-500 cursor-pointer",onClick:s[0]||(s[0]=t=>g(p).push({name:"Dashboard"}))},[s[2]||(s[2]=e("i",{class:"fas fa-home mr-1"},null,-1)),c(" "+l(a.$trans("global.go_to",{attribute:a.$trans("dashboard.home")})),1)])])])]),e("div",{onScroll:V},[i.isLoading?(r(),A(h,{key:0},{default:x(()=>[e("div",Z,[e("span",ee,l(a.$trans("general.loading")),1)])]),_:1})):n("",!0),d.data.length==0?(r(),o("div",se,[D(y,{design:"info",size:"xs"},{default:x(()=>[c(l(a.$trans("post.no_posts")),1)]),_:1})])):n("",!0),(r(!0),o(q,null,O(d.data,(t,P)=>{var k,b,C,w,$;return r(),o("div",{key:t.uuid},[e("div",te,[e("div",ae,[e("div",{class:"flex items-center mb-4 cursor-pointer",onClick:L=>g(p).push({name:"SitePostView",params:{uuid:t.uuid}})},[(b=(k=t.user)==null?void 0:k.profile)!=null&&b.avatar?(r(),o("img",{key:0,class:"w-10 h-10 rounded-full",src:(w=(C=t.user)==null?void 0:C.profile)==null?void 0:w.avatar,alt:"User avatar"},null,8,oe)):n("",!0),e("div",ie,[e("h3",ne,[c(l(t.author.name)+" ",1),t.author.detail?(r(),A(M,{key:0,size:"sm"},{default:x(()=>[c(l(t.author.detail),1)]),_:2},1024)):n("",!0)]),e("p",le,[m((r(),o("span",null,[c(l(j(t.createdAt.at)),1)])),[[u,t.createdAt.formatted]]),e("span",de,[t.visibility.value=="public"?m((r(),o("span",ce,s[3]||(s[3]=[e("i",{class:"fas fa-globe-americas"},null,-1)]))),[[u,a.$trans("post.visibilities.public")]]):n("",!0),t.visibility.value=="authenticated"?m((r(),o("span",ue,s[4]||(s[4]=[e("i",{class:"fas fa-users"},null,-1)]))),[[u,a.$trans("post.visibilities.authenticated")]]):n("",!0),t.visibility.value=="private"?m((r(),o("span",ge,s[5]||(s[5]=[e("i",{class:"fas fa-lock"},null,-1)]))),[[u,a.$trans("post.visibilities.private")]]):n("",!0)])]),($=t.team)!=null&&$.uuid?(r(),o("p",me,l(t.team.name),1)):n("",!0)])],8,re),e("div",pe,[t.isPinned?m((r(),o("span",_e,s[6]||(s[6]=[e("i",{class:"fas fa-lg fa-thumbtack"},null,-1)]))),[[u,a.$trans("global.pinned",{attribute:a.$trans("post.post")})]]):n("",!0)])]),e("div",{class:"w-full",onClick:L=>g(p).push({name:"SitePostView",params:{uuid:t.uuid}})},[e("div",{class:"md-content text-gray-800 dark:text-gray-400 cursor-pointer",innerHTML:t.content},null,8,ye),t.hasMore?(r(),o("div",fe,[e("span",{class:"text-xs font-semibold text-gray-700 dark:text-gray-400 cursor-pointer",onClick:L=>g(p).push({name:"SitePostView",params:{uuid:t.uuid}})},l(a.$trans("general.show_more")),9,ve)])):n("",!0)],8,he),D(U,{post:t},null,8,["post"])]),P<d.data.length-1?(r(),o("div",xe)):n("",!0)])}),128)),i.nextCursor&&!i.isLoading?(r(),o("div",ke,[e("span",{class:"text-xs border border-gray-300 dark:border-gray-600 dark:text-gray-400 rounded-full px-4 py-2 cursor-pointer",onClick:s[1]||(s[1]=t=>_(i.nextCursor))},[e("i",{class:R(["fas fa-spinner mr-2",{"animate-spin":i.isLoading}])},null,2),c(" "+l(a.$trans("general.show_more")),1)])])):n("",!0)],32)])])}}};export{Be as default};
