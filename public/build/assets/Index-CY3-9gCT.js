import{u as K,g as ie,m as U,q as re,r as c,t as k,o as y,w as t,d as b,a as M,b as q,e as o,v as u,x as r,f as i,k as O,p as H,I as X,L as G,i as ue,z as h,A as de,F as me,y as pe,B as ce,aj as ge}from"./app-Cvm44xuh.js";import{u as be}from"./useColumnVisibility-BfQRdpHQ.js";import{i as ye,t as fe,a as ve}from"./table-FwhM-Z75.js";const _e={class:"grid grid-cols-3 gap-6"},Ve={class:"col-span-3 sm:col-span-1"},ke={class:"col-span-3 sm:col-span-1"},$e={class:"col-span-3 sm:col-span-1"},qe={class:"col-span-3 sm:col-span-1"},Be={class:"col-span-3 sm:col-span-1"},Te={class:"col-span-3 sm:col-span-1"},Ae={class:"col-span-3 sm:col-span-1"},Re={class:"col-span-3 sm:col-span-1"},Se={class:"col-span-3 sm:col-span-1"},Ce={class:"col-span-3 sm:col-span-1"},Ue={class:"col-span-3 sm:col-span-1"},Ne={class:"col-span-3 sm:col-span-1"},Ie={class:"col-span-3 sm:col-span-1"},he={class:"col-span-3 sm:col-span-1"},De={class:"col-span-3 sm:col-span-1"},we={class:"col-span-3 sm:col-span-1"},Fe={class:"col-span-3 sm:col-span-1"},Oe={class:"col-span-3 sm:col-span-1"},Le={key:0,class:"col-span-3 sm:col-span-1"},je={__name:"Filter",props:{preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup(B,{emit:R}){const v=K(),_=R,S={codeNumber:"",applicationNumber:"",stages:[],enrollmentType:"",name:"",categories:[],contactNumber:"",gender:"",address:"",guardianName:"",courses:[],program:"",department:"",startDate:"",endDate:"",type:"",employees:[],previousInstitute:"",admissionType:""},C=ie("student.enableProvisionalAdmission"),a=U({...S});U({});const V=U({courses:[],categories:[],stages:[],employees:[],isLoaded:!(v.query.courses||v.query.categories||v.query.stages||v.query.employees)});return re(async()=>{V.stages=v.query.stages?v.query.stages.split(","):[],V.courses=v.query.courses?v.query.courses.split(","):[],V.categories=v.query.categories?v.query.categories.split(","):[],V.employees=v.query.employees?v.query.employees.split(","):[],V.program=v.query.program,V.department=v.query.department,V.isLoaded=!0}),(n,s)=>{const m=c("BaseInput"),g=c("BaseSelect"),d=c("BaseLabel"),N=c("BaseRadioGroup"),$=c("BaseSelectSearch"),L=c("DatePicker"),j=c("FilterForm");return y(),k(j,{"init-form":S,form:a,multiple:["courses","categories","stages","employees"],onHide:s[20]||(s[20]=e=>_("hide"))},{default:t(()=>[b("div",_e,[b("div",Ve,[o(m,{type:"text",modelValue:a.codeNumber,"onUpdate:modelValue":s[0]||(s[0]=e=>a.codeNumber=e),name:"codeNumber",label:n.$trans("student.registration.props.code_number")},null,8,["modelValue","label"])]),b("div",ke,[o(m,{type:"text",modelValue:a.applicationNumber,"onUpdate:modelValue":s[1]||(s[1]=e=>a.applicationNumber=e),name:"applicationNumber",label:n.$trans("student.online_registration.props.number")},null,8,["modelValue","label"])]),b("div",$e,[o(g,{multiple:"",modelValue:a.stages,"onUpdate:modelValue":s[2]||(s[2]=e=>a.stages=e),name:"stages",label:n.$trans("student.registration_stage.registration_stage"),options:B.preRequisites.stages,"label-prop":"name","value-prop":"uuid"},null,8,["modelValue","label","options"])]),b("div",qe,[o(g,{modelValue:a.enrollmentType,"onUpdate:modelValue":s[3]||(s[3]=e=>a.enrollmentType=e),name:"enrollmentType",label:n.$trans("student.enrollment_type.enrollment_type"),options:B.preRequisites.enrollmentTypes,"label-prop":"name","value-prop":"uuid"},null,8,["modelValue","label","options"])]),b("div",Be,[o(m,{type:"text",modelValue:a.name,"onUpdate:modelValue":s[4]||(s[4]=e=>a.name=e),name:"name",label:n.$trans("contact.props.name")},null,8,["modelValue","label"])]),b("div",Te,[o(g,{multiple:"",modelValue:a.categories,"onUpdate:modelValue":s[5]||(s[5]=e=>a.categories=e),name:"categories",label:n.$trans("contact.category.category"),options:B.preRequisites.categories,"label-prop":"name","value-prop":"uuid"},null,8,["modelValue","label","options"])]),b("div",Ae,[o(m,{type:"text",modelValue:a.contactNumber,"onUpdate:modelValue":s[6]||(s[6]=e=>a.contactNumber=e),name:"contactNumber",label:n.$trans("contact.props.contact_number")},null,8,["modelValue","label"])]),b("div",Re,[o(d,null,{default:t(()=>[u(r(n.$trans("contact.props.gender")),1)]),_:1}),o(N,{"top-margin":"",options:B.preRequisites.genders,name:"gender",modelValue:a.gender,"onUpdate:modelValue":s[7]||(s[7]=e=>a.gender=e),horizontal:""},null,8,["options","modelValue"])]),b("div",Se,[o(m,{type:"text",modelValue:a.address,"onUpdate:modelValue":s[8]||(s[8]=e=>a.address=e),name:"address",label:n.$trans("contact.props.address.address")},null,8,["modelValue","label"])]),b("div",Ce,[o(m,{type:"text",modelValue:a.guardianName,"onUpdate:modelValue":s[9]||(s[9]=e=>a.guardianName=e),name:"guardianName",label:n.$trans("guardian.props.name")},null,8,["modelValue","label"])]),b("div",Ue,[V.isLoaded?(y(),k($,{key:0,multiple:"",name:"courses",label:n.$trans("global.select",{attribute:n.$trans("academic.course.course")}),modelValue:a.courses,"onUpdate:modelValue":s[10]||(s[10]=e=>a.courses=e),"value-prop":"uuid","init-search":V.courses,"search-action":"academic/course/list"},{selectedOption:t(e=>[u(r(e.value.nameWithTerm),1)]),listOption:t(e=>[u(r(e.option.nameWithTerm),1)]),_:1},8,["label","modelValue","init-search"])):q("",!0)]),b("div",Ne,[V.isLoaded?(y(),k($,{key:0,name:"program",label:n.$trans("global.select",{attribute:n.$trans("academic.program.program")}),modelValue:a.program,"onUpdate:modelValue":s[11]||(s[11]=e=>a.program=e),"value-prop":"uuid","label-prop":"name","init-search":V.program,"search-action":"academic/program/list"},null,8,["label","modelValue","init-search"])):q("",!0)]),b("div",Ie,[V.isLoaded?(y(),k($,{key:0,name:"department",label:n.$trans("global.select",{attribute:n.$trans("academic.department.department")}),modelValue:a.department,"onUpdate:modelValue":s[12]||(s[12]=e=>a.department=e),"value-prop":"uuid","label-prop":"name","init-search":V.department,"search-action":"academic/department/list"},null,8,["label","modelValue","init-search"])):q("",!0)]),b("div",he,[o(L,{start:a.startDate,"onUpdate:start":s[13]||(s[13]=e=>a.startDate=e),end:a.endDate,"onUpdate:end":s[14]||(s[14]=e=>a.endDate=e),name:"dateBetween",as:"range",label:n.$trans("general.date_between")},null,8,["start","end","label"])]),b("div",De,[o(g,{modelValue:a.status,"onUpdate:modelValue":s[15]||(s[15]=e=>a.status=e),name:"status",label:n.$trans("student.registration.props.status"),options:B.preRequisites.statuses},null,8,["modelValue","label","options"])]),b("div",we,[o(g,{modelValue:a.type,"onUpdate:modelValue":s[16]||(s[16]=e=>a.type=e),name:"type",label:n.$trans("student.registration.props.type"),options:B.preRequisites.types},null,8,["modelValue","label","options"])]),b("div",Fe,[V.isLoaded?(y(),k($,{key:0,multiple:"",name:"employees",label:n.$trans("student.registration.props.assigned_to"),modelValue:a.employees,"onUpdate:modelValue":s[17]||(s[17]=e=>a.employees=e),"value-prop":"uuid","init-search":V.employees,"search-key":"name","search-action":"employee/list"},{selectedOption:t(e=>[u(r(e.value.name)+" ("+r(e.value.codeNumber)+") ",1)]),listOption:t(e=>[u(r(e.option.name)+" ("+r(e.option.codeNumber)+") ",1)]),_:1},8,["label","modelValue","init-search"])):q("",!0)]),b("div",Oe,[o(m,{type:"text",modelValue:a.previousInstitute,"onUpdate:modelValue":s[18]||(s[18]=e=>a.previousInstitute=e),name:"previousInstitute",label:n.$trans("student.qualification.props.previous_institute")},null,8,["modelValue","label"])]),i(C)?(y(),M("div",Le,[o(g,{modelValue:a.admissionType,"onUpdate:modelValue":s[19]||(s[19]=e=>a.admissionType=e),name:"admissionType",label:n.$trans("student.admission.props.type"),options:B.preRequisites.admissionTypes},null,8,["modelValue","label","options"])])):q("",!0)])]),_:1},8,["form"])}}},Pe={class:"grid grid-cols-3 gap-6"},Ee={class:"col-span-3 sm:col-span-1"},Me={name:"StudentRegistrationUpdateBulkStage"},He=Object.assign(Me,{props:{selected:{type:Object,required:!0},selectAll:{type:Boolean,required:!0},selectedRegistrations:{type:Array,required:!0},preRequisites:{type:Object,required:!0}},emits:["completed"],setup(B,{emit:R}){const v=O("emitter"),_=R,S=B,C={stage:"",selectAll:!1,registrations:[]},a="student/registration/";H(!1);const V=X(a),n=U({...C}),s=async()=>{n.selectAll=!1,v.emit("listItems"),_("completed")};return G([()=>S.selectAll,()=>S.selectedRegistrations],([m,g])=>{n.selectAll=m,n.registrations=g},{immediate:!0}),(m,g)=>{const d=c("BaseSelect"),N=c("FormAction");return y(),k(N,{"no-card":"","keep-adding":!1,"init-url":a,action:"updateBulkStage","init-form":C,form:n,"after-submit":s},{default:t(()=>[b("div",Pe,[b("div",Ee,[o(d,{name:"stage",label:m.$trans("global.select",{attribute:m.$trans("student.registration_stage.registration_stage")}),modelValue:n.stage,"onUpdate:modelValue":g[0]||(g[0]=$=>n.stage=$),error:i(V).stage,"onUpdate:error":g[1]||(g[1]=$=>i(V).stage=$),options:B.preRequisites.stages,"label-prop":"name","value-prop":"uuid"},null,8,["label","modelValue","error","options"])])])]),_:1},8,["form"])}}}),Ge={class:"grid grid-cols-3 gap-6"},We={class:"col-span-3 sm:col-span-1"},ze={name:"StudentRegistrationUpdateBulkAssignTo"},Qe=Object.assign(ze,{props:{selected:{type:Object,required:!0},selectAll:{type:Boolean,required:!0},selectedRegistrations:{type:Array,required:!0}},emits:["completed"],setup(B,{emit:R}){const v=O("emitter"),_=R,S=B,C={employee:"",selectAll:!1,registrations:[]},a="student/registration/";H(!1);const V=X(a),n=U({...C}),s=async()=>{n.selectAll=!1,v.emit("listItems"),_("completed")};return G([()=>S.selectAll,()=>S.selectedRegistrations],([m,g])=>{n.selectAll=m,n.registrations=g},{immediate:!0}),(m,g)=>{const d=c("BaseSelectSearch"),N=c("FormAction");return y(),k(N,{"no-card":"","keep-adding":!1,"init-url":a,action:"updateBulkAssignTo","init-form":C,form:n,"after-submit":s},{default:t(()=>[b("div",Ge,[b("div",We,[o(d,{name:"employee",label:m.$trans("student.registration.props.assigned_to"),placeholder:m.$trans("global.select",{attribute:m.$trans("employee.employee")}),modelValue:n.employee,"onUpdate:modelValue":g[0]||(g[0]=$=>n.employee=$),error:i(V).employee,"onUpdate:error":g[1]||(g[1]=$=>i(V).employee=$),"value-prop":"uuid","search-key":"name","search-action":"employee/summary"},{selectedOption:t($=>[u(r($.value.name)+" ("+r($.value.designation)+") ",1)]),listOption:t($=>[u(r($.option.name)+" ("+r($.option.designation)+") ",1)]),_:1},8,["label","placeholder","modelValue","error"])])])]),_:1},8,["form"])}}}),Je=["onClick"],Ke={class:"mt-8 px-4 pb-4"},Xe={name:"StudentRegistrationList"},et=Object.assign(Xe,{setup(B){K();const R=ue(),v=O("emitter"),_=O("$trans"),{applyVisibility:S}=be("Registration");let C=["filter"];h("registration:create")&&C.unshift("create");let a=[];h("registration:export")&&(a=["print","pdf","excel"]);const V="student/registration/",n=U({statuses:[]}),s=H(!1),m=U({selectAll:!1,selectedRegistrations:[],activeTab:"updateAssignTo"}),g=U({}),d=U({...ye}),N=A=>{A.headers=S(A.headers),Object.assign(g,A),d.pageItems=g.data.map(p=>p.uuid)},$=()=>{d.items=[],d.pageItems=[],d.all=!1},L=A=>{Object.assign(n,A)},j=A=>{A=="delete"&&v.emit("deleteItems",{global:d.global,uuids:d.items})},e=A=>{let p="/app/student/registrations/"+A.uuid+"/export",w={};window.open(ge(p,w),"_blank").focus()};return G(()=>[d.items,d.pageItems],([A,p],[w,W])=>{m.selectedRegistrations=A,d.all=ve(d)}),(A,p)=>{const w=c("PageHeaderAction"),W=c("PageHeader"),P=c("ParentTransition"),Y=c("BaseArrayCheckbox"),Z=c("BaseCheckbox"),T=c("DataCell"),I=c("TextMuted"),E=c("BaseBadge"),F=c("FloatingMenuItem"),x=c("FloatingMenu"),ee=c("DataRow"),te=c("BaseButton"),se=c("DataTable"),z=c("TabItem"),ae=c("TabGroup"),oe=c("BaseCard"),le=c("ListItem"),ne=de("tooltip");return y(),k(le,{"init-url":V,"pre-requisites":!0,onSetPreRequisites:L,onSetItems:N},{header:t(()=>[o(W,{title:i(_)("student.registration.registration"),navs:[{label:i(_)("student.student"),path:"Student"}]},{default:t(()=>[o(w,{url:"student/registrations/",name:"StudentRegistration",title:i(_)("student.registration.registration"),actions:i(C),"bulk-actions":[{name:"delete",label:i(_)("general.delete"),icon:"fas fa-trash"}],"show-bulk-action":d.items.length>0||d.global,"dropdown-actions":i(a),headers:g.headers,onToggleFilter:p[0]||(p[0]=l=>s.value=!s.value),onOnBulkAction:j},null,8,["title","actions","bulk-actions","show-bulk-action","dropdown-actions","headers"])]),_:1},8,["title","navs"])]),filter:t(()=>[o(P,{appear:"",visibility:s.value},{default:t(()=>[o(je,{onRefresh:p[1]||(p[1]=l=>i(v).emit("listItems")),"pre-requisites":n,onHide:p[2]||(p[2]=l=>s.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"])]),default:t(()=>[o(P,{appear:"",visibility:!0},{default:t(()=>[o(se,{onToggleSelectAll:p[6]||(p[6]=l=>d.items=i(fe)(l,d)),onToggleGlobalSelect:p[7]||(p[7]=l=>d.global=!d.global),selected:d,header:g.headers,meta:g.meta,module:"student.registration",onRefresh:p[8]||(p[8]=l=>i(v).emit("listItems"))},{actionButton:t(()=>[i(h)("registration:create")?(y(),k(te,{key:0,onClick:p[5]||(p[5]=l=>i(R).push({name:"StudentRegistrationCreate"}))},{default:t(()=>[u(r(i(_)("global.add",{attribute:i(_)("student.registration.registration")})),1)]),_:1})):q("",!0)]),default:t(()=>[(y(!0),M(me,null,pe(g.data,l=>(y(),k(ee,{key:l.uuid,onDoubleClick:f=>i(R).push({name:"StudentRegistrationShow",params:{uuid:l.uuid}})},{default:t(()=>[o(T,{name:"selectAll"},{default:t(()=>[d.global?q("",!0):(y(),k(Y,{key:0,items:d.items,"onUpdate:items":p[3]||(p[3]=f=>d.items=f),value:l.uuid},null,8,["items","value"])),d.global?(y(),k(Z,{key:1,modelValue:d.global,"onUpdate:modelValue":p[4]||(p[4]=f=>d.global=f)},null,8,["modelValue"])):q("",!0)]),_:2},1024),o(T,{name:"codeNumber"},{default:t(()=>[u(r(l.codeNumber)+" ",1),l.isConverted?ce((y(),M("span",{key:0,class:"cursor-pointer",onClick:f=>i(R).push({name:"ReceptionEnquiryShow",params:{uuid:l.enquiry.uuid}})},p[11]||(p[11]=[b("i",{class:"fas fa-reply"},null,-1)]),8,Je)),[[ne,i(_)("student.registration.converted_from_enquiry")]]):q("",!0),o(I,{block:""},{default:t(()=>[u(r(l.period.name),1)]),_:2},1024),o(I,{block:""},{default:t(()=>[u(r(l.admissionDate.formatted),1)]),_:2},1024),l.isOnline?(y(),k(E,{key:1},{default:t(()=>[u(r(i(_)("student.registration.online")),1)]),_:1})):q("",!0)]),_:2},1024),o(T,{name:"name"},{default:t(()=>[u(r(l.contact.name)+" ",1),o(I,{block:""},{default:t(()=>[u(r(l.contact.contactNumber),1)]),_:2},1024)]),_:2},1024),o(T,{name:"guardianName"},{default:t(()=>{var f,D;return[u(r(((D=(f=l.contact.guardian)==null?void 0:f.contact)==null?void 0:D.name)||"-")+" ",1),o(I,{block:""},{default:t(()=>{var Q,J;return[u(r(((J=(Q=l.contact.guardian)==null?void 0:Q.contact)==null?void 0:J.contactNumber)||""),1)]}),_:2},1024)]}),_:2},1024),o(T,{name:"birthDate"},{default:t(()=>[u(r(l.contact.birthDate.formatted),1)]),_:2},1024),o(T,{name:"course"},{default:t(()=>{var f;return[u(r(((f=l.course)==null?void 0:f.nameWithTerm)||"-")+" ",1),l.batchName?(y(),k(I,{key:0,block:""},{default:t(()=>[u(r(l.batchName),1)]),_:2},1024)):q("",!0)]}),_:2},1024),o(T,{name:"enrollmentType"},{default:t(()=>{var f;return[u(r(((f=l.enrollmentType)==null?void 0:f.name)||"-")+" ",1),l.isProvisional?(y(),k(E,{key:0},{default:t(()=>[u(r(i(_)("student.admission.provisional_admission")),1)]),_:1})):q("",!0)]}),_:2},1024),o(T,{name:"stage"},{default:t(()=>{var f;return[u(r(((f=l.stage)==null?void 0:f.name)||"-"),1)]}),_:2},1024),o(T,{name:"status"},{default:t(()=>[o(E,{design:l.status.color},{default:t(()=>[u(r(l.status.label),1)]),_:2},1032,["design"])]),_:2},1024),o(T,{name:"date"},{default:t(()=>[u(r(l.date.formatted)+" ",1),l.isOnline?(y(),k(I,{key:0,block:""},{default:t(()=>[u(r(l.applicationNumber),1)]),_:2},1024)):q("",!0)]),_:2},1024),o(T,{name:"employee"},{default:t(()=>{var f;return[u(r(((f=l.employee)==null?void 0:f.name)||"-")+" ",1),l.employee?(y(),k(I,{key:0,block:""},{default:t(()=>{var D;return[u(r(((D=l.employee)==null?void 0:D.designation)||"-"),1)]}),_:2},1024)):q("",!0)]}),_:2},1024),o(T,{name:"createdAt"},{default:t(()=>[u(r(l.createdAt.formatted),1)]),_:2},1024),o(T,{name:"action"},{default:t(()=>[o(x,null,{default:t(()=>[o(F,{icon:"fas fa-arrow-circle-right",onClick:f=>i(R).push({name:"StudentRegistrationShow",params:{uuid:l.uuid}})},{default:t(()=>[u(r(i(_)("general.show")),1)]),_:2},1032,["onClick"]),o(F,{icon:"fas fa-print",onClick:f=>e(l)},{default:t(()=>[u(r(i(_)("global.print",{attribute:i(_)("student.registration.registration")})),1)]),_:2},1032,["onClick"]),i(h)("registration:edit")&&l.isEditable?(y(),k(F,{key:0,icon:"fas fa-edit",onClick:f=>i(R).push({name:"StudentRegistrationWizard",params:{uuid:l.uuid}})},{default:t(()=>[u(r(i(_)("general.edit")),1)]),_:2},1032,["onClick"])):q("",!0),i(h)("registration:delete")&&l.isEditable?(y(),k(F,{key:1,icon:"fas fa-trash",onClick:f=>i(v).emit("deleteItem",{uuid:l.uuid})},{default:t(()=>[u(r(i(_)("general.delete")),1)]),_:2},1032,["onClick"])):q("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onDoubleClick"]))),128))]),_:1},8,["selected","header","meta"])]),_:1}),d.items.length>0&&i(h)("registration:edit")?(y(),k(P,{key:0,appear:"",visibility:!0},{default:t(()=>[o(oe,{class:"mt-4","no-padding":"","no-content-padding":""},{title:t(()=>[u(r(i(_)("general.action")),1)]),default:t(()=>[o(ae,null,{default:t(()=>[o(z,{first:"",label:i(_)("student.registration.props.assigned_to"),onClick:p[9]||(p[9]=l=>m.activeTab="updateAssignTo"),"is-active":m.activeTab=="updateAssignTo"},null,8,["label","is-active"]),o(z,{label:i(_)("student.registration_stage.registration_stage"),onClick:p[10]||(p[10]=l=>m.activeTab="updateStage"),"is-active":m.activeTab=="updateStage"},null,8,["label","is-active"])]),_:1}),b("div",Ke,[m.activeTab=="updateAssignTo"?(y(),k(Qe,{key:0,selected:d,"select-all":m.selectAll,"selected-registrations":m.selectedRegistrations,onCompleted:$},null,8,["selected","select-all","selected-registrations"])):q("",!0),m.activeTab=="updateStage"?(y(),k(He,{key:1,selected:d,"select-all":m.selectAll,"selected-registrations":m.selectedRegistrations,onCompleted:$,"pre-requisites":n},null,8,["selected","select-all","selected-registrations","pre-requisites"])):q("",!0)])]),_:1})]),_:1})):q("",!0)]),_:1})}}});export{et as default};
