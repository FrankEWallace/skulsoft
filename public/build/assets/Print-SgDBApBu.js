import{u as O,j as R,p as U,I as T,m as P,q as L,ai as H,r as u,t as S,o as d,w as i,a as p,b as m,d as A,e as l,f as s,v,x as b,C as I,i as j,F as D}from"./app-Cvm44xuh.js";const E={key:0,class:"grid grid-cols-3 gap-6"},M={class:"col-span-3 sm:col-span-1"},W={key:0,class:"col-span-3 sm:col-span-1"},z={key:1,class:"col-span-3 sm:col-span-1"},G={key:2,class:"col-span-3 sm:col-span-1"},J={key:3,class:"col-span-3 sm:col-span-1"},K={class:"flex items-center gap-2"},Q={key:0,class:"grid grid-cols-3 gap-6"},X={key:0,class:"col-span-3 sm:col-span-1"},Y={class:"col-span-3 sm:col-span-1"},Z={class:"col-span-3 sm:col-span-1"},x={__name:"Filter",props:{initUrl:{type:String,default:""},preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup(k,{emit:V}){const F=O();R();const h=V,w=k,_={template:"",codeNumber:"",batch:"",department:"",showAllStudent:!1,column:1,cardPerPage:2};U(!1);const f=U(!1),n=T(w.initUrl),o=P({..._}),r=P({for:null}),c=P({isLoaded:!0}),C=a=>{a=w.preRequisites.templates.find(e=>e.value===a),r.for=a==null?void 0:a.for};return L(async()=>{o.showAllStudent=H(F.query.showAllStudent||""),c.isLoaded=!0}),(a,e)=>{const q=u("BaseSelect"),$=u("BaseSelectSearch"),g=u("BaseInput"),y=u("BaseSwitch"),N=u("BaseFieldset"),B=u("FilterForm");return d(),S(B,{"init-form":_,multiple:[],form:o,onHide:e[14]||(e[14]=t=>h("hide"))},{default:i(()=>[c.isLoaded?(d(),p("div",E,[A("div",M,[l(q,{modelValue:o.template,"onUpdate:modelValue":e[0]||(e[0]=t=>o.template=t),options:k.preRequisites.templates,label:a.$trans("academic.id_card.template.template"),error:s(n).template,onChange:C},null,8,["modelValue","options","label","error"])]),r.for=="student"||r.for=="guardian"?(d(),p("div",W,[c.isLoaded?(d(),S($,{key:0,name:"batch",label:a.$trans("global.select",{attribute:a.$trans("academic.batch.batch")}),modelValue:o.batch,"onUpdate:modelValue":e[1]||(e[1]=t=>o.batch=t),error:s(n).batch,"onUpdate:error":e[2]||(e[2]=t=>s(n).batch=t),"value-prop":"uuid","init-search":c.batch,"search-key":"course_batch","search-action":"academic/batch/list"},{selectedOption:i(t=>[v(b(t.value.course.name)+" "+b(t.value.name),1)]),listOption:i(t=>[v(b(t.option.course.nameWithTerm)+" "+b(t.option.name),1)]),_:1},8,["label","modelValue","error","init-search"])):m("",!0)])):m("",!0),r.for=="employee"?(d(),p("div",z,[c.isLoaded?(d(),S($,{key:0,name:"batch",label:a.$trans("global.select",{attribute:a.$trans("employee.department.department")}),modelValue:o.department,"onUpdate:modelValue":e[3]||(e[3]=t=>o.department=t),error:s(n).department,"onUpdate:error":e[4]||(e[4]=t=>s(n).department=t),"value-prop":"uuid","init-search":c.batch,"search-key":"name","search-action":"employee/department/list"},{selectedOption:i(t=>[v(b(t.value.name),1)]),listOption:i(t=>[v(b(t.option.name),1)]),_:1},8,["label","modelValue","error","init-search"])):m("",!0)])):m("",!0),r.for=="student"||r.for=="guardian"?(d(),p("div",G,[l(g,{modelValue:o.codeNumber,"onUpdate:modelValue":e[5]||(e[5]=t=>o.codeNumber=t),label:a.$trans("student.admission.props.code_number"),error:s(n).codeNumber},null,8,["modelValue","label","error"])])):m("",!0),r.for=="employee"?(d(),p("div",J,[l(g,{modelValue:o.codeNumber,"onUpdate:modelValue":e[6]||(e[6]=t=>o.codeNumber=t),label:a.$trans("employee.props.code_number"),error:s(n).codeNumber},null,8,["modelValue","label","error"])])):m("",!0)])):m("",!0),c.isLoaded&&!s(I)(["student","guardian"],"any")?(d(),S(N,{key:1,class:"mt-4"},{legend:i(()=>[A("div",K,[v(b(a.$trans("global.show",{attribute:a.$trans("general.options")}))+" ",1),l(y,{reverse:"",modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=t=>f.value=t),name:"showOptions"},null,8,["modelValue"])])]),default:i(()=>[f.value?(d(),p("div",Q,[r.for=="student"||r.for=="guardian"?(d(),p("div",X,[l(y,{vertical:"",modelValue:o.showAllStudent,"onUpdate:modelValue":e[8]||(e[8]=t=>o.showAllStudent=t),name:"showAllStudent",label:a.$trans("global.list_all",{attribute:a.$trans("student.student")}),error:s(n).showAllStudent,"onUpdate:error":e[9]||(e[9]=t=>s(n).showAllStudent=t)},null,8,["modelValue","label","error"])])):m("",!0),A("div",Y,[l(g,{type:"number",modelValue:o.column,"onUpdate:modelValue":e[10]||(e[10]=t=>o.column=t),name:"column",label:a.$trans("print.column"),error:s(n).column,"onUpdate:error":e[11]||(e[11]=t=>s(n).column=t)},null,8,["modelValue","label","error"])]),A("div",Z,[l(g,{type:"number",modelValue:o.cardPerPage,"onUpdate:modelValue":e[12]||(e[12]=t=>o.cardPerPage=t),name:"cardPerPage",label:a.$trans("academic.id_card.card_per_page"),error:s(n).cardPerPage,"onUpdate:error":e[13]||(e[13]=t=>s(n).cardPerPage=t)},null,8,["modelValue","label","error"])])])):m("",!0)]),_:1})):m("",!0)]),_:1},8,["form"])}}},ee={name:"AcademicIdCard"},ae=Object.assign(ee,{setup(k){const V=O(),F=j(),h=R();let w=[],_=[];const f="academic/idCard/",n=U(!0),o=U(!1),r=P({templates:[]}),c=async()=>{o.value=!0,await h.dispatch(f+"printPreRequisite").then(a=>{o.value=!1,Object.assign(r,a)}).catch(a=>{o.value=!1})},C=async()=>{o.value=!0,await h.dispatch(f+"print",{params:V.query}).then(a=>{o.value=!1,window.open("/print").document.write(a)}).catch(a=>{o.value=!1})};return L(async()=>{await c()}),(a,e)=>{const q=u("BaseButton"),$=u("PageHeaderAction"),g=u("PageHeader"),y=u("ParentTransition"),N=u("BaseCard");return d(),p(D,null,[l(g,{title:a.$trans(s(V).meta.label),navs:[{label:a.$trans("academic.academic"),path:"Academic"}]},{default:i(()=>[l($,{name:"AcademicIdCard",title:a.$trans("academic.id-card.id-card"),actions:s(w),"dropdown-actions":s(_),onToggleFilter:e[1]||(e[1]=B=>n.value=!n.value)},{default:i(()=>[l(q,{design:"white",onClick:e[0]||(e[0]=B=>s(F).push({name:"AcademicIdCardTemplate"}))},{default:i(()=>[v(b(a.$trans("academic.id_card.template.template")),1)]),_:1})]),_:1},8,["title","actions","dropdown-actions"])]),_:1},8,["title","navs"]),l(y,{appear:"",visibility:n.value},{default:i(()=>[l(x,{"is-loading":o.value,onAfterFilter:C,"init-url":f,"pre-requisites":r,onHide:e[2]||(e[2]=B=>n.value=!1)},null,8,["is-loading","pre-requisites"])]),_:1},8,["visibility"]),l(y,{appear:"",visibility:!0},{default:i(()=>[l(N,{"no-padding":"","no-content-padding":"","is-loading":o.value},null,8,["is-loading"])]),_:1})],64)}}});export{ae as default};
