import{u as D,i as I,k as L,m as v,I as T,c as A,q as H,K as h,r as d,a as c,o as i,t as y,b as g,e as l,f as r,w as V,F as C,d as m,v as z,x as K,B as M,ap as J,z as Q}from"./app-Cvm44xuh.js";const W={class:"grid grid-cols-3 gap-6"},X={class:"col-span-3 sm:col-span-1"},Y={class:"grid grid-cols-3 gap-6"},Z={class:"col-span-3 sm:col-span-1"},_={key:0,class:"col-span-3 sm:col-span-1"},ee={key:1,class:"col-span-3 sm:col-span-1"},ae={class:"col-span-3 sm:col-span-1"},se={key:2,class:"col-span-3 sm:col-span-1"},oe={class:"col-span-3 sm:col-span-1"},re={class:"col-span-3 sm:col-span-1"},ne={name:"GuardianEditLogin"},le=Object.assign(ne,{props:{guardian:{type:Object,default(){return{}}}},setup(p){const B=D(),S=I(),q=L("emitter"),P=p,f={username:"",email:"",forceChangePassword:!1,password:"",passwordConfirmation:"",roles:[]},U="guardian/",j="user/",$=v({}),n=T(U),b=A(()=>{var s,e;return(e=(s=P.guardian)==null?void 0:s.contact)==null?void 0:e.user}),t=v({isValidated:!1,existingUser:null}),o=v({...f}),F=s=>{Object.assign($,s)},R=s=>{t.isValidated=!0,t.existingUser=s||null,o.username=s==null?void 0:s.username},G=()=>{q.emit("guardianUpdated"),S.push({name:"GuardianShowLogin",params:{uuid:P.guardian.uuid}})};return H(async()=>{var s,e,w;t.isValidated=!!b.value,t.existingUser=b.value,Object.assign(f,{username:(s=b.value)==null?void 0:s.username,email:(e=b.value)==null?void 0:e.email,roles:((w=b.value)==null?void 0:w.roles.map(u=>u.uuid))||[]}),Object.assign(o,h(f))}),(s,e)=>{const w=d("PageHeader"),u=d("BaseInput"),O=d("BaseButton"),k=d("FormAction"),x=d("BaseSelect"),E=d("BaseSwitch"),N=d("ParentTransition");return i(),c(C,null,[p.guardian.uuid?(i(),y(w,{key:0,title:s.$trans(r(B).meta.trans,{attribute:s.$trans(r(B).meta.label)}),navs:[{label:s.$trans("guardian.guardian"),path:"Guardian"},{label:p.guardian.contact.name,path:{name:"GuardianShow",params:{uuid:p.guardian.uuid}}}]},null,8,["title","navs"])):g("",!0),l(N,{appear:"",visibility:!0},{default:V(()=>[p.guardian.uuid?(i(),c(C,{key:0},[t.isValidated?(i(),y(k,{key:1,"no-data-fetch":"","pre-requisites":!0,"pre-requisite-url":j,onSetPreRequisites:F,"init-url":U,action:t.existingUser?"updateUser":"createUser","init-form":f,form:o,"after-submit":G},{default:V(()=>[m("div",Y,[m("div",Z,[l(u,{readonly:"",disabled:"",type:"text",modelValue:o.email,"onUpdate:modelValue":e[2]||(e[2]=a=>o.email=a),name:"email",label:s.$trans("contact.login.props.email"),error:r(n).email,"onUpdate:error":e[3]||(e[3]=a=>r(n).email=a)},null,8,["modelValue","label","error"])]),t.existingUser?(i(),c("div",_,[l(u,{readonly:"",disabled:"",type:"text",modelValue:o.username,"onUpdate:modelValue":e[4]||(e[4]=a=>o.username=a),name:"username",label:s.$trans("contact.login.props.username"),error:r(n).username,"onUpdate:error":e[5]||(e[5]=a=>r(n).username=a)},null,8,["modelValue","label","error"])])):g("",!0),t.existingUser?g("",!0):(i(),c("div",ee,[l(u,{type:"text",modelValue:o.username,"onUpdate:modelValue":e[6]||(e[6]=a=>o.username=a),name:"username",label:s.$trans("contact.login.props.username"),error:r(n).username,"onUpdate:error":e[7]||(e[7]=a=>r(n).username=a)},null,8,["modelValue","label","error"])])),M(m("div",ae,[l(x,{modelValue:o.roles,"onUpdate:modelValue":e[8]||(e[8]=a=>o.roles=a),name:"roles",label:s.$trans("contact.login.props.role"),options:$.roles,multiple:"","label-prop":"label","value-prop":"uuid",error:r(n).roles,"onUpdate:error":e[9]||(e[9]=a=>r(n).roles=a)},null,8,["modelValue","label","options","error"])],512),[[J,!1]]),t.existingUser&&r(Q)("user:force-change-password")?(i(),c("div",se,[l(E,{vertical:"",modelValue:o.forceChangePassword,"onUpdate:modelValue":e[10]||(e[10]=a=>o.forceChangePassword=a),name:"forceChangePassword",label:s.$trans("global.change",{attribute:s.$trans("contact.login.props.password")}),error:r(n).forceChangePassword,"onUpdate:error":e[11]||(e[11]=a=>r(n).forceChangePassword=a)},null,8,["modelValue","label","error"])])):g("",!0),!t.existingUser||o.forceChangePassword?(i(),c(C,{key:3},[m("div",oe,[l(u,{type:"password",modelValue:o.password,"onUpdate:modelValue":e[12]||(e[12]=a=>o.password=a),name:"password",label:s.$trans("contact.login.props.password"),error:r(n).password,"onUpdate:error":e[13]||(e[13]=a=>r(n).password=a)},null,8,["modelValue","label","error"])]),m("div",re,[l(u,{type:"password",modelValue:o.passwordConfirmation,"onUpdate:modelValue":e[14]||(e[14]=a=>o.passwordConfirmation=a),name:"passwordConfirmation",label:s.$trans("contact.login.props.password_confirmation"),error:r(n).passwordConfirmation,"onUpdate:error":e[15]||(e[15]=a=>r(n).passwordConfirmation=a)},null,8,["modelValue","label","error"])])],64)):g("",!0)])]),_:1},8,["action","form"])):(i(),y(k,{key:0,"no-action-button":"","no-data-fetch":"","init-url":U,action:"confirmUser","init-form":f,form:o,"after-submit":R,"stay-on":"",redirect:{name:"GuardianShowLogin",params:{uuid:p.guardian.uuid}}},{default:V(()=>[m("div",W,[m("div",X,[l(u,{type:"text",modelValue:o.email,"onUpdate:modelValue":e[0]||(e[0]=a=>o.email=a),name:"email",label:s.$trans("contact.login.props.email"),error:r(n).email,"onUpdate:error":e[1]||(e[1]=a=>r(n).email=a)},null,8,["modelValue","label","error"])])]),l(O,{class:"mt-4",type:"submit"},{default:V(()=>[z(K(s.$trans("general.validate")),1)]),_:1})]),_:1},8,["form","redirect"]))],64)):g("",!0)]),_:1})],64)}}});export{le as default};
