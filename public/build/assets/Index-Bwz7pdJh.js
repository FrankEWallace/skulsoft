import{u as S,k as j,m as B,I as O,q as D,r as u,t as v,o as _,w as l,d as p,e,b as C,v as m,x as s,j as I,z as M,p as w,a as q,f as N,F as R,y as E}from"./app-Cvm44xuh.js";const z={class:"grid grid-cols-3 gap-6"},W={class:"col-span-3 sm:col-span-1"},G={class:"col-span-3 sm:col-span-1"},J={class:"col-span-3 sm:col-span-1"},K={class:"col-span-3 sm:col-span-1"},Q={class:"col-span-3 sm:col-span-1"},X={class:"col-span-3 sm:col-span-1"},Y={class:"col-span-3 sm:col-span-1"},Z={class:"col-span-3 sm:col-span-1"},x={class:"col-span-3 sm:col-span-1"},ee={__name:"Filter",props:{initUrl:{type:String,default:""}},emits:["hide"],setup(T,{emit:y}){const f=S();j("moment");const V=y,h=T,g={codeNumber:"",name:"",batches:[],minTotal:"",minPaid:"",minConcession:"",minBalance:"",groups:[],address:""},t=B({...g});O(h.initUrl);const d=B({isLoaded:!(f.query.batches||f.query.groups)});return D(async()=>{d.batches=f.query.batches?f.query.batches.split(","):[],d.groups=f.query.groups?f.query.groups.split(","):[],d.isLoaded=!0}),(o,n)=>{const r=u("BaseInput"),b=u("BaseSelectSearch"),F=u("FilterForm");return _(),v(F,{"init-form":g,multiple:["batches","groups"],form:t,onHide:n[9]||(n[9]=a=>V("hide"))},{default:l(()=>[p("div",z,[p("div",W,[e(r,{type:"text",modelValue:t.codeNumber,"onUpdate:modelValue":n[0]||(n[0]=a=>t.codeNumber=a),name:"codeNumber",label:o.$trans("student.admission.props.code_number")},null,8,["modelValue","label"])]),p("div",G,[e(r,{type:"text",modelValue:t.name,"onUpdate:modelValue":n[1]||(n[1]=a=>t.name=a),name:"name",label:o.$trans("contact.props.name")},null,8,["modelValue","label"])]),p("div",J,[d.isLoaded?(_(),v(b,{key:0,multiple:"",name:"batches",label:o.$trans("global.select",{attribute:o.$trans("academic.batch.batch")}),modelValue:t.batches,"onUpdate:modelValue":n[2]||(n[2]=a=>t.batches=a),"value-prop":"uuid","init-search":d.batches,"search-key":"course_batch","search-action":"academic/batch/list"},{selectedOption:l(a=>[m(s(a.value.course.name)+" "+s(a.value.name),1)]),listOption:l(a=>[m(s(a.option.course.nameWithTerm)+" "+s(a.option.name),1)]),_:1},8,["label","modelValue","init-search"])):C("",!0)]),p("div",K,[e(r,{type:"text",modelValue:t.minTotal,"onUpdate:modelValue":n[3]||(n[3]=a=>t.minTotal=a),name:"minTotal",label:o.$trans("global.min_item",{attribute:o.$trans("finance.fee.total")})},null,8,["modelValue","label"])]),p("div",Q,[e(r,{type:"text",modelValue:t.minPaid,"onUpdate:modelValue":n[4]||(n[4]=a=>t.minPaid=a),name:"minPaid",label:o.$trans("global.min_item",{attribute:o.$trans("finance.fee.paid")})},null,8,["modelValue","label"])]),p("div",X,[e(r,{type:"text",modelValue:t.minConcession,"onUpdate:modelValue":n[5]||(n[5]=a=>t.minConcession=a),name:"minConcession",label:o.$trans("global.min_item",{attribute:o.$trans("finance.fee.concession")})},null,8,["modelValue","label"])]),p("div",Y,[e(r,{type:"text",modelValue:t.minBalance,"onUpdate:modelValue":n[6]||(n[6]=a=>t.minBalance=a),name:"minBalance",label:o.$trans("global.min_item",{attribute:o.$trans("finance.fee.balance")})},null,8,["modelValue","label"])]),p("div",Z,[d.isLoaded?(_(),v(b,{key:0,multiple:"",modelValue:t.groups,"onUpdate:modelValue":n[7]||(n[7]=a=>t.groups=a),name:"groups","label-prop":"name","value-prop":"uuid",label:o.$trans("student.group.group"),"init-search":d.groups,"search-action":"option/list","additional-search-query":{type:"student_group"}},null,8,["modelValue","label","init-search"])):C("",!0)]),p("div",x,[e(r,{type:"text",modelValue:t.address,"onUpdate:modelValue":n[8]||(n[8]=a=>t.address=a),name:"address",label:o.$trans("contact.props.address.address")},null,8,["modelValue","label"])])])]),_:1},8,["form"])}}},ae={name:"FinanceReportFeeSummary"},ne=Object.assign(ae,{setup(T){const y=S(),f=I();let V=["filter"],h=[];M("finance:export")&&(h=["print","pdf","excel"]);const g="finance/report/",t=w(!1),d=w(!1),o=B({headers:[],data:[],meta:{total:0}}),n=async()=>{d.value=!0,await f.dispatch(g+"fetchReport",{name:"fee-summary",params:y.query}).then(r=>{d.value=!1,Object.assign(o,r)}).catch(r=>{d.value=!1})};return D(async()=>{await n()}),(r,b)=>{const F=u("PageHeaderAction"),a=u("PageHeader"),U=u("ParentTransition"),c=u("DataCell"),$=u("TextMuted"),P=u("DataRow"),H=u("DataTable"),L=u("BaseCard");return _(),q(R,null,[e(a,{title:r.$trans(N(y).meta.label),navs:[{label:r.$trans("finance.finance"),path:"Finance"},{label:r.$trans("finance.report.report"),path:"FinanceReport"}]},{default:l(()=>[e(F,{url:"finance/reports/fee-summary/",name:"FinanceReportFeeSummary",title:r.$trans("finance.report.fee_summary.fee_summary"),actions:N(V),"dropdown-actions":N(h),headers:o.headers,onToggleFilter:b[0]||(b[0]=i=>t.value=!t.value)},null,8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"]),e(U,{appear:"",visibility:t.value},{default:l(()=>[e(ee,{onAfterFilter:n,"init-url":g,onHide:b[1]||(b[1]=i=>t.value=!1)})]),_:1},8,["visibility"]),e(U,{appear:"",visibility:!0},{default:l(()=>[e(L,{"no-padding":"","no-content-padding":"","is-loading":d.value},{default:l(()=>[e(H,{header:o.headers,footer:o.footers,meta:o.meta,module:"finance.report.fee_summary",onRefresh:n},{default:l(()=>[(_(!0),q(R,null,E(o.data,(i,A)=>(_(),v(P,{key:i.uuid},{default:l(()=>[e(c,{name:"sno"},{default:l(()=>[m(s(o.meta.sno+A),1)]),_:2},1024),e(c,{name:"codeNumber"},{default:l(()=>[m(s(i.codeNumber),1)]),_:2},1024),e(c,{name:"name"},{default:l(()=>[m(s(i.name)+" ",1),e($,{block:""},{default:l(()=>[m(s(i.rollNumber),1)]),_:2},1024)]),_:2},1024),e(c,{name:"fatherName"},{default:l(()=>[m(s(i.fatherName)+" ",1),e($,{block:""},{default:l(()=>[m(s(i.contactNumber),1)]),_:2},1024)]),_:2},1024),e(c,{name:"course"},{default:l(()=>[m(s(i.courseName)+" ",1),e($,{block:""},{default:l(()=>[m(s(i.batchName),1)]),_:2},1024)]),_:2},1024),e(c,{name:"category"},{default:l(()=>{var k;return[m(s(((k=i.category)==null?void 0:k.name)||"-"),1)]}),_:2},1024),e(c,{name:"totalFee"},{default:l(()=>[m(s(i.total.formatted),1)]),_:2},1024),e(c,{name:"concessionFee"},{default:l(()=>[m(s(i.concession.formatted),1)]),_:2},1024),e(c,{name:"paidFee"},{default:l(()=>[m(s(i.paid.formatted),1)]),_:2},1024),e(c,{name:"balanceFee"},{default:l(()=>[m(s(i.balance.formatted),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","footer","meta"])]),_:1},8,["is-loading"])]),_:1})],64)}}});export{ne as default};
