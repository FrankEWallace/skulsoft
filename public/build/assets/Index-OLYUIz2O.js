import{u as q,m as T,q as A,r as l,t as y,o as p,w as e,d as k,e as a,i as H,k as U,p as O,f as m,a as L,F as j,y as W,v as i,x as s,b as v}from"./app-Cvm44xuh.js";import{u as z}from"./useColumnVisibility-BfQRdpHQ.js";const G={class:"grid grid-cols-3 gap-6"},J={class:"col-span-3 sm:col-span-1"},K={class:"col-span-3 sm:col-span-1"},Q={class:"col-span-3 sm:col-span-1"},X={__name:"Filter",emits:["hide"],setup(h,{emit:c}){q();const D=c,g={codeNumber:"",issueStartDate:"",issueEndDate:"",dueStartDate:"",dueEndDate:""},u=T({...g}),C=T({isLoaded:!1});return A(async()=>{C.isLoaded=!0}),(b,r)=>{const f=l("BaseInput"),$=l("DatePicker"),o=l("FilterForm");return p(),y(o,{"init-form":g,form:u,multiple:[],onHide:r[5]||(r[5]=n=>D("hide"))},{default:e(()=>[k("div",G,[k("div",J,[a(f,{type:"text",modelValue:u.codeNumber,"onUpdate:modelValue":r[0]||(r[0]=n=>u.codeNumber=n),name:"codeNumber",label:b.$trans("library.transaction.props.code_number")},null,8,["modelValue","label"])]),k("div",K,[a($,{start:u.issueStartDate,"onUpdate:start":r[1]||(r[1]=n=>u.issueStartDate=n),end:u.issueEndDate,"onUpdate:end":r[2]||(r[2]=n=>u.issueEndDate=n),name:"issueDateBetween",as:"range",label:b.$trans("global.date_between",{attribute:b.$trans("library.transaction.props.issue_date")})},null,8,["start","end","label"])]),k("div",Q,[a($,{start:u.dueStartDate,"onUpdate:start":r[3]||(r[3]=n=>u.dueStartDate=n),end:u.dueEndDate,"onUpdate:end":r[4]||(r[4]=n=>u.dueEndDate=n),name:"dueDateBetween",as:"range",label:b.$trans("global.date_between",{attribute:b.$trans("library.transaction.props.due_date")})},null,8,["start","end","label"])])])]),_:1},8,["form"])}}},Y={key:1},Z={key:2},x={name:"LibraryTransactionList"},ae=Object.assign(x,{setup(h){const c=H(),D=U("emitter"),{applyVisibility:g}=z("LibraryTransaction");let u=["create","filter"],C=["print","pdf","excel"];const b="library/transaction/",r=O(!1),f=T({}),$=o=>{o.headers=g(o.headers),Object.assign(f,o)};return(o,n)=>{const F=l("BaseButton"),N=l("PageHeaderAction"),R=l("PageHeader"),I=l("ParentTransition"),d=l("DataCell"),S=l("TextMuted"),B=l("BaseBadge"),w=l("FloatingMenuItem"),V=l("FloatingMenu"),E=l("DataRow"),P=l("DataTable"),M=l("ListItem");return p(),y(M,{"init-url":b,onSetItems:$},{header:e(()=>[a(R,{title:o.$trans("library.transaction.transaction"),navs:[{label:o.$trans("library.library"),path:"Library"}]},{default:e(()=>[a(N,{url:"library/transactions/",name:"LibraryTransaction",title:o.$trans("library.transaction.transaction"),actions:m(u),"dropdown-actions":m(C),headers:f.headers,onToggleFilter:n[1]||(n[1]=t=>r.value=!r.value)},{default:e(()=>[a(F,{design:"white",onClick:n[0]||(n[0]=t=>m(c).push({name:"LibraryBookWiseTransactionList"}))},{default:e(()=>[i(s(o.$trans("library.transaction.book_wise_issue_return")),1)]),_:1})]),_:1},8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"])]),filter:e(()=>[a(I,{appear:"",visibility:r.value},{default:e(()=>[a(X,{onRefresh:n[2]||(n[2]=t=>m(D).emit("listItems")),onHide:n[3]||(n[3]=t=>r.value=!1)})]),_:1},8,["visibility"])]),default:e(()=>[a(I,{appear:"",visibility:!0},{default:e(()=>[a(P,{header:f.headers,meta:f.meta,module:"library.transaction",onRefresh:n[5]||(n[5]=t=>m(D).emit("listItems"))},{actionButton:e(()=>[a(F,{onClick:n[4]||(n[4]=t=>m(c).push({name:"LibraryTransactionCreate"}))},{default:e(()=>[i(s(o.$trans("global.add",{attribute:o.$trans("library.transaction.transaction")})),1)]),_:1})]),default:e(()=>[(p(!0),L(j,null,W(f.data,t=>(p(),y(E,{key:t.uuid,onDoubleClick:_=>m(c).push({name:"LibraryTransactionShow",params:{uuid:t.uuid}})},{default:e(()=>[a(d,{name:"codeNumber"},{default:e(()=>[i(s(t.codeNumber),1)]),_:2},1024),a(d,{name:"to"},{default:e(()=>[i(s(t.to.label),1)]),_:2},1024),a(d,{name:"requester"},{default:e(()=>[i(s(t.requester.name)+" ",1),a(S,{block:""},{default:e(()=>[i(s(t.requester.contactNumber),1)]),_:2},1024)]),_:2},1024),a(d,{name:"requesterDetail"},{default:e(()=>[i(s(t.requesterDetail),1)]),_:2},1024),a(d,{name:"issueDate"},{default:e(()=>[i(s(t.issueDate.formatted)+" ",1),t.nonReturnedBooksCount?t.nonReturnedBooksCount<t.recordsCount?(p(),y(B,{key:1,design:"warning"},{default:e(()=>[i(s(o.$trans("library.transaction.statuses.partially_returned")),1)]),_:1})):v("",!0):(p(),y(B,{key:0,design:"success"},{default:e(()=>[i(s(o.$trans("library.transaction.statuses.returned")),1)]),_:1}))]),_:2},1024),a(d,{name:"dueDate"},{default:e(()=>{var _;return[i(s(((_=t.dueDate)==null?void 0:_.formatted)||"-"),1)]}),_:2},1024),a(d,{name:"dueInDays"},{default:e(()=>[t.isOverdue?(p(),y(B,{key:0,design:"danger"},{default:e(()=>[i(s(t.dueInDays),1)]),_:2},1024)):v("",!0),!t.isOverdue&&t.nonReturnedBooksCount>0?(p(),L("span",Y,s(t.dueInDays),1)):v("",!0),t.nonReturnedBooksCount==0?(p(),L("span",Z,"-")):v("",!0)]),_:2},1024),a(d,{name:"recordsCount"},{default:e(()=>[i(s(t.recordsCount),1)]),_:2},1024),a(d,{name:"createdAt"},{default:e(()=>[i(s(t.createdAt.formatted),1)]),_:2},1024),a(d,{name:"action"},{default:e(()=>[a(V,null,{default:e(()=>[a(w,{icon:"fas fa-arrow-circle-right",onClick:_=>m(c).push({name:"LibraryTransactionShow",params:{uuid:t.uuid}})},{default:e(()=>[i(s(o.$trans("general.show")),1)]),_:2},1032,["onClick"]),a(w,{icon:"fas fa-edit",onClick:_=>m(c).push({name:"LibraryTransactionEdit",params:{uuid:t.uuid}})},{default:e(()=>[i(s(o.$trans("general.edit")),1)]),_:2},1032,["onClick"]),a(w,{icon:"fas fa-trash",onClick:_=>m(D).emit("deleteItem",{uuid:t.uuid})},{default:e(()=>[i(s(o.$trans("general.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onDoubleClick"]))),128))]),_:1},8,["header","meta"])]),_:1})]),_:1})}}});export{ae as default};
