import{u as E,j as P,p as A,I,m as B,q as L,ai as O,r as c,t as W,o as g,w as p,d as i,e as n,f as o,v as $,a as F,b as j,x as b,F as C}from"./app-Cvm44xuh.js";import"./lodash-B9Pricun.js";const M={class:"grid grid-cols-3 gap-6"},z={class:"col-span-3 sm:col-span-1"},G={key:0,class:"ml-1"},J={key:0,class:"ml-1"},K={class:"col-span-3 sm:col-span-1"},Q={class:"col-span-3 sm:col-span-1"},X={class:"col-span-3 sm:col-span-1"},Y={class:"flex items-center gap-2"},Z={class:"grid grid-cols-3 gap-6"},ee={class:"col-span-3 sm:col-span-1"},te={class:"col-span-3 sm:col-span-1"},ae={class:"col-span-3 sm:col-span-1"},se={class:"mt-4 grid grid-cols-4 gap-6"},oe={class:"col-span-3 sm:col-span-1"},re={class:"mt-4 grid grid-cols-4 gap-6"},le={class:"col-span-4 sm:col-span-1"},ne={class:"col-span-4 sm:col-span-1"},ie={class:"col-span-4 sm:col-span-1"},me={class:"col-span-4 sm:col-span-1"},ue={__name:"Filter",props:{initUrl:{type:String,default:""},preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup(k,{emit:U}){const l=E(),R=P(),T=U,v=k,y={exam:"",attempt:"first",batch:"",subjects:[],title:"",showPrintDateTime:!1,signatory1:"",signatory2:"",signatory3:"",signatory4:"",showAllStudent:!1,showWatermark:!1},d=A(!1),h=A(!1),r=I(v.initUrl),a=B({...y}),m=B({exams:v.preRequisites.exams,subjects:[]}),u=B({exam:"",batch:"",subjects:[],isLoaded:!(l.query.exam&&l.query.batch&&l.query.subjects)}),S=async s=>{if(!s){a.batch="",a.subjects=[],m.subjects=[];return}a.batch=s||"",m.subjects=[],a.subjects=[],d.value=!0,await R.dispatch("academic/batch/listSubjects",{uuid:s||""}).then(t=>{m.subjects=t,d.value=!1}).catch(t=>{d.value=!1})};return L(async()=>{if(_.isEmpty(l.query)){u.isLoaded=!0;return}u.exam=l.query.exam,a.exam=l.query.exam,a.attempt=l.query.attempt,u.batch=l.query.batch,a.batch=l.query.batch,a.showAllStudent=O(l.query.showAllStudent||""),a.showWatermark=O(l.query.showWatermark||""),a.showPrintDateTime=O(l.query.showPrintDateTime||""),l.query.batch&&(await S(l.query.batch),a.subjects=l.query.subjects?l.query.subjects.split(","):[],u.subjects=l.query.subjects?l.query.subjects.split(","):[]),u.isLoaded=!0}),(s,t)=>{const w=c("BaseSelect"),D=c("BaseSelectSearch"),x=c("BaseSwitch"),f=c("BaseInput"),H=c("BaseFieldset"),N=c("FilterForm");return g(),W(N,{"init-form":y,multiple:["subjects"],form:a,onHide:t[24]||(t[24]=e=>T("hide"))},{default:p(()=>[i("div",M,[i("div",z,[n(w,{modelValue:a.exam,"onUpdate:modelValue":t[0]||(t[0]=e=>a.exam=e),name:"exam",label:s.$trans("exam.exam"),"value-prop":"uuid",options:k.preRequisites.exams,error:o(r).exam,"onUpdate:error":t[1]||(t[1]=e=>o(r).exam=e)},{selectedOption:p(e=>{var V,q;return[$(b(e.value.name)+" ",1),e.value.term?(g(),F("span",G,"("+b(((q=(V=e.value.term)==null?void 0:V.division)==null?void 0:q.name)||s.$trans("general.all"))+")",1)):j("",!0)]}),listOption:p(e=>{var V,q;return[$(b(e.option.name)+" ",1),e.option.term?(g(),F("span",J,"("+b(((q=(V=e.option.term)==null?void 0:V.division)==null?void 0:q.name)||s.$trans("general.all"))+")",1)):j("",!0)]}),_:1},8,["modelValue","label","options","error"])]),i("div",K,[u.isLoaded?(g(),W(w,{key:0,modelValue:a.attempt,"onUpdate:modelValue":t[2]||(t[2]=e=>a.attempt=e),name:"attempt",label:s.$trans("exam.schedule.props.attempt"),options:k.preRequisites.attempts,error:o(r).attempt,"onUpdate:error":t[3]||(t[3]=e=>o(r).attempt=e)},null,8,["modelValue","label","options","error"])):j("",!0)]),i("div",Q,[u.isLoaded?(g(),W(D,{key:0,name:"batch",label:s.$trans("global.select",{attribute:s.$trans("academic.batch.batch")}),modelValue:a.batch,"onUpdate:modelValue":t[4]||(t[4]=e=>a.batch=e),error:o(r).batch,"onUpdate:error":t[5]||(t[5]=e=>o(r).batch=e),"value-prop":"uuid","init-search":u.batch,"search-key":"course_batch","search-action":"academic/batch/list",onChange:S},{selectedOption:p(e=>[$(b(e.value.course.name)+" "+b(e.value.name),1)]),listOption:p(e=>[$(b(e.option.course.nameWithTerm)+" "+b(e.option.name),1)]),_:1},8,["label","modelValue","error","init-search"])):j("",!0)]),i("div",X,[n(w,{multiple:"",modelValue:a.subjects,"onUpdate:modelValue":t[6]||(t[6]=e=>a.subjects=e),name:"subjects",label:s.$trans("academic.subject.subject"),"label-prop":"name","value-prop":"uuid",options:m.subjects},null,8,["modelValue","label","options"])])]),n(H,{class:"mt-4"},{legend:p(()=>[i("div",Y,[$(b(s.$trans("global.show",{attribute:s.$trans("general.options")}))+" ",1),n(x,{reverse:"",modelValue:h.value,"onUpdate:modelValue":t[7]||(t[7]=e=>h.value=e),name:"showOptions"},null,8,["modelValue"])])]),default:p(()=>[h.value?(g(),F(C,{key:0},[i("div",Z,[i("div",ee,[n(x,{vertical:"",modelValue:a.showAllStudent,"onUpdate:modelValue":t[8]||(t[8]=e=>a.showAllStudent=e),name:"showAllStudent",label:s.$trans("global.list_all",{attribute:s.$trans("student.student")}),error:o(r).showAllStudent,"onUpdate:error":t[9]||(t[9]=e=>o(r).showAllStudent=e)},null,8,["modelValue","label","error"])]),i("div",te,[n(x,{vertical:"",modelValue:a.showWatermark,"onUpdate:modelValue":t[10]||(t[10]=e=>a.showWatermark=e),name:"showWatermark",label:s.$trans("global.show",{attribute:s.$trans("print.watermark")}),error:o(r).showWatermark,"onUpdate:error":t[11]||(t[11]=e=>o(r).showWatermark=e)},null,8,["modelValue","label","error"])]),i("div",ae,[n(x,{vertical:"",modelValue:a.showPrintDateTime,"onUpdate:modelValue":t[12]||(t[12]=e=>a.showPrintDateTime=e),name:"showPrintDateTime",label:s.$trans("global.show",{attribute:s.$trans("general.print_date_time")}),error:o(r).showPrintDateTime,"onUpdate:error":t[13]||(t[13]=e=>o(r).showPrintDateTime=e)},null,8,["modelValue","label","error"])])]),i("div",se,[i("div",oe,[n(f,{type:"text",modelValue:a.title,"onUpdate:modelValue":t[14]||(t[14]=e=>a.title=e),name:"title",label:s.$trans("print.title"),error:o(r).title,"onUpdate:error":t[15]||(t[15]=e=>o(r).title=e)},null,8,["modelValue","label","error"])])]),i("div",re,[i("div",le,[n(f,{type:"text",modelValue:a.signatory1,"onUpdate:modelValue":t[16]||(t[16]=e=>a.signatory1=e),name:"signatory1",label:s.$trans("print.signatory1"),error:o(r).signatory1,"onUpdate:error":t[17]||(t[17]=e=>o(r).signatory1=e)},null,8,["modelValue","label","error"])]),i("div",ne,[n(f,{type:"text",modelValue:a.signatory2,"onUpdate:modelValue":t[18]||(t[18]=e=>a.signatory2=e),name:"signatory2",label:s.$trans("print.signatory2"),error:o(r).signatory2,"onUpdate:error":t[19]||(t[19]=e=>o(r).signatory2=e)},null,8,["modelValue","label","error"])]),i("div",ie,[n(f,{type:"text",modelValue:a.signatory3,"onUpdate:modelValue":t[20]||(t[20]=e=>a.signatory3=e),name:"signatory3",label:s.$trans("print.signatory3"),error:o(r).signatory3,"onUpdate:error":t[21]||(t[21]=e=>o(r).signatory3=e)},null,8,["modelValue","label","error"])]),i("div",me,[n(f,{type:"text",modelValue:a.signatory4,"onUpdate:modelValue":t[22]||(t[22]=e=>a.signatory4=e),name:"signatory4",label:s.$trans("print.signatory4"),error:o(r).signatory4,"onUpdate:error":t[23]||(t[23]=e=>o(r).signatory4=e)},null,8,["modelValue","label","error"])])])],64)):j("",!0)]),_:1})]),_:1},8,["form"])}}},de={name:"ExamReportMarkSummary"},be=Object.assign(de,{setup(k){const U=E(),l=P();let R=["filter"],T=[];const v="exam/report/",y=A(!0),d=A(!1),h=B({exams:[],attempts:[]}),r=async()=>{d.value=!0,await l.dispatch(v+"preRequisite",{name:"mark-summary"}).then(m=>{d.value=!1,Object.assign(h,m)}).catch(m=>{d.value=!1})},a=async()=>{d.value=!0,await l.dispatch(v+"fetchReport",{name:"mark-summary",params:U.query}).then(m=>{d.value=!1,window.open("/print").document.write(m)}).catch(m=>{d.value=!1})};return L(async()=>{await r()}),(m,u)=>{const S=c("PageHeaderAction"),s=c("PageHeader"),t=c("ParentTransition"),w=c("BaseCard");return g(),F(C,null,[n(s,{title:m.$trans(o(U).meta.label),navs:[{label:m.$trans("exam.exam"),path:"Exam"},{label:m.$trans("exam.report.report"),path:"ExamReport"}]},{default:p(()=>[n(S,{url:"exam/reports/mark-summary/",name:"ExamReportMarkSummary",title:m.$trans("exam.report.mark_summary.mark_summary"),actions:o(R),"dropdown-actions":o(T),onToggleFilter:u[0]||(u[0]=D=>y.value=!y.value)},null,8,["title","actions","dropdown-actions"])]),_:1},8,["title","navs"]),n(t,{appear:"",visibility:y.value},{default:p(()=>[n(ue,{onAfterFilter:a,"init-url":v,"pre-requisites":h,onHide:u[1]||(u[1]=D=>y.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"]),n(t,{appear:"",visibility:!0},{default:p(()=>[n(w,{"no-padding":"","no-content-padding":"","is-loading":d.value},null,8,["is-loading"])]),_:1})],64)}}});export{be as default};
