import{u as U,k as x,m as C,I as z,q as j,r as i,t as _,o as l,w as e,d as M,e as a,b as h,v as n,x as o,j as I,z as G,p as O,a as b,f as A,F as D,y as S}from"./app-Cvm44xuh.js";const J={class:"grid grid-cols-3 gap-6"},K={class:"col-span-3 sm:col-span-1"},Q={class:"col-span-3 sm:col-span-1"},W={__name:"Filter",props:{initUrl:{type:String,default:""}},emits:["hide"],setup(H,{emit:w}){const B=U();x("moment");const T=w,N=H,g={date:"",employee:""},p=C({...g});z(N.initUrl);const f=C({isLoaded:!B.query.employee,employee:null});return j(async()=>{f.employee=B.query.employee,f.isLoaded=!0}),(r,c)=>{const u=i("DatePicker"),k=i("BaseSelectSearch"),V=i("FilterForm");return l(),_(V,{"init-form":g,multiple:[],form:p,onHide:c[2]||(c[2]=m=>T("hide"))},{default:e(()=>[M("div",J,[M("div",K,[a(u,{modelValue:p.date,"onUpdate:modelValue":c[0]||(c[0]=m=>p.date=m),name:"date",as:"date",label:r.$trans("general.date")},null,8,["modelValue","label"])]),M("div",Q,[f.isLoaded?(l(),_(k,{key:0,name:"employee",label:r.$trans("global.select",{attribute:r.$trans("employee.employee")}),modelValue:p.employee,"onUpdate:modelValue":c[1]||(c[1]=m=>p.employee=m),"value-prop":"uuid","init-search":f.employee,"search-key":"name","search-action":"employee/list"},{selectedOption:e(m=>[n(o(m.value.name)+" ("+o(m.value.codeNumber)+") ",1)]),listOption:e(m=>[n(o(m.option.name)+" ("+o(m.option.codeNumber)+") ",1)]),_:1},8,["label","modelValue","init-search"])):h("",!0)])])]),_:1},8,["form"])}}},X={key:0},Y={key:1},Z={name:"FinanceReportDayBook"},te=Object.assign(Z,{setup(H){const w=U(),B=I();let T=["filter"],N=[];G("finance:export")&&(N=["print","pdf","excel"]);const g="finance/report/",p=O(!1),f=O(!1),r=C({headers:[],data:[],meta:{total:0}}),c=async()=>{f.value=!0,await B.dispatch(g+"fetchReport",{name:"day-book",params:w.query}).then(u=>{f.value=!1,Object.assign(r,u)}).catch(u=>{f.value=!1})};return j(async()=>{await c()}),(u,k)=>{const V=i("PageHeaderAction"),m=i("PageHeader"),L=i("ParentTransition"),d=i("DataCell"),v=i("TextMuted"),R=i("DataRow"),q=i("DataTable"),P=i("BaseCard"),E=i("SimpleTable");return l(),b(D,null,[a(m,{title:u.$trans(A(w).meta.label),navs:[{label:u.$trans("finance.finance"),path:"Finance"},{label:u.$trans("finance.report.report"),path:"FinanceReport"}]},{default:e(()=>[a(V,{url:"finance/reports/day-book/",name:"FinanceReportDayBook",title:u.$trans("finance.report.day_book.day_book"),actions:A(T),"dropdown-actions":A(N),headers:r.headers,onToggleFilter:k[0]||(k[0]=t=>p.value=!p.value)},null,8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"]),a(L,{appear:"",visibility:p.value},{default:e(()=>[a(W,{onAfterFilter:c,"init-url":g,onHide:k[1]||(k[1]=t=>p.value=!1)})]),_:1},8,["visibility"]),a(L,{appear:"",visibility:!0},{default:e(()=>[a(P,{"no-padding":"","no-content-padding":"","is-loading":f.value},{default:e(()=>[a(q,{header:r.headers,footer:r.footers,meta:r.meta,module:"finance.report.day_book",onRefresh:c},{default:e(()=>[(l(!0),b(D,null,S(r.data,(t,y)=>(l(),_(R,{key:t.uuid},{default:e(()=>[a(d,{name:"sno"},{default:e(()=>[n(o(r.meta.sno+y),1)]),_:2},1024),a(d,{name:"codeNumber"},{default:e(()=>[n(o(t.codeNumber)+" ",1),t.isOnline?(l(),_(v,{key:0,block:""},{default:e(()=>[n(o(t.referenceNumber),1)]),_:2},1024)):h("",!0)]),_:2},1024),a(d,{name:"primaryLedger"},{default:e(()=>{var s,F;return[n(o(((F=(s=t.payment)==null?void 0:s.ledger)==null?void 0:F.name)||"-")+" ",1),t.payment?(l(),_(v,{key:0,block:""},{default:e(()=>{var $;return[n(o(($=t.payment)==null?void 0:$.methodName),1)]}),_:2},1024)):h("",!0),t.head?(l(),_(v,{key:1,block:""},{default:e(()=>[n(o(t.head),1)]),_:2},1024)):h("",!0)]}),_:2},1024),a(d,{name:"secondaryLedger"},{default:e(()=>{var s,F,$;return[t.record?(l(),b("span",X,o((F=(s=t.record)==null?void 0:s.ledger)==null?void 0:F.name),1)):h("",!0),($=t.transactionable)!=null&&$.name?(l(),b("span",Y,[n(o(t.transactionable.name)+" ",1),a(v,{block:""},{default:e(()=>[n(o(t.transactionable.detail),1)]),_:2},1024),a(v,{block:""},{default:e(()=>[n(o(t.transactionable.subDetail),1)]),_:2},1024)])):h("",!0)]}),_:2},1024),a(d,{name:"date"},{default:e(()=>[n(o(t.date.formatted),1)]),_:2},1024),a(d,{name:"payment"},{default:e(()=>{var s;return[n(o(((s=t.payment)==null?void 0:s.formatted)||"-"),1)]}),_:2},1024),a(d,{name:"receipt"},{default:e(()=>{var s;return[n(o(((s=t.receipt)==null?void 0:s.formatted)||"-"),1)]}),_:2},1024),a(d,{name:"user"},{default:e(()=>{var s;return[n(o((s=t.user.profile)==null?void 0:s.name),1)]}),_:2},1024),a(d,{name:"createdAt"},{default:e(()=>[n(o(t.createdAt.formatted),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","footer","meta"])]),_:1},8,["is-loading"]),a(P,{class:"mt-4","no-padding":"","no-content-padding":""},{title:e(()=>[n(o(u.$trans("finance.report.payment_method_wise_summary.payment_method_wise_summary")),1)]),default:e(()=>[a(E,{header:r.meta.paymentMethodHeads},{default:e(()=>[(l(!0),b(D,null,S(r.meta.paymentMethodSummary,t=>(l(),_(R,{key:t.uuid},{default:e(()=>[a(d,{name:"paymentMethod"},{default:e(()=>[n(o(t.name),1)]),_:2},1024),(l(!0),b(D,null,S(t.heads,y=>(l(),_(d,{key:y.key,name:y.key},{default:e(()=>[n(o(y.amount.formatted),1)]),_:2},1032,["name"]))),128)),a(d,{name:"total"},{default:e(()=>[n(o(t.amount.formatted),1)]),_:2},1024)]),_:2},1024))),128)),a(R,null,{default:e(()=>[a(d,{name:"paymentMethod"},{default:e(()=>[n(o(u.$trans("general.total")),1)]),_:1}),(l(!0),b(D,null,S(r.meta.paymentMethodFooter,t=>(l(),_(d,{key:t.key,name:t.key},{default:e(()=>{var y;return[n(o(((y=t.amount)==null?void 0:y.formatted)||""),1)]}),_:2},1032,["name"]))),128))]),_:1})]),_:1},8,["header"])]),_:1})]),_:1})],64)}}});export{te as default};
