import{u as B,H as T,I as C,m as U,r as u,t as $,o as p,w as g,d as l,a as c,b as _,e as i,f as o,v as V,x as m,F,y as D,K as R}from"./app-Cvm44xuh.js";const L={class:"grid grid-cols-4 gap-6"},G={class:"col-span-4 sm:col-span-1"},w={key:0,class:"col-span-2 sm:col-span-1"},M={key:1,class:"col-span-2 sm:col-span-1"},E={class:"mt-4 grid grid-cols-4 gap-6"},I={class:"col-span-4 sm:col-span-1"},W={class:"col-span-4 sm:col-span-1"},K={class:"mt-4 grid grid-cols-1 gap-4"},z={class:"col"},J={class:"col"},Q={class:"col"},X={class:"mt-4 flex space-x-4"},Y=["src"],Z=["src"],x={class:"col"},ee={name:"ReceptionGatePassForm"},te=Object.assign(ee,{setup(O){const v=B(),n={to:"",purpose:"",requesters:[],startAt:"",reason:"",remarks:"",images:[],media:[],mediaUpdated:!1,mediaToken:T(),mediaHash:[]},q="reception/gatePass/",a=C(q),y=U({to:[],purposes:[]}),s=U({...n}),b=U({requesters:[],isLoaded:!v.params.uuid}),P=r=>{v.params.uuid||(n.startAt=r.currentDateTime,Object.assign(s,R(n))),Object.assign(y,r)},h=()=>{s.mediaToken=T(),s.mediaHash=[]},H=r=>{var f;let t=r.audiences.filter(d=>d.type=="student").map(d=>d.uuid),k=r.audiences.filter(d=>d.type=="employee").map(d=>d.uuid);Object.assign(n,{...r,to:r.requesterType.value,startAt:r.startAt.at,purpose:((f=r.purpose)==null?void 0:f.uuid)||"",requesters:r.requesterType.value=="student"?t:k,images:r.images||[]}),Object.assign(s,R(n)),b.requesters=r.requesterType.value=="student"?t:k,b.isLoaded=!0};return(r,t)=>{const k=u("BaseSelect"),f=u("BaseSelectSearch"),d=u("DatePicker"),A=u("BaseTextarea"),S=u("WebcamCapture"),N=u("MediaUpload"),j=u("FormAction");return p(),$(j,{"pre-requisites":!0,onSetPreRequisites:P,"init-url":q,"init-form":n,form:s,"set-form":H,redirect:"ReceptionGatePass",onResetMediaFiles:h},{default:g(()=>[l("div",L,[l("div",G,[i(k,{modelValue:s.to,"onUpdate:modelValue":t[0]||(t[0]=e=>s.to=e),name:"to",label:r.$trans("reception.gate_pass.props.to"),options:y.to,error:o(a).to,"onUpdate:error":t[1]||(t[1]=e=>o(a).to=e)},null,8,["modelValue","label","options","error"])]),s.to=="student"?(p(),c("div",w,[b.isLoaded?(p(),$(f,{key:0,multiple:"",name:"requesters",label:r.$trans("student.student"),placeholder:r.$trans("global.select",{attribute:r.$trans("student.student")}),modelValue:s.requesters,"onUpdate:modelValue":t[2]||(t[2]=e=>s.requesters=e),error:o(a).requesters,"onUpdate:error":t[3]||(t[3]=e=>o(a).requesters=e),"value-prop":"uuid","init-search":b.requesters,"search-key":"name","search-action":"student/summary"},{selectedOption:g(e=>[V(m(e.value.name)+" ("+m(e.value.courseName+" "+e.value.batchName)+") ",1)]),listOption:g(e=>[V(m(e.option.name)+" ("+m(e.option.courseName+" "+e.option.batchName)+") ",1)]),_:1},8,["label","placeholder","modelValue","error","init-search"])):_("",!0)])):_("",!0),s.to=="employee"?(p(),c("div",M,[b.isLoaded?(p(),$(f,{key:0,multiple:"",name:"requesters",label:r.$trans("employee.employee"),placeholder:r.$trans("global.select",{attribute:r.$trans("employee.employee")}),modelValue:s.requesters,"onUpdate:modelValue":t[4]||(t[4]=e=>s.requesters=e),error:o(a).requesters,"onUpdate:error":t[5]||(t[5]=e=>o(a).requesters=e),"value-prop":"uuid","init-search":b.requesters,"search-key":"name","search-action":"employee/summary","additional-search-query":{type:"all"}},{selectedOption:g(e=>[V(m(e.value.name)+" ("+m(e.value.designation)+") ",1)]),listOption:g(e=>[V(m(e.option.name)+" ("+m(e.option.designation)+") ",1)]),_:1},8,["label","placeholder","modelValue","error","init-search"])):_("",!0)])):_("",!0)]),l("div",E,[l("div",I,[i(k,{modelValue:s.purpose,"onUpdate:modelValue":t[6]||(t[6]=e=>s.purpose=e),name:"purpose",label:r.$trans("reception.gate_pass.props.purpose"),options:y.purposes,"label-prop":"name","value-prop":"uuid",error:o(a).purpose,"onUpdate:error":t[7]||(t[7]=e=>o(a).purpose=e)},null,8,["modelValue","label","options","error"])]),l("div",W,[i(d,{as:"datetime",modelValue:s.startAt,"onUpdate:modelValue":t[8]||(t[8]=e=>s.startAt=e),name:"startAt",label:r.$trans("reception.gate_pass.props.datetime"),"no-clear":"",error:o(a).startAt,"onUpdate:error":t[9]||(t[9]=e=>o(a).startAt=e)},null,8,["modelValue","label","error"])])]),l("div",K,[l("div",z,[i(A,{rows:1,modelValue:s.reason,"onUpdate:modelValue":t[10]||(t[10]=e=>s.reason=e),name:"reason",label:r.$trans("reception.gate_pass.props.reason"),error:o(a).reason,"onUpdate:error":t[11]||(t[11]=e=>o(a).reason=e)},null,8,["modelValue","label","error"])]),l("div",J,[i(A,{rows:1,modelValue:s.remarks,"onUpdate:modelValue":t[12]||(t[12]=e=>s.remarks=e),name:"remarks",label:r.$trans("reception.gate_pass.props.remarks"),error:o(a).remarks,"onUpdate:error":t[13]||(t[13]=e=>o(a).remarks=e)},null,8,["modelValue","label","error"])]),l("div",Q,[i(S,{onCompleted:t[14]||(t[14]=e=>s.images=e)}),l("div",X,[(p(!0),c(F,null,D(s.images,e=>(p(),c("div",{key:e.id},[e.image?(p(),c("img",{key:0,src:e.image},null,8,Y)):_("",!0),e.url?(p(),c("img",{key:1,src:e.url},null,8,Z)):_("",!0)]))),128))])]),l("div",x,[i(N,{multiple:"",label:r.$trans("general.file"),module:"gate_pass",media:s.media,"media-token":s.mediaToken,onIsUpdated:t[15]||(t[15]=e=>s.mediaUpdated=!0),onSetHash:t[16]||(t[16]=e=>s.mediaHash.push(e))},null,8,["label","media","media-token"])])])]),_:1},8,["form"])}}}),se={name:"ReceptionGatePassAction"},ae=Object.assign(se,{setup(O){const v=B();return(n,q)=>{const a=u("PageHeaderAction"),y=u("PageHeader"),s=u("ParentTransition");return p(),c(F,null,[i(y,{title:n.$trans(o(v).meta.trans,{attribute:n.$trans(o(v).meta.label)}),navs:[{label:n.$trans("reception.reception"),path:"Reception"},{label:n.$trans("reception.gate_pass.gate_pass"),path:"ReceptionGatePassList"}]},{default:g(()=>[i(a,{name:"ReceptionGatePass",title:n.$trans("reception.gate_pass.gate_pass"),actions:["list"]},null,8,["title"])]),_:1},8,["title","navs"]),i(s,{appear:"",visibility:!0},{default:g(()=>[i(te)]),_:1})],64)}}});export{ae as default};
