import{u as S,k as x,m as R,I as E,q as j,r as u,t as C,o as w,w as e,d as T,e as t,v as n,x as o,j as W,z,p as B,a as D,f as $,F as O,y as I}from"./app-Cvm44xuh.js";const G={class:"grid grid-cols-3 gap-6"},J={class:"col-span-3 sm:col-span-1"},K={class:"col-span-3 sm:col-span-1"},Q={__name:"Filter",props:{initUrl:{type:String,default:""},preRequisites:{type:Object,default:()=>({})}},emits:["hide"],setup(b,{emit:f}){S(),x("moment");const g=f,y=b,_={route:null,stoppage:null},p=R({..._});E(y.initUrl);const m=R({isLoaded:!0});return j(async()=>{m.isLoaded=!0}),(s,d)=>{const l=u("BaseSelect"),N=u("FilterForm");return w(),C(N,{"init-form":_,multiple:[],form:p,onHide:d[2]||(d[2]=a=>g("hide"))},{default:e(()=>[T("div",G,[T("div",J,[t(l,{name:"route",label:s.$trans("global.select",{attribute:s.$trans("transport.route.route")}),modelValue:p.route,"onUpdate:modelValue":d[0]||(d[0]=a=>p.route=a),"label-prop":"name","value-prop":"uuid",options:b.preRequisites.routes},{selectedOption:e(a=>[n(o(a.value.name)+" "+o(a.value.vehicle.registrationNumber),1)]),listOption:e(a=>[n(o(a.option.name)+" "+o(a.option.vehicle.registrationNumber),1)]),_:1},8,["label","modelValue","options"])]),T("div",K,[t(l,{name:"stoppage",label:s.$trans("global.select",{attribute:s.$trans("transport.stoppage.stoppage")}),modelValue:p.stoppage,"onUpdate:modelValue":d[1]||(d[1]=a=>p.stoppage=a),"label-prop":"name","value-prop":"uuid",options:b.preRequisites.stoppages},{selectedOption:e(a=>[n(o(a.value.name),1)]),listOption:e(a=>[n(o(a.option.name),1)]),_:1},8,["label","modelValue","options"])])])]),_:1},8,["form"])}}},X={name:"TransportReportRouteWiseStudent"},Z=Object.assign(X,{setup(b){const f=S(),g=W();let y=["filter"],_=[];z("transport:export")&&(_=["print","pdf","excel"]);const p="transport/report/",m=B(!1),s=B(!1),d=R({routes:[],stoppages:[]}),l=R({headers:[],data:[],meta:{total:0}}),N=async()=>{s.value=!0,await g.dispatch(p+"preRequisite",{name:"route-wise-student",params:f.query}).then(i=>{s.value=!1,Object.assign(d,i)}).catch(i=>{s.value=!1})},a=async()=>{s.value=!0,await g.dispatch(p+"fetchReport",{name:"route-wise-student",params:f.query}).then(i=>{s.value=!1,Object.assign(l,i)}).catch(i=>{s.value=!1})};return j(async()=>{await N(),await a()}),(i,h)=>{const H=u("PageHeaderAction"),A=u("PageHeader"),q=u("ParentTransition"),c=u("DataCell"),F=u("TextMuted"),U=u("DataRow"),L=u("DataTable"),P=u("BaseCard");return w(),D(O,null,[t(A,{title:i.$trans($(f).meta.label),navs:[{label:i.$trans("transport.transport"),path:"Transport"},{label:i.$trans("transport.report.report"),path:"TransportReport"}]},{default:e(()=>[t(H,{url:"transport/reports/route-wise-student/",name:"TransportReportRouteWiseStudent",title:i.$trans("transport.report.route_wise_student.route_wise_student"),actions:$(y),"dropdown-actions":$(_),headers:l.headers,onToggleFilter:h[0]||(h[0]=r=>m.value=!m.value)},null,8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"]),t(q,{appear:"",visibility:m.value},{default:e(()=>[t(Q,{onAfterFilter:a,"init-url":p,"pre-requisites":d,onHide:h[1]||(h[1]=r=>m.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"]),t(q,{appear:"",visibility:!0},{default:e(()=>[t(P,{"no-padding":"","no-content-padding":"","is-loading":s.value},{default:e(()=>[t(L,{header:l.headers,footer:l.footers,meta:l.meta,module:"transport.report.route_wise_student",onRefresh:a},{default:e(()=>[(w(!0),D(O,null,I(l.data,(r,M)=>(w(),C(U,{key:r.uuid},{default:e(()=>[t(c,{name:"sno"},{default:e(()=>[n(o(l.meta.sno+M),1)]),_:2},1024),t(c,{name:"codeNumber"},{default:e(()=>[n(o(r.codeNumber),1)]),_:2},1024),t(c,{name:"name"},{default:e(()=>[n(o(r.name),1)]),_:2},1024),t(c,{name:"fatherName"},{default:e(()=>[n(o(r.fatherName)+" ",1),t(F,{block:""},{default:e(()=>[n(o(r.contactNumber),1)]),_:2},1024)]),_:2},1024),t(c,{name:"course"},{default:e(()=>[n(o(r.courseName)+" ",1),t(F,{block:""},{default:e(()=>[n(o(r.batchName),1)]),_:2},1024)]),_:2},1024),t(c,{name:"route"},{default:e(()=>{var v;return[n(o((v=r.route)==null?void 0:v.name)+" ",1),t(F,{block:""},{default:e(()=>{var V,k;return[n(o(((k=(V=r.route)==null?void 0:V.vehicle)==null?void 0:k.registrationNumber)||"-"),1)]}),_:2},1024)]}),_:2},1024),t(c,{name:"stoppage"},{default:e(()=>{var v;return[n(o((v=r.stoppage)==null?void 0:v.name),1)]}),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","footer","meta"])]),_:1},8,["is-loading"])]),_:1})],64)}}});export{Z as default};
