import{u as E,k as x,H as T,I as ee,p as oe,m as j,q as te,r as d,a as I,o as b,e as a,w as p,d as i,b as A,f as r,x as m,t as D,v as c,z as ne,F as O,y as re,N as se,K as ae}from"./app-Cvm44xuh.js";import{_ as le}from"./VendorForm-Cf6BVAey.js";const ie={class:"grid grid-cols-3 gap-6"},de={class:"col-span-3 sm:col-span-1"},ue={class:"dark:text-gray-400"},me={class:"mt-4 grid grid-cols-3 gap-6"},pe={class:"col-span-3 sm:col-span-1"},ce={class:"col-span-3 sm:col-span-1"},ve={class:"col-span-3 sm:col-span-1"},ye={class:"col-span-2 sm:col-span-1"},be={class:"col-span-3 sm:col-span-1"},_e={key:0,class:"col-span-3 sm:col-span-1"},ke=["onClick"],$e={class:"mt-4 grid grid-cols-4 gap-4"},fe={class:"col-span-4 sm:col-span-1"},Ve={class:"col-span-4 sm:col-span-1"},he={class:"col-span-4 sm:col-span-1"},ge={class:"col-span-4 sm:col-span-1"},Ue={class:"mt-4"},Be={class:"mt-4 grid grid-cols-1 gap-4"},Pe={class:"col"},Ie={class:"col"},Se={name:"InventoryStockPurchaseForm"},qe=Object.assign(Se,{setup(L){const k=E(),v=x("emitter"),$={hasItems:!0,vendor:"",date:"",voucherNumber:"",place:"",items:[],description:"",media:[],mediaUpdated:!1,mediaToken:T(),mediaHash:[]},f={uuid:T(),item:"",quantity:1,unitPrice:0,amount:"",description:""},S="inventory/stockPurchase/",s=ee(S),V=oe(!1),q=j({inventories:[],vendors:[],places:[]}),F=j({isLoaded:!k.params.uuid}),n=j({...$}),z=t=>{Object.assign(q,t)},K=()=>{n.mediaToken=T(),n.mediaHash=[]},M=()=>{n.items.push({...f,uuid:T()})},G=async t=>{await se()&&(n.items.length==1?n.items=[f]:n.items.splice(t,1))},J=t=>{var w,h,_,N,y,C,g,H;let o=[];t.items.forEach(U=>{o.push({...U,unitPrice:U.unitPrice.value,amount:U.amount.value})}),Object.assign($,{...t,items:o,date:(w=t.date)==null?void 0:w.value,amount:(h=t.total)==null?void 0:h.value,inventory:((_=t.inventory)==null?void 0:_.uuid)||"",vendor:((N=t.vendor)==null?void 0:N.uuid)||"",place:((y=t.place)==null?void 0:y.uuid)||""}),Object.assign(n,ae($)),F.inventory=((C=t.inventory)==null?void 0:C.uuid)||"",F.vendor=((g=t.vendor)==null?void 0:g.uuid)||"",F.place=((H=t.place)==null?void 0:H.uuid)||"",F.isLoaded=!0},Q=t=>{t!=n.inventory&&(n.items=[f])},W=()=>{V.value=!1,v.emit("refreshPreRequisites")};return te(async()=>{k.params.uuid||M()}),(t,o)=>{const w=d("BaseSwitch"),h=d("HelperText"),_=d("BaseSelect"),N=d("DatePicker"),y=d("BaseInput"),C=d("BaseSelectSearch"),g=d("BaseTextarea"),H=d("BaseFieldset"),U=d("BaseBadge"),X=d("MediaUpload"),Y=d("FormAction"),Z=d("BaseModal");return b(),I(O,null,[a(Y,{"pre-requisites":!0,onSetPreRequisites:z,"init-url":S,"init-form":$,form:n,"set-form":J,redirect:"InventoryStockPurchase",onResetMediaFiles:K},{default:p(()=>[i("div",ie,[i("div",de,[a(w,{modelValue:n.hasItems,"onUpdate:modelValue":o[0]||(o[0]=e=>n.hasItems=e),name:"hasItem",label:t.$trans("inventory.stock_purchase.props.has_items"),error:r(s).hasItems,"onUpdate:error":o[1]||(o[1]=e=>r(s).hasItems=e)},null,8,["modelValue","label","error"]),a(h,null,{default:p(()=>[i("span",ue,m(t.$trans("inventory.stock_purchase.has_items_info")),1)]),_:1})])]),i("div",me,[i("div",pe,[a(_,{modelValue:n.inventory,"onUpdate:modelValue":o[2]||(o[2]=e=>n.inventory=e),name:"inventory",label:t.$trans("inventory.inventory"),options:q.inventories,"label-prop":"name","value-prop":"uuid",error:r(s).inventory,"onUpdate:error":o[3]||(o[3]=e=>r(s).inventory=e),onChange:Q},null,8,["modelValue","label","options","error"])]),i("div",ce,[a(_,{modelValue:n.vendor,"onUpdate:modelValue":o[4]||(o[4]=e=>n.vendor=e),name:"vendor",label:t.$trans("inventory.vendor.vendor"),options:q.vendors,"value-prop":"uuid","track-by":["name"],error:r(s).vendor,"onUpdate:error":o[5]||(o[5]=e=>r(s).vendor=e)},{selectedOption:p(e=>[c(m(e.value.name)+" ("+m(e.value.type.name)+") ",1)]),listOption:p(e=>[c(m(e.option.name)+" ("+m(e.option.type.name)+") ",1)]),_:1},8,["modelValue","label","options","error"]),r(ne)("ledger:create")?(b(),D(h,{key:0,cursor:"","text-right":"",onClick:o[6]||(o[6]=e=>V.value=!0)},{default:p(()=>[c(m(t.$trans("global.add",{attribute:t.$trans("inventory.vendor.vendor")})),1)]),_:1})):A("",!0)]),i("div",ve,[a(_,{modelValue:n.place,"onUpdate:modelValue":o[7]||(o[7]=e=>n.place=e),name:"place",label:t.$trans("inventory.place"),options:q.places,"label-prop":"fullName","value-prop":"uuid",error:r(s).place,"onUpdate:error":o[8]||(o[8]=e=>r(s).place=e)},null,8,["modelValue","label","options","error"])]),i("div",ye,[a(N,{modelValue:n.date,"onUpdate:modelValue":o[9]||(o[9]=e=>n.date=e),name:"date",label:t.$trans("inventory.stock_purchase.props.date"),"no-clear":"",error:r(s).date,"onUpdate:error":o[10]||(o[10]=e=>r(s).date=e)},null,8,["modelValue","label","error"])]),i("div",be,[a(y,{type:"text",modelValue:n.voucherNumber,"onUpdate:modelValue":o[11]||(o[11]=e=>n.voucherNumber=e),name:"voucherNumber",label:t.$trans("inventory.stock_purchase.props.voucher_number"),error:r(s).voucherNumber,"onUpdate:error":o[12]||(o[12]=e=>r(s).voucherNumber=e)},null,8,["modelValue","label","error"])]),n.hasItems?A("",!0):(b(),I("div",_e,[a(y,{currency:"",modelValue:n.amount,"onUpdate:modelValue":o[13]||(o[13]=e=>n.amount=e),name:"amount",label:t.$trans("inventory.stock_purchase.props.amount"),error:r(s).amount,"onUpdate:error":o[14]||(o[14]=e=>r(s).amount=e)},null,8,["modelValue","label","error"])]))]),n.inventory&&n.hasItems?(b(),I(O,{key:0},[(b(!0),I(O,null,re(n.items,(e,u)=>(b(),D(H,{class:"mt-4",key:e.uuid},{legend:p(()=>[c(m(t.$trans("inventory.item"))+" "+m(u+1)+". ",1),i("span",{class:"text-danger ml-2 cursor-pointer",onClick:R=>G(u)},o[21]||(o[21]=[i("i",{class:"fas fa-times-circle"},null,-1)]),8,ke)]),default:p(()=>{var R;return[i("div",$e,[i("div",fe,[a(C,{name:`items.${u}.item`,label:t.$trans("global.select",{attribute:t.$trans("inventory.stock_item.stock_item")}),modelValue:e.item,"onUpdate:modelValue":l=>e.item=l,error:r(s)[`items.${u}.item`],"onUpdate:error":l=>r(s)[`items.${u}.item`]=l,"value-prop":"uuid","object-prop":!0,"init-search":(R=e==null?void 0:e.item)==null?void 0:R.name,"init-search-key":"name","search-action":"inventory/stockItem/list","additional-search-query":{inventory:n.inventory}},{selectedOption:p(l=>{var B,P;return[c(m(l.value.name)+" "+m((P=(B=l.value)==null?void 0:B.category)==null?void 0:P.name),1)]}),listOption:p(l=>{var B,P;return[c(m(l.option.name)+" "+m((P=(B=l.option)==null?void 0:B.category)==null?void 0:P.name),1)]}),_:2},1032,["name","label","modelValue","onUpdate:modelValue","error","onUpdate:error","init-search","additional-search-query"])]),i("div",Ve,[a(y,{type:"number",step:.01,modelValue:e.quantity,"onUpdate:modelValue":l=>e.quantity=l,name:`items.${u}.quantity`,label:t.$trans("inventory.stock_purchase.props.quantity"),error:r(s)[`items.${u}.quantity`],"onUpdate:error":l=>r(s)[`items.${u}.quantity`]=l},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])]),i("div",he,[a(y,{currency:"",modelValue:e.unitPrice,"onUpdate:modelValue":l=>e.unitPrice=l,name:`items.${u}.unitPrice`,label:t.$trans("inventory.stock_purchase.props.unit_price"),error:r(s)[`items.${u}.unitPrice`],"onUpdate:error":l=>r(s)[`items.${u}.unitPrice`]=l},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])]),i("div",ge,[a(g,{rows:1,modelValue:e.description,"onUpdate:modelValue":l=>e.description=l,name:`items.${u}.description`,label:t.$trans("inventory.stock_purchase.props.description"),error:r(s)[`items.${u}.description`],"onUpdate:error":l=>r(s)[`items.${u}.description`]=l},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])])])]}),_:2},1024))),128)),i("div",Ue,[a(U,{design:"primary",onClick:M,class:"cursor-pointer"},{default:p(()=>[c(m(t.$trans("global.add",{attribute:t.$trans("inventory.stock_item.stock_item")})),1)]),_:1})])],64)):A("",!0),i("div",Be,[i("div",Pe,[a(g,{rows:1,modelValue:n.description,"onUpdate:modelValue":o[15]||(o[15]=e=>n.description=e),name:"description",label:t.$trans("inventory.stock_purchase.props.description"),error:r(s).description,"onUpdate:error":o[16]||(o[16]=e=>r(s).description=e)},null,8,["modelValue","label","error"])]),i("div",Ie,[a(X,{multiple:"",label:t.$trans("general.file"),module:"stock_purchase",media:n.media,"media-token":n.mediaToken,onIsUpdated:o[17]||(o[17]=e=>n.mediaUpdated=!0),onSetHash:o[18]||(o[18]=e=>n.mediaHash.push(e))},null,8,["label","media","media-token"])])])]),_:1},8,["form"]),a(Z,{show:V.value,onClose:o[20]||(o[20]=e=>V.value=!1)},{title:p(()=>[c(m(t.$trans("global.add",{attribute:t.$trans("inventory.vendor.vendor")})),1)]),default:p(()=>[a(le,{"is-modal":!0,"after-submit":W,onCancelled:o[19]||(o[19]=e=>V.value=!1)})]),_:1},8,["show"])],64)}}}),Fe={name:"InventoryStockPurchaseAction"},Ce=Object.assign(Fe,{setup(L){const k=E();return(v,$)=>{const f=d("PageHeaderAction"),S=d("PageHeader"),s=d("ParentTransition");return b(),I(O,null,[a(S,{title:v.$trans(r(k).meta.trans,{attribute:v.$trans(r(k).meta.label)}),navs:[{label:v.$trans("inventory.inventory"),path:"Inventory"},{label:v.$trans("inventory.stock_purchase.stock_purchase"),path:"InventoryStockPurchaseList"}]},{default:p(()=>[a(f,{name:"InventoryStockPurchase",title:v.$trans("inventory.stock_purchase.stock_purchase"),actions:["list"]},null,8,["title"])]),_:1},8,["title","navs"]),a(s,{appear:"",visibility:!0},{default:p(()=>[a(qe)]),_:1})],64)}}});export{Ce as default};
