import{u as L,m as U,q as Z,r as d,t as b,o as m,w as s,d as v,b as $,e as l,v as c,x as u,i as x,k as ee,z as C,p as te,L as ae,f as y,a as se,F as le,y as ne}from"./app-Cvm44xuh.js";import{u as oe}from"./useColumnVisibility-BfQRdpHQ.js";import{i as ie,t as re,a as ue}from"./table-FwhM-Z75.js";import{_ as de}from"./ModuleDropdown-BnDDJB3K.js";const me={class:"grid grid-cols-3 gap-6"},pe={class:"col-span-3 sm:col-span-1"},ye={class:"col-span-3 sm:col-span-1"},ce={class:"col-span-3 sm:col-span-1"},be={class:"col-span-3 sm:col-span-1"},fe={class:"col-span-3 sm:col-span-1"},ge={class:"col-span-3 sm:col-span-1"},ve={class:"col-span-3 sm:col-span-1"},$e={class:"col-span-3 sm:col-span-1"},ke={class:"col-span-3 sm:col-span-1"},_e={class:"grid grid-cols-3 gap-6"},De={class:"col-span-3 flex gap-2"},qe={class:"grid grid-cols-3 gap-6"},Se={class:"col-span-3 sm:col-span-1"},Ve={class:"col-span-3 sm:col-span-1"},Be={class:"col-span-3 sm:col-span-1"},Ae={__name:"Filter",props:{preRequisites:{type:Object,required:!0}},emits:["hide"],setup(h,{emit:g}){const f=L(),A=g,P={codeNumber:"",employees:[],departments:[],designations:[],employmentStatuses:[],startDate:"",endDate:"",salaryStartDate:"",salaryEndDate:"",status:"",batchUuid:"",inclusions:["code_number","designation","attendance","earning_component","deduction_component","employer_contribution","net_salary","total_expense","signature"],paymentAdvicePeriod:"",paymentAdviceBankDetails:"",paymentAdviceAccountDetails:""},e=U({...P}),k=U({employees:[],departments:[],designations:[],employmentStatuses:[],isLoaded:!(f.query.employees||f.query.departments||f.query.designations||f.query.employmentStatuses)});return Z(async()=>{k.departments=f.query.departments?f.query.departments.split(","):[],k.designations=f.query.designations?f.query.designations.split(","):[],k.employmentStatuses=f.query.employmentStatuses?f.query.employmentStatuses.split(","):[],k.employees=f.query.employees?f.query.employees.split(","):[],e.inclusions=f.query.inclusions?f.query.inclusions.split(","):[],k.isLoaded=!0}),(r,a)=>{const V=d("BaseInput"),D=d("BaseSelectSearch"),p=d("DatePicker"),I=d("BaseSelect"),_=d("BaseArrayCheckbox"),E=d("BaseFieldset"),F=d("FilterForm");return m(),b(F,{"init-form":P,form:e,multiple:["employees","departments","designations","employmentStatuses"],onHide:a[23]||(a[23]=t=>A("hide"))},{default:s(()=>[v("div",me,[v("div",pe,[l(V,{type:"text",modelValue:e.codeNumber,"onUpdate:modelValue":a[0]||(a[0]=t=>e.codeNumber=t),name:"codeNumber",label:r.$trans("employee.payroll.props.code_number")},null,8,["modelValue","label"])]),v("div",ye,[k.isLoaded?(m(),b(D,{key:0,multiple:"",name:"employees",label:r.$trans("global.select",{attribute:r.$trans("employee.employee")}),modelValue:e.employees,"onUpdate:modelValue":a[1]||(a[1]=t=>e.employees=t),"value-prop":"uuid","init-search":k.employees,"additional-search-query":{type:"all"},"search-key":"name","search-action":"employee/list"},{selectedOption:s(t=>[c(u(t.value.name)+" ("+u(t.value.codeNumber)+") ",1)]),listOption:s(t=>[c(u(t.option.name)+" ("+u(t.option.codeNumber)+") ",1)]),_:1},8,["label","modelValue","init-search"])):$("",!0)]),v("div",ce,[k.isLoaded?(m(),b(D,{key:0,multiple:"",name:"departments",label:r.$trans("global.select",{attribute:r.$trans("employee.department.department")}),modelValue:e.departments,"onUpdate:modelValue":a[2]||(a[2]=t=>e.departments=t),"value-prop":"uuid","init-search":k.departments,"search-action":"employee/department/list"},null,8,["label","modelValue","init-search"])):$("",!0)]),v("div",be,[k.isLoaded?(m(),b(D,{key:0,multiple:"",name:"designations",label:r.$trans("global.select",{attribute:r.$trans("employee.designation.designation")}),modelValue:e.designations,"onUpdate:modelValue":a[3]||(a[3]=t=>e.designations=t),"value-prop":"uuid","init-search":k.designations,"search-action":"employee/designation/list"},null,8,["label","modelValue","init-search"])):$("",!0)]),v("div",fe,[k.isLoaded?(m(),b(D,{key:0,multiple:"",name:"employmentStatuses",label:r.$trans("global.select",{attribute:r.$trans("employee.employment_status.employment_status")}),modelValue:e.employmentStatuses,"onUpdate:modelValue":a[4]||(a[4]=t=>e.employmentStatuses=t),"value-prop":"uuid","init-search":k.employmentStatuses,"search-action":"option/list","additional-search-query":{type:"employment_status"}},null,8,["label","modelValue","init-search"])):$("",!0)]),v("div",ge,[l(p,{start:e.startDate,"onUpdate:start":a[5]||(a[5]=t=>e.startDate=t),end:e.endDate,"onUpdate:end":a[6]||(a[6]=t=>e.endDate=t),name:"dateBetween",as:"range",label:r.$trans("general.date_between")},null,8,["start","end","label"])]),v("div",ve,[l(p,{start:e.salaryStartDate,"onUpdate:start":a[7]||(a[7]=t=>e.salaryStartDate=t),end:e.salaryEndDate,"onUpdate:end":a[8]||(a[8]=t=>e.salaryEndDate=t),name:"dateBetween",as:"range",label:r.$trans("employee.payroll.props.salary_period")},null,8,["start","end","label"])]),v("div",$e,[l(I,{modelValue:e.status,"onUpdate:modelValue":a[9]||(a[9]=t=>e.status=t),name:"status",label:r.$trans("employee.payroll.props.status"),options:h.preRequisites.statuses},null,8,["modelValue","label","options"])]),v("div",ke,[l(V,{type:"text",modelValue:e.batchUuid,"onUpdate:modelValue":a[10]||(a[10]=t=>e.batchUuid=t),name:"batchUuid",label:r.$trans("employee.payroll.props.batch_uuid")},null,8,["modelValue","label"])])]),e.salaryStartDate&&e.salaryEndDate&&k.isLoaded?(m(),b(E,{key:0,class:"mt-4"},{legend:s(()=>[c(u(r.$trans("employee.payroll.salary_sheet")),1)]),default:s(()=>[v("div",_e,[v("div",De,[l(_,{items:e.inclusions,"onUpdate:items":a[11]||(a[11]=t=>e.inclusions=t),value:"code_number",label:r.$trans("employee.props.code_number")},null,8,["items","label"]),l(_,{items:e.inclusions,"onUpdate:items":a[12]||(a[12]=t=>e.inclusions=t),value:"designation",label:r.$trans("employee.designation.designation")},null,8,["items","label"]),l(_,{items:e.inclusions,"onUpdate:items":a[13]||(a[13]=t=>e.inclusions=t),value:"attendance",label:r.$trans("employee.attendance.attendance")},null,8,["items","label"]),l(_,{items:e.inclusions,"onUpdate:items":a[14]||(a[14]=t=>e.inclusions=t),value:"earning_component",label:r.$trans("employee.payroll.variables.earning_component")},null,8,["items","label"]),l(_,{items:e.inclusions,"onUpdate:items":a[15]||(a[15]=t=>e.inclusions=t),value:"deduction_component",label:r.$trans("employee.payroll.variables.deduction_component")},null,8,["items","label"]),l(_,{items:e.inclusions,"onUpdate:items":a[16]||(a[16]=t=>e.inclusions=t),value:"employer_contribution",label:r.$trans("employee.payroll.variables.employer_contribution")},null,8,["items","label"]),l(_,{items:e.inclusions,"onUpdate:items":a[17]||(a[17]=t=>e.inclusions=t),value:"net_salary",label:r.$trans("employee.payroll.variables.net_salary")},null,8,["items","label"]),l(_,{items:e.inclusions,"onUpdate:items":a[18]||(a[18]=t=>e.inclusions=t),value:"total_expense",label:r.$trans("employee.payroll.variables.total_expense")},null,8,["items","label"]),l(_,{items:e.inclusions,"onUpdate:items":a[19]||(a[19]=t=>e.inclusions=t),value:"signature",label:r.$trans("employee.signature")},null,8,["items","label"])])])]),_:1})):$("",!0),e.salaryStartDate&&e.salaryEndDate&&e.status=="processed"?(m(),b(E,{key:1,class:"mt-4"},{legend:s(()=>[c(u(r.$trans("employee.payroll.payment_advice")),1)]),default:s(()=>[v("div",qe,[v("div",Se,[l(V,{type:"text",modelValue:e.paymentAdvicePeriod,"onUpdate:modelValue":a[20]||(a[20]=t=>e.paymentAdvicePeriod=t),name:"paymentAdvicePeriod",label:r.$trans("employee.payroll.props.payment_advice_period")},null,8,["modelValue","label"])]),v("div",Ve,[l(V,{type:"text",modelValue:e.paymentAdviceBankDetails,"onUpdate:modelValue":a[21]||(a[21]=t=>e.paymentAdviceBankDetails=t),name:"paymentAdviceBankDetails",label:r.$trans("employee.payroll.props.bank_details")},null,8,["modelValue","label"])]),v("div",Be,[l(V,{type:"text",modelValue:e.paymentAdviceAccountDetails,"onUpdate:modelValue":a[22]||(a[22]=t=>e.paymentAdviceAccountDetails=t),name:"paymentAdviceAccountDetails",label:r.$trans("employee.payroll.props.account_details")},null,8,["modelValue","label"])])])]),_:1})):$("",!0)]),_:1},8,["form"])}}},Ce={class:"text-danger"},Ue={class:"text-success font-semibold"},we={name:"EmployeePayrollList"},he=Object.assign(we,{setup(h){const g=L(),f=x(),A=ee("emitter"),{applyVisibility:P}=oe("EmployeePayroll");let e=["filter"];C("payroll:create")&&e.unshift("create"),C("payroll:config")&&e.unshift("config");let k=[];C("payroll:export")&&(k=["print","pdf","excel"]);const r="employee/payroll/",a=te(!1),V=U({statuses:[]}),D=U({}),p=U({...ie}),I=U({selectAll:!1,selectedPayrolls:[]}),_=n=>{n.headers=P(n.headers),Object.assign(D,n),p.pageItems=D.data.map(i=>i.uuid)},E=n=>{Object.assign(V,n)},F=()=>{!g.query.salaryStartDate||!g.query.salaryEndDate||window.open("/app/employee/payrolls/salary-sheet/export?"+Object.entries(g.query).map(([n,i])=>`${n}=${i}`).join("&"))},t=n=>{A.emit("actionItem",{uuid:n.uuid,action:"process",confirmation:!0})},R=()=>{!g.query.salaryStartDate||!g.query.salaryEndDate||window.open("/app/employee/payrolls/bulk-export?"+Object.entries(g.query).map(([n,i])=>`${n}=${i}`).join("&"))},O=n=>{window.open(`/app/employee/payrolls/${n.uuid}/export?action=print`)},T=()=>{if(!g.query.salaryStartDate||!g.query.salaryEndDate&&!g.query.status=="processed")return;let n=Object.entries(g.query).filter(([i,B])=>!i.includes("inclusions")).map(([i,B])=>`${i}=${B}`).join("&");window.open(`/app/employee/payrolls/payment-advice/export?action=print&items=${p.items.join(",")}&`+n)};return ae(()=>[p.items,p.pageItems],([n,i],[B,N])=>{I.selectedPayrolls=n,p.all=ue(p)}),(n,i)=>{const B=d("DropdownItem"),N=d("PageHeaderAction"),M=d("PageHeader"),j=d("ParentTransition"),H=d("BaseArrayCheckbox"),z=d("BaseCheckbox"),q=d("DataCell"),G=d("BaseBadge"),J=d("TextMuted"),w=d("FloatingMenuItem"),K=d("FloatingMenu"),Q=d("DataRow"),W=d("BaseButton"),X=d("DataTable"),Y=d("ListItem");return m(),b(Y,{"init-url":r,"pre-requisites":!0,onSetPreRequisites:E,onSetItems:_},{header:s(()=>[l(M,{title:n.$trans("employee.payroll.payroll"),navs:[{label:n.$trans("employee.employee"),path:"Employee"}]},{default:s(()=>[l(N,{url:"employee/payrolls/",name:"EmployeePayroll",title:n.$trans("employee.payroll.payroll"),actions:y(e),"dropdown-actions":y(k),onToggleFilter:i[1]||(i[1]=o=>a.value=!a.value)},{moduleOption:s(()=>[l(de)]),dropdown:s(()=>[l(B,{icon:"fas fa-users",onClick:i[0]||(i[0]=o=>y(f).push({name:"EmployeePayrollProcess"}))},{default:s(()=>[c(u(n.$trans("employee.payroll.process")),1)]),_:1}),y(g).query.salaryStartDate&&y(g).query.salaryEndDate&&y(g).query.status=="processed"&&p.items.length>0?(m(),b(B,{key:0,icon:"fas fa-file-alt",onClick:T},{default:s(()=>[c(u(n.$trans("employee.payroll.payment_advice")),1)]),_:1})):$("",!0),y(g).query.salaryStartDate&&y(g).query.salaryEndDate?(m(),b(B,{key:1,icon:"fas fa-file-lines",onClick:F},{default:s(()=>[c(u(n.$trans("global.print",{attribute:n.$trans("employee.payroll.salary_sheet")})),1)]),_:1})):$("",!0),y(g).query.salaryStartDate&&y(g).query.salaryEndDate?(m(),b(B,{key:2,icon:"far fa-square-check",onClick:R},{default:s(()=>[c(u(n.$trans("global.bulk_print",{attribute:n.$trans("employee.payroll.salary_slip")})),1)]),_:1})):$("",!0)]),_:1},8,["title","actions","dropdown-actions"])]),_:1},8,["title","navs"])]),filter:s(()=>[l(j,{appear:"",visibility:a.value},{default:s(()=>[l(Ae,{onRefresh:i[2]||(i[2]=o=>y(A).emit("listItems")),"pre-requisites":V,onHide:i[3]||(i[3]=o=>a.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"])]),default:s(()=>[l(j,{appear:"",visibility:!0},{default:s(()=>[l(X,{onToggleSelectAll:i[7]||(i[7]=o=>p.items=y(re)(o,p)),onToggleGlobalSelect:i[8]||(i[8]=o=>p.global=!p.global),selected:p,header:D.headers,meta:D.meta,module:"employee.payroll",onRefresh:i[9]||(i[9]=o=>y(A).emit("listItems"))},{actionButton:s(()=>[y(C)("payroll:create")?(m(),b(W,{key:0,onClick:i[6]||(i[6]=o=>y(f).push({name:"EmployeePayrollCreate"}))},{default:s(()=>[c(u(n.$trans("global.add",{attribute:n.$trans("employee.payroll.payroll")})),1)]),_:1})):$("",!0)]),default:s(()=>[(m(!0),se(le,null,ne(D.data,o=>(m(),b(Q,{key:o.uuid,onDoubleClick:S=>y(f).push({name:"EmployeePayrollShow",params:{uuid:o.uuid}})},{default:s(()=>[l(q,{name:"selectAll"},{default:s(()=>[p.global?$("",!0):(m(),b(H,{key:0,items:p.items,"onUpdate:items":i[4]||(i[4]=S=>p.items=S),value:o.uuid},null,8,["items","value"])),p.global?(m(),b(z,{key:1,modelValue:p.global,"onUpdate:modelValue":i[5]||(i[5]=S=>p.global=S)},null,8,["modelValue"])):$("",!0)]),_:2},1024),l(q,{name:"codeNumber"},{default:s(()=>[c(u(o.codeNumber)+" ",1),l(G,{design:o.status.color},{default:s(()=>[c(u(o.status.label),1)]),_:2},1032,["design"]),o.errorMessage?(m(),b(J,{key:0,block:""},{default:s(()=>[v("span",Ce,u(o.errorMessage),1)]),_:2},1024)):$("",!0)]),_:2},1024),l(q,{name:"employee"},{default:s(()=>[c(u(o.employee.name)+" ("+u(o.employee.codeNumber)+") ",1)]),_:2},1024),l(q,{name:"designation"},{default:s(()=>[c(u(o.employee.designation),1)]),_:2},1024),l(q,{name:"startDate"},{default:s(()=>[c(u(o.startDate.formatted),1)]),_:2},1024),l(q,{name:"endDate"},{default:s(()=>[c(u(o.endDate.formatted),1)]),_:2},1024),l(q,{name:"total"},{default:s(()=>[v("span",Ue,u(o.total.formatted),1)]),_:2},1024),l(q,{name:"createdAt"},{default:s(()=>[c(u(o.createdAt.formatted),1)]),_:2},1024),l(q,{name:"action"},{default:s(()=>[l(K,null,{default:s(()=>[o.isProcessed?(m(),b(w,{key:0,icon:"fas fa-print",onClick:S=>O(o)},{default:s(()=>[c(u(n.$trans("general.print")),1)]),_:2},1032,["onClick"])):$("",!0),o.isProcessed?(m(),b(w,{key:1,icon:"fas fa-arrow-circle-right",onClick:S=>y(f).push({name:"EmployeePayrollShow",params:{uuid:o.uuid}})},{default:s(()=>[c(u(n.$trans("general.show")),1)]),_:2},1032,["onClick"])):$("",!0),o.status.value=="initiated"?(m(),b(w,{key:2,icon:"fas fa-arrow-circle-right",onClick:S=>t(o)},{default:s(()=>[c(u(n.$trans("general.process")),1)]),_:2},1032,["onClick"])):$("",!0),y(C)("payroll:edit")&&o.status.value=="processed"?(m(),b(w,{key:3,icon:"fas fa-edit",onClick:S=>y(f).push({name:"EmployeePayrollEdit",params:{uuid:o.uuid}})},{default:s(()=>[c(u(n.$trans("general.edit")),1)]),_:2},1032,["onClick"])):$("",!0),y(C)("payroll:delete")?(m(),b(w,{key:4,icon:"fas fa-trash",onClick:S=>y(A).emit("deleteItem",{uuid:o.uuid})},{default:s(()=>[c(u(n.$trans("general.delete")),1)]),_:2},1032,["onClick"])):$("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onDoubleClick"]))),128))]),_:1},8,["selected","header","meta"])]),_:1})]),_:1})}}});export{he as default};
