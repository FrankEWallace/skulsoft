import{u as B,H as N,I,c as O,m as k,r as d,t as R,o as v,w as L,d as l,a as $,e as s,f as o,F as h,y as A,J as w,K as F}from"./app-Cvm44xuh.js";const J={class:"grid grid-cols-3 gap-6"},K={class:"col-span-3 sm:col-span-2"},z={class:"col-span-3 sm:col-span-1"},G={class:"mt-4 grid grid-cols-3 gap-6"},Q={class:"col-span-3 sm:col-span-1"},W={class:"col-span-2 sm:col-span-1"},X={class:"mt-4 grid grid-cols-3 gap-6"},Y={class:"col-span-3 sm:col-span-1"},Z={class:"col-span-3 sm:col-span-1"},x={class:"mt-4 grid grid-cols-3 gap-6"},ee={class:"col-span-3 sm:col-span-1"},re={class:"col-span-3"},ae={class:"col-span-3"},te={class:"grid grid-cols-1"},ne={class:"col"},oe={name:"FinanceTransactionForm"},se=Object.assign(oe,{setup(P){const b=B(),m={type:"",category:"",primaryLedger:{},date:"",records:[{secondaryLedger:{},amount:""}],paymentMethod:"",instrumentNumber:"",instrumentDate:"",clearingDate:"",bankDetail:"",referenceNumber:"",description:"",remarks:"",media:[],mediaUpdated:!1,mediaToken:N(),mediaHash:[]},V="finance/transaction/",n=I(V),D=O(()=>a.paymentMethod?p.paymentMethods.find(t=>t.uuid===a.paymentMethod):{}),p=k({types:[],categories:[],paymentMethods:[],primaryLedgers:[]}),a=k({...m}),_=k({primaryLedger:"",secondaryLedger:"",isLoaded:!b.params.uuid}),T=t=>{Object.assign(p,t),Object.assign(a,F(m))},H=()=>{a.mediaToken=N(),a.mediaHash=[]},j=t=>{var c,y,f;let r=[];t.records.forEach(U=>{r.push({secondaryLedger:U.ledger,amount:U.amount.value})});let i=t.payments[0]||{};Object.assign(m,{...t,records:r,category:((c=t.category)==null?void 0:c.uuid)||"",type:t.type.value,primaryLedger:i==null?void 0:i.ledger,paymentMethod:i==null?void 0:i.methodUuid,date:t.date.value,instrumentNumber:i.instrumentNumber||"",instrumentDate:((y=i.instrumentDate)==null?void 0:y.value)||"",clearingDate:((f=i.clearingDate)==null?void 0:f.value)||"",bankDetail:i.bankDetail||"",referenceNumber:i.referenceNumber||""}),Object.assign(a,F(m)),_.isLoaded=!0};return(t,r)=>{const i=d("CustomCheckbox"),c=d("BaseSelect"),y=d("LedgerBalance"),f=d("DatePicker"),U=d("BaseSelectSearch"),S=d("BaseInput"),E=d("PaymentMethodInput"),M=d("BaseTextarea"),q=d("MediaUpload"),C=d("FormAction");return v(),R(C,{"pre-requisites":!0,onSetPreRequisites:T,"init-url":V,"init-form":m,form:a,"set-form":j,redirect:"FinanceTransaction",onResetMediaFiles:H},{default:L(()=>[l("div",J,[l("div",K,[s(i,{disabled:!!o(b).params.uuid,label:t.$trans("finance.transaction.props.type"),options:p.types,modelValue:a.type,"onUpdate:modelValue":r[0]||(r[0]=e=>a.type=e),error:o(n).type,"onUpdate:error":r[1]||(r[1]=e=>o(n).type=e)},null,8,["disabled","label","options","modelValue","error"])]),l("div",z,[s(c,{name:"category",label:t.$trans("global.select",{attribute:t.$trans("finance.transaction.category.category")}),"label-prop":"name","value-prop":"uuid",modelValue:a.category,"onUpdate:modelValue":r[2]||(r[2]=e=>a.category=e),options:p.categories,error:o(n).category,"onUpdate:error":r[3]||(r[3]=e=>o(n).category=e)},null,8,["label","modelValue","options","error"])])]),l("div",G,[l("div",Q,[s(c,{modelValue:a.primaryLedger,"onUpdate:modelValue":r[4]||(r[4]=e=>a.primaryLedger=e),name:"primaryLedger",label:t.$trans("global.select",{attribute:t.$trans("finance.ledger.ledger")}),"object-prop":!0,"label-prop":"name","value-prop":"uuid",options:p.primaryLedgers,error:o(n).primaryLedger,"onUpdate:error":r[5]||(r[5]=e=>o(n).primaryLedger=e)},null,8,["modelValue","label","options","error"]),s(y,{label:!0,ledger:a.primaryLedger},null,8,["ledger"])]),l("div",W,[s(f,{modelValue:a.date,"onUpdate:modelValue":r[6]||(r[6]=e=>a.date=e),name:"date",label:t.$trans("finance.transaction.props.date"),"no-clear":"",error:o(n).date,"onUpdate:error":r[7]||(r[7]=e=>o(n).date=e)},null,8,["modelValue","label","error"])])]),(v(!0),$(h,null,A(a.records,(e,g)=>(v(),$("div",X,[l("div",Y,[s(U,{name:`records.${g}.secondaryLedger`,label:t.$trans("global.select",{attribute:t.$trans("finance.ledger.secondary_ledger")}),modelValue:e.secondaryLedger,"onUpdate:modelValue":u=>e.secondaryLedger=u,error:o(n)[`records.${g}.secondaryLedger.uuid`],"onUpdate:error":u=>o(n)[`records.${g}.secondaryLedger.uuid`]=u,"object-prop":!0,"label-prop":"name","value-prop":"uuid","init-search":_.secondaryLedger,"search-action":"finance/ledger/list","additional-search-query":{subType:a.type=="transfer"?"primary":"secondary"}},null,8,["name","label","modelValue","onUpdate:modelValue","error","onUpdate:error","init-search","additional-search-query"]),s(y,{label:!0,ledger:e.secondaryLedger},null,8,["ledger"])]),l("div",Z,[s(S,{currency:"",type:"text",modelValue:e.amount,"onUpdate:modelValue":u=>e.amount=u,name:`records.${g}.amount`,label:t.$trans("finance.transaction.props.amount"),error:o(n)[`records.${g}.amount`],"onUpdate:error":u=>o(n)[`records.${g}.amount`]=u},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])])]))),256)),l("div",x,[l("div",ee,[s(c,{modelValue:a.paymentMethod,"onUpdate:modelValue":r[8]||(r[8]=e=>a.paymentMethod=e),name:"paymentMethod",label:t.$trans("finance.payment_method.payment_method"),"label-prop":"name","value-prop":"uuid",options:p.paymentMethods,error:o(n).paymentMethod,"onUpdate:error":r[9]||(r[9]=e=>o(n).paymentMethod=e)},null,8,["modelValue","label","options","error"])]),s(E,{"selected-payment-method":D.value,instrumentNumber:a.instrumentNumber,"onUpdate:instrumentNumber":r[10]||(r[10]=e=>a.instrumentNumber=e),instrumentDate:a.instrumentDate,"onUpdate:instrumentDate":r[11]||(r[11]=e=>a.instrumentDate=e),clearingDate:a.clearingDate,"onUpdate:clearingDate":r[12]||(r[12]=e=>a.clearingDate=e),bankDetail:a.bankDetail,"onUpdate:bankDetail":r[13]||(r[13]=e=>a.bankDetail=e),referenceNumber:a.referenceNumber,"onUpdate:referenceNumber":r[14]||(r[14]=e=>a.referenceNumber=e),formErrors:o(n),"onUpdate:formErrors":r[15]||(r[15]=e=>w(n)?n.value=e:null)},null,8,["selected-payment-method","instrumentNumber","instrumentDate","clearingDate","bankDetail","referenceNumber","formErrors"]),l("div",re,[s(M,{rows:1,modelValue:a.description,"onUpdate:modelValue":r[16]||(r[16]=e=>a.description=e),name:"description",label:t.$trans("finance.transaction.props.description"),error:o(n).description,"onUpdate:error":r[17]||(r[17]=e=>o(n).description=e)},null,8,["modelValue","label","error"])]),l("div",ae,[s(M,{rows:1,modelValue:a.remarks,"onUpdate:modelValue":r[18]||(r[18]=e=>a.remarks=e),name:"remarks",label:t.$trans("finance.transaction.props.remarks"),error:o(n).remarks,"onUpdate:error":r[19]||(r[19]=e=>o(n).remarks=e)},null,8,["modelValue","label","error"])])]),l("div",te,[l("div",ne,[s(q,{multiple:"",label:t.$trans("general.file"),module:"transaction",media:a.media,"media-token":a.mediaToken,onIsUpdated:r[20]||(r[20]=e=>a.mediaUpdated=!0),onSetHash:r[21]||(r[21]=e=>a.mediaHash.push(e))},null,8,["label","media","media-token"])])])]),_:1},8,["form"])}}}),le={name:"FinanceTransactionAction"},de=Object.assign(le,{setup(P){const b=B();return(m,V)=>{const n=d("PageHeaderAction"),D=d("PageHeader"),p=d("ParentTransition");return v(),$(h,null,[s(D,{title:m.$trans(o(b).meta.trans,{attribute:m.$trans(o(b).meta.label)}),navs:[{label:m.$trans("finance.finance"),path:"Finance"},{label:m.$trans("finance.transaction.transaction"),path:"FinanceTransactionList"}]},{default:L(()=>[s(n,{name:"FinanceTransaction",title:m.$trans("finance.transaction.transaction"),actions:["list"]},null,8,["title"])]),_:1},8,["title","navs"]),s(p,{appear:"",visibility:!0},{default:L(()=>[s(se)]),_:1})],64)}}});export{de as default};
