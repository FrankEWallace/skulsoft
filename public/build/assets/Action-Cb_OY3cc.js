import{u as E,k as x,H,I as ee,p as te,m as j,q as oe,r as d,a as S,o as b,e as a,w as p,d as i,b as A,f as r,x as m,t as D,v as c,z as ne,F as T,y as re,N as se,K as ae}from"./app-Cvm44xuh.js";import{_ as le}from"./VendorForm-Cf6BVAey.js";const ie={class:"grid grid-cols-3 gap-6"},de={class:"col-span-3 sm:col-span-1"},ue={class:"dark:text-gray-400"},me={class:"mt-4 grid grid-cols-3 gap-6"},pe={class:"col-span-3 sm:col-span-1"},ce={class:"col-span-3 sm:col-span-1"},ve={class:"col-span-3 sm:col-span-1"},ye={class:"col-span-2 sm:col-span-1"},be={class:"col-span-3 sm:col-span-1"},_e={key:0,class:"col-span-3 sm:col-span-1"},ke=["onClick"],$e={class:"mt-4 grid grid-cols-4 gap-4"},fe={class:"col-span-4 sm:col-span-1"},Ve={class:"col-span-4 sm:col-span-1"},ge={class:"col-span-4 sm:col-span-1"},Ue={class:"col-span-4 sm:col-span-1"},he={class:"mt-4"},Be={class:"mt-4 grid grid-cols-1 gap-4"},Ie={class:"col"},Se={class:"col"},qe={name:"InventoryStockReturnForm"},Pe=Object.assign(qe,{setup(L){const k=E(),v=x("emitter"),$={hasItems:!0,vendor:"",date:"",voucherNumber:"",place:"",items:[],description:"",media:[],mediaUpdated:!1,mediaToken:H(),mediaHash:[]},f={uuid:H(),item:"",quantity:1,unitPrice:0,amount:"",description:""},q="inventory/stockReturn/",s=ee(q),V=te(!1),P=j({inventories:[],vendors:[],places:[]}),R=j({isLoaded:!k.params.uuid}),n=j({...$}),z=o=>{Object.assign(P,o)},K=()=>{n.mediaToken=H(),n.mediaHash=[]},M=()=>{n.items.push({...f,uuid:H()})},G=async o=>{await se()&&(n.items.length==1?n.items=[f]:n.items.splice(o,1))},J=o=>{var F,g,_,w,y,N,U,C;let t=[];o.items.forEach(h=>{t.push({...h,unitPrice:h.unitPrice.value,amount:h.amount.value})}),Object.assign($,{...o,items:t,date:(F=o.date)==null?void 0:F.value,amount:(g=o.total)==null?void 0:g.value,inventory:((_=o.inventory)==null?void 0:_.uuid)||"",vendor:((w=o.vendor)==null?void 0:w.uuid)||"",place:((y=o.place)==null?void 0:y.uuid)||""}),Object.assign(n,ae($)),R.inventory=((N=o.inventory)==null?void 0:N.uuid)||"",R.vendor=((U=o.vendor)==null?void 0:U.uuid)||"",R.place=((C=o.place)==null?void 0:C.uuid)||"",R.isLoaded=!0},Q=o=>{o!=n.inventory&&(n.items=[f])},W=()=>{V.value=!1,v.emit("refreshPreRequisites")};return oe(async()=>{k.params.uuid||M()}),(o,t)=>{const F=d("BaseSwitch"),g=d("HelperText"),_=d("BaseSelect"),w=d("DatePicker"),y=d("BaseInput"),N=d("BaseSelectSearch"),U=d("BaseTextarea"),C=d("BaseFieldset"),h=d("BaseBadge"),X=d("MediaUpload"),Y=d("FormAction"),Z=d("BaseModal");return b(),S(T,null,[a(Y,{"pre-requisites":!0,onSetPreRequisites:z,"init-url":q,"init-form":$,form:n,"set-form":J,redirect:"InventoryStockReturn",onResetMediaFiles:K},{default:p(()=>[i("div",ie,[i("div",de,[a(F,{modelValue:n.hasItems,"onUpdate:modelValue":t[0]||(t[0]=e=>n.hasItems=e),name:"hasItem",label:o.$trans("inventory.stock_return.props.has_items"),error:r(s).hasItems,"onUpdate:error":t[1]||(t[1]=e=>r(s).hasItems=e)},null,8,["modelValue","label","error"]),a(g,null,{default:p(()=>[i("span",ue,m(o.$trans("inventory.stock_return.has_items_info")),1)]),_:1})])]),i("div",me,[i("div",pe,[a(_,{modelValue:n.inventory,"onUpdate:modelValue":t[2]||(t[2]=e=>n.inventory=e),name:"inventory",label:o.$trans("inventory.inventory"),options:P.inventories,"label-prop":"name","value-prop":"uuid",error:r(s).inventory,"onUpdate:error":t[3]||(t[3]=e=>r(s).inventory=e),onChange:Q},null,8,["modelValue","label","options","error"])]),i("div",ce,[a(_,{modelValue:n.vendor,"onUpdate:modelValue":t[4]||(t[4]=e=>n.vendor=e),name:"vendor",label:o.$trans("inventory.vendor.vendor"),options:P.vendors,"value-prop":"uuid","track-by":["name"],error:r(s).vendor,"onUpdate:error":t[5]||(t[5]=e=>r(s).vendor=e)},{selectedOption:p(e=>[c(m(e.value.name)+" ("+m(e.value.type.name)+") ",1)]),listOption:p(e=>[c(m(e.option.name)+" ("+m(e.option.type.name)+") ",1)]),_:1},8,["modelValue","label","options","error"]),r(ne)("ledger:create")?(b(),D(g,{key:0,cursor:"","text-right":"",onClick:t[6]||(t[6]=e=>V.value=!0)},{default:p(()=>[c(m(o.$trans("global.add",{attribute:o.$trans("inventory.vendor.vendor")})),1)]),_:1})):A("",!0)]),i("div",ve,[a(_,{modelValue:n.place,"onUpdate:modelValue":t[7]||(t[7]=e=>n.place=e),name:"place",label:o.$trans("inventory.place"),options:P.places,"label-prop":"fullName","value-prop":"uuid",error:r(s).place,"onUpdate:error":t[8]||(t[8]=e=>r(s).place=e)},null,8,["modelValue","label","options","error"])]),i("div",ye,[a(w,{modelValue:n.date,"onUpdate:modelValue":t[9]||(t[9]=e=>n.date=e),name:"date",label:o.$trans("inventory.stock_return.props.date"),"no-clear":"",error:r(s).date,"onUpdate:error":t[10]||(t[10]=e=>r(s).date=e)},null,8,["modelValue","label","error"])]),i("div",be,[a(y,{type:"text",modelValue:n.voucherNumber,"onUpdate:modelValue":t[11]||(t[11]=e=>n.voucherNumber=e),name:"voucherNumber",label:o.$trans("inventory.stock_return.props.voucher_number"),error:r(s).voucherNumber,"onUpdate:error":t[12]||(t[12]=e=>r(s).voucherNumber=e)},null,8,["modelValue","label","error"])]),n.hasItems?A("",!0):(b(),S("div",_e,[a(y,{currency:"",modelValue:n.amount,"onUpdate:modelValue":t[13]||(t[13]=e=>n.amount=e),name:"amount",label:o.$trans("inventory.stock_return.props.amount"),error:r(s).amount,"onUpdate:error":t[14]||(t[14]=e=>r(s).amount=e)},null,8,["modelValue","label","error"])]))]),n.inventory&&n.hasItems?(b(),S(T,{key:0},[(b(!0),S(T,null,re(n.items,(e,u)=>(b(),D(C,{class:"mt-4",key:e.uuid},{legend:p(()=>[c(m(o.$trans("inventory.item"))+" "+m(u+1)+". ",1),i("span",{class:"text-danger ml-2 cursor-pointer",onClick:O=>G(u)},t[21]||(t[21]=[i("i",{class:"fas fa-times-circle"},null,-1)]),8,ke)]),default:p(()=>{var O;return[i("div",$e,[i("div",fe,[a(N,{name:`items.${u}.item`,label:o.$trans("global.select",{attribute:o.$trans("inventory.stock_item.stock_item")}),modelValue:e.item,"onUpdate:modelValue":l=>e.item=l,error:r(s)[`items.${u}.item`],"onUpdate:error":l=>r(s)[`items.${u}.item`]=l,"value-prop":"uuid","object-prop":!0,"init-search":(O=e==null?void 0:e.item)==null?void 0:O.name,"init-search-key":"name","search-action":"inventory/stockItem/list","additional-search-query":{inventory:n.inventory}},{selectedOption:p(l=>{var B,I;return[c(m(l.value.name)+" "+m((I=(B=l.value)==null?void 0:B.category)==null?void 0:I.name),1)]}),listOption:p(l=>{var B,I;return[c(m(l.option.name)+" "+m((I=(B=l.option)==null?void 0:B.category)==null?void 0:I.name),1)]}),_:2},1032,["name","label","modelValue","onUpdate:modelValue","error","onUpdate:error","init-search","additional-search-query"])]),i("div",Ve,[a(y,{type:"number",step:.01,modelValue:e.quantity,"onUpdate:modelValue":l=>e.quantity=l,name:`items.${u}.quantity`,label:o.$trans("inventory.stock_return.props.quantity"),error:r(s)[`items.${u}.quantity`],"onUpdate:error":l=>r(s)[`items.${u}.quantity`]=l},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])]),i("div",ge,[a(y,{currency:"",modelValue:e.unitPrice,"onUpdate:modelValue":l=>e.unitPrice=l,name:`items.${u}.unitPrice`,label:o.$trans("inventory.stock_return.props.unit_price"),error:r(s)[`items.${u}.unitPrice`],"onUpdate:error":l=>r(s)[`items.${u}.unitPrice`]=l},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])]),i("div",Ue,[a(U,{rows:1,modelValue:e.description,"onUpdate:modelValue":l=>e.description=l,name:`items.${u}.description`,label:o.$trans("inventory.stock_return.props.description"),error:r(s)[`items.${u}.description`],"onUpdate:error":l=>r(s)[`items.${u}.description`]=l},null,8,["modelValue","onUpdate:modelValue","name","label","error","onUpdate:error"])])])]}),_:2},1024))),128)),i("div",he,[a(h,{design:"primary",onClick:M,class:"cursor-pointer"},{default:p(()=>[c(m(o.$trans("global.add",{attribute:o.$trans("inventory.stock_item.stock_item")})),1)]),_:1})])],64)):A("",!0),i("div",Be,[i("div",Ie,[a(U,{rows:1,modelValue:n.description,"onUpdate:modelValue":t[15]||(t[15]=e=>n.description=e),name:"description",label:o.$trans("inventory.stock_return.props.description"),error:r(s).description,"onUpdate:error":t[16]||(t[16]=e=>r(s).description=e)},null,8,["modelValue","label","error"])]),i("div",Se,[a(X,{multiple:"",label:o.$trans("general.file"),module:"stock_return",media:n.media,"media-token":n.mediaToken,onIsUpdated:t[17]||(t[17]=e=>n.mediaUpdated=!0),onSetHash:t[18]||(t[18]=e=>n.mediaHash.push(e))},null,8,["label","media","media-token"])])])]),_:1},8,["form"]),a(Z,{show:V.value,onClose:t[20]||(t[20]=e=>V.value=!1)},{title:p(()=>[c(m(o.$trans("global.add",{attribute:o.$trans("inventory.vendor.vendor")})),1)]),default:p(()=>[a(le,{"is-modal":!0,"after-submit":W,onCancelled:t[19]||(t[19]=e=>V.value=!1)})]),_:1},8,["show"])],64)}}}),Re={name:"InventoryStockReturnAction"},Ne=Object.assign(Re,{setup(L){const k=E();return(v,$)=>{const f=d("PageHeaderAction"),q=d("PageHeader"),s=d("ParentTransition");return b(),S(T,null,[a(q,{title:v.$trans(r(k).meta.trans,{attribute:v.$trans(r(k).meta.label)}),navs:[{label:v.$trans("inventory.inventory"),path:"Inventory"},{label:v.$trans("inventory.stock_return.stock_return"),path:"InventoryStockReturnList"}]},{default:p(()=>[a(f,{name:"InventoryStockReturn",title:v.$trans("inventory.stock_return.stock_return"),actions:["list"]},null,8,["title"])]),_:1},8,["title","navs"]),a(s,{appear:"",visibility:!0},{default:p(()=>[a(Pe)]),_:1})],64)}}});export{Ne as default};
